{"version":3,"sources":["../src/index.ts","../src/config.ts","../src/inspector.ts","../src/inspector-ui.ts","../src/auth-proxy.ts","../src/security-proxy.ts","../src/webhook.ts","../src/share.ts","../src/https-proxy.ts","../package.json"],"sourcesContent":["#!/usr/bin/env node\n\nimport { Command } from \"commander\";\nimport chalk from \"chalk\";\nimport ora from \"ora\";\nimport Conf from \"conf\";\nimport { spawn, execSync, ChildProcess } from \"child_process\";\nimport { writeFileSync, mkdtempSync } from \"fs\";\nimport os from \"os\";\nimport path from \"path\";\nimport open from \"open\";\nimport clipboard from \"clipboardy\";\nimport qrcode from \"qrcode-terminal\";\nimport { loadConfig, generateDefaultConfig, getExistingConfigFile, BeamConfig } from \"./config.js\";\nimport { startInspector } from \"./inspector.js\";\nimport { startAuthProxy } from \"./auth-proxy.js\";\nimport { startSecurityProxy, SecurityOptions } from \"./security-proxy.js\";\nimport { startWebhookCapture } from \"./webhook.js\";\nimport { formatShareInfo, parseRecipient, ShareLink } from \"./share.js\";\nimport { startHTTPSProxy, startHTTPSProxyWithAuth } from \"./https-proxy.js\";\nimport pkg from \"../package.json\" assert { type: \"json\" };\n\nconst config = new Conf({\n  projectName: \"beam\",\n  schema: {\n    email: { type: \"string\" },\n    sessionToken: { type: \"string\" },\n    apiUrl: { type: \"string\", default: \"https://beam.byronwade.com\" },\n  },\n});\n\nconst API_URL = (config.get(\"apiUrl\") as string) || \"https://beam.byronwade.com\";\n\nconst program = new Command();\n\nprogram\n  .name(\"beam\")\n  .description(\"Expose localhost to the internet in seconds\")\n  .version(pkg.version);\n\n// Helper to check login status (returns null if not logged in, but doesn't print error)\nfunction getLoginStatus(): { email: string; token: string } | null {\n  const email = config.get(\"email\") as string;\n  const token = config.get(\"sessionToken\") as string;\n\n  if (!email || !token) {\n    return null;\n  }\n\n  return { email, token };\n}\n\n// Helper to require login (prints error if not logged in)\nfunction requireLogin(): { email: string; token: string } | null {\n  const auth = getLoginStatus();\n  if (!auth) {\n    console.log(chalk.red(\"You must be logged in for this command.\"));\n    console.log(chalk.dim(\"  Run: beam login\"));\n    return null;\n  }\n  return auth;\n}\n\n// Sleep helper\nfunction sleep(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n// Helper to check cloudflared\nfunction checkCloudflared(): boolean {\n  try {\n    execSync(\"cloudflared --version\", { stdio: \"pipe\" });\n    return true;\n  } catch {\n    console.log(chalk.red(\"cloudflared is not installed!\"));\n    console.log(chalk.dim(\"Install it first:\"));\n    console.log(chalk.dim(\"  macOS: brew install cloudflared\"));\n    console.log(chalk.dim(\"  Other: https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/\"));\n    return false;\n  }\n}\n\n// Heartbeat function to update tunnel status\nasync function sendHeartbeat(token: string, tunnelId: string): Promise<boolean> {\n  try {\n    const response = await fetch(`${API_URL}/api/tunnels/heartbeat`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({ tunnelId }),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\n// Update tunnel status\nasync function updateTunnelStatus(\n  token: string,\n  tunnelId: string,\n  status: \"active\" | \"inactive\",\n  quickTunnelUrl?: string\n): Promise<boolean> {\n  try {\n    const body: { tunnelId: string; status: string; quickTunnelUrl?: string } = { tunnelId, status };\n    if (quickTunnelUrl) {\n      body.quickTunnelUrl = quickTunnelUrl;\n    }\n    const response = await fetch(`${API_URL}/api/tunnels/status`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(body),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\n// Interface for tunnel display options\ninterface TunnelDisplayOptions {\n  copy?: boolean;\n  qr?: boolean;\n  urlOnly?: boolean;\n}\n\n// Display tunnel URL with options (copy, qr, url-only)\nasync function displayTunnelUrl(\n  url: string,\n  port: number,\n  options: TunnelDisplayOptions\n): Promise<void> {\n  // URL-only mode: just print the URL and nothing else\n  if (options.urlOnly) {\n    console.log(url);\n    return;\n  }\n\n  // Copy to clipboard\n  if (options.copy) {\n    try {\n      await clipboard.write(url);\n    } catch {\n      // Silently fail clipboard operations\n    }\n  }\n\n  // Normal display\n  console.log();\n  console.log(`  ${chalk.bold(\"Public URL:\")} ${chalk.cyan.underline(url)}`);\n  console.log(`  ${chalk.dim(\"Local:\")}      ${chalk.dim(`http://localhost:${port}`)}`);\n\n  if (options.copy) {\n    console.log(`  ${chalk.dim(\"Copied:\")}     ${chalk.green(\"✓\")} ${chalk.dim(\"URL copied to clipboard\")}`);\n  }\n\n  console.log();\n\n  // Show QR code\n  if (options.qr) {\n    console.log(chalk.dim(\"  Scan QR code to open on mobile:\"));\n    console.log();\n    qrcode.generate(url, { small: true }, (qr) => {\n      // Indent QR code\n      const indented = qr.split(\"\\n\").map(line => \"    \" + line).join(\"\\n\");\n      console.log(indented);\n    });\n    console.log();\n  }\n\n  console.log(chalk.dim(\"  Press Ctrl+C to stop\"));\n  console.log();\n}\n\n// Run cloudflared with clean output\nfunction runCloudflared(\n  port: number,\n  onUrl: (url: string) => void,\n  onReady: () => void\n): ChildProcess {\n  const child = spawn(\"cloudflared\", [\"tunnel\", \"--url\", `http://localhost:${port}`], {\n    stdio: [\"ignore\", \"pipe\", \"pipe\"],\n  });\n\n  let urlFound = false;\n  let readyCalled = false;\n\n  const formatLog = (level: string, message: string): string => {\n    const time = new Date().toLocaleTimeString(\"en-US\", { hour12: false });\n\n    if (level === \"ERR\") {\n      return `  ${chalk.dim(time)} ${chalk.red(\"ERR\")} ${message}`;\n    } else if (level === \"WRN\") {\n      return `  ${chalk.dim(time)} ${chalk.yellow(\"WRN\")} ${message}`;\n    } else {\n      return `  ${chalk.dim(time)} ${chalk.dim(\"INF\")} ${message}`;\n    }\n  };\n\n  const processLine = (line: string) => {\n    if (!line.trim()) return;\n\n    // Extract the URL from the quick tunnel message\n    const urlMatch = line.match(/https:\\/\\/[a-z0-9-]+\\.trycloudflare\\.com/);\n    if (urlMatch && !urlFound) {\n      urlFound = true;\n      onUrl(urlMatch[0]);\n      return; // Don't print the box, we'll show URL nicely\n    }\n\n    // Skip the decorative box lines\n    if (line.includes(\"+---\") || line.includes(\"Your quick Tunnel has been created\")) {\n      return;\n    }\n\n    // Skip noisy info messages\n    if (line.includes(\"Thank you for trying Cloudflare\") ||\n        line.includes(\"Cloudflare Online Services Terms\") ||\n        line.includes(\"cloudflare.com/website-terms\") ||\n        line.includes(\"reserves the right to investigate\") ||\n        line.includes(\"intend to use Tunnels in production\") ||\n        line.includes(\"Cannot determine default configuration\") ||\n        line.includes(\"Cannot determine default origin certificate\") ||\n        line.includes(\"cloudflared will not automatically update\") ||\n        line.includes(\"No file [config.yml\") ||\n        line.includes(\"No file cert.pem\") ||\n        line.includes(\"ICMP proxy will use\") ||\n        line.includes(\"Created ICMP proxy\") ||\n        line.includes(\"Starting metrics server\") ||\n        line.includes(\"Initial protocol\") ||\n        line.includes(\"connection curve preferences\")) {\n      return;\n    }\n\n    // Parse cloudflared log format: 2025-12-07T05:14:06Z INF message\n    const logMatch = line.match(/\\d{4}-\\d{2}-\\d{2}T[\\d:]+Z\\s+(INF|ERR|WRN)\\s+(.+)/);\n    if (logMatch) {\n      const [, level, message] = logMatch;\n\n      // Clean up common messages\n      let cleanMessage = message;\n\n      // Version info\n      if (message.startsWith(\"Version \")) {\n        cleanMessage = `cloudflared ${message.split(\" \")[1]}`;\n      }\n      // Generated Connector ID\n      else if (message.includes(\"Generated Connector ID\")) {\n        cleanMessage = \"Connector initialized\";\n      }\n      // Registered tunnel connection\n      else if (message.includes(\"Registered tunnel connection\")) {\n        const locMatch = message.match(/location=(\\w+)/);\n        const location = locMatch ? locMatch[1].toUpperCase() : \"unknown\";\n        cleanMessage = `Connected via ${chalk.green(location)}`;\n        if (!readyCalled) {\n          readyCalled = true;\n          onReady();\n        }\n      }\n      // Request logs (important - show these)\n      else if (message.includes(\"Request URL\") || message.includes(\"HTTP request\")) {\n        // Keep request logs as-is for debugging\n      }\n      // Connection errors\n      else if (message.includes(\"connection\") && level === \"ERR\") {\n        // Keep connection errors\n      }\n      // Skip GOOS/Go version\n      else if (message.includes(\"GOOS:\") || message.includes(\"GOVersion\")) {\n        return;\n      }\n      // Settings\n      else if (message.startsWith(\"Settings:\")) {\n        return;\n      }\n\n      console.log(formatLog(level, cleanMessage));\n    }\n  };\n\n  child.stdout?.on(\"data\", (data: Buffer) => {\n    const lines = data.toString().split(\"\\n\");\n    lines.forEach(processLine);\n  });\n\n  child.stderr?.on(\"data\", (data: Buffer) => {\n    const lines = data.toString().split(\"\\n\");\n    lines.forEach(processLine);\n  });\n\n  return child;\n}\n\n// ============================================================================\n// MAIN TUNNEL COMMAND - beam <port> [more-ports...]\n// ============================================================================\n\ninterface TunnelOptions {\n  copy?: boolean;\n  qr?: boolean;\n  urlOnly?: boolean;\n  inspect?: boolean;\n  https?: boolean;\n  webhook?: boolean;\n  persistent?: boolean;\n  auth?: string;\n  token?: string;\n  allowIp?: string;\n  subdomain?: string;\n  name?: string;\n}\n\nasync function handleTunnel(ports: string[], options: TunnelOptions) {\n  // If no ports provided, try to load from config file\n  if (!ports || ports.length === 0) {\n    const fileConfig = loadConfig();\n    if (fileConfig && fileConfig.port) {\n      ports = [fileConfig.port.toString()];\n      // Merge config options with CLI options (CLI takes precedence)\n      // Convert allowIp array to comma-separated string if present\n      const mergedConfig = {\n        ...fileConfig,\n        allowIp: fileConfig.allowIp ? fileConfig.allowIp.join(\",\") : undefined,\n      };\n      options = {\n        ...mergedConfig,\n        ...options,\n      };\n      console.log(chalk.dim(`  Using config from ${getExistingConfigFile()}`));\n    } else {\n      // Show help if no port provided\n      console.log();\n      console.log(chalk.bold(\"  beam\") + chalk.dim(\" - Expose localhost to the internet\"));\n      console.log();\n      console.log(chalk.dim(\"  Usage:\"));\n      console.log(`    beam ${chalk.cyan(\"<port>\")}              Start a tunnel to localhost:port`);\n      console.log(`    beam ${chalk.cyan(\"3000 8080\")}           Expose multiple ports`);\n      console.log(`    beam ${chalk.cyan(\"3000\")} --inspect      With request inspector`);\n      console.log(`    beam ${chalk.cyan(\"3000\")} --webhook      Webhook capture mode`);\n      console.log();\n      console.log(chalk.dim(\"  Options:\"));\n      console.log(`    -c, --copy           Copy URL to clipboard`);\n      console.log(`    -q, --qr             Display QR code`);\n      console.log(`    -i, --inspect        Enable request inspector`);\n      console.log(`    -w, --webhook        Webhook capture mode`);\n      console.log(`    --https              Local HTTPS proxy`);\n      console.log(`    -a, --auth <u:p>     Basic auth protection`);\n      console.log(`    -s, --subdomain <n>  Use reserved subdomain`);\n      console.log();\n      console.log(chalk.dim(\"  Examples:\"));\n      console.log(`    beam 3000`);\n      console.log(`    beam 3000 --copy --qr`);\n      console.log(`    beam 3000 8080 5432`);\n      console.log();\n      return;\n    }\n  }\n\n  if (!checkCloudflared()) return;\n\n  // Parse and validate ports\n  const portNumbers: number[] = [];\n  for (const port of ports) {\n    const portNum = parseInt(port);\n    if (isNaN(portNum) || portNum < 1 || portNum > 65535) {\n      console.log(chalk.red(`Invalid port: ${port}`));\n      return;\n    }\n    portNumbers.push(portNum);\n  }\n\n  // Validate auth format if provided\n  if (options.auth && !options.auth.includes(\":\")) {\n    console.log(chalk.red(\"Invalid auth format. Use: user:password\"));\n    return;\n  }\n\n  // Check login status - determines if tunnel is tracked or anonymous\n  const auth = getLoginStatus();\n  const isTracked = auth !== null;\n\n  // Multiple ports? Use multi-tunnel mode\n  if (portNumbers.length > 1) {\n    await handleMultiTunnel(portNumbers, options, auth);\n    return;\n  }\n\n  // Single port\n  const portNum = portNumbers[0];\n\n  // Webhook mode?\n  if (options.webhook) {\n    await handleWebhookTunnel(portNum, options);\n    return;\n  }\n\n  // Check subdomain if specified (requires login)\n  if (options.subdomain) {\n    if (!auth) {\n      console.log(chalk.red(\"Login required to use reserved subdomains.\"));\n      console.log(chalk.dim(\"  Run: beam login\"));\n      return;\n    }\n\n    // Validate reservation client-side for fast feedback\n    const subdomainCheck = await fetch(`${API_URL}/api/subdomains`, {\n      headers: { Authorization: `Bearer ${auth.token}` },\n    });\n    const subdomainData = await subdomainCheck.json();\n    if (!subdomainData.success) {\n      console.log(chalk.red(\"Failed to check subdomain availability\"));\n      return;\n    }\n    const hasSubdomain = subdomainData.subdomains?.some(\n      (s: { subdomain: string }) => s.subdomain === options.subdomain\n    );\n    if (!hasSubdomain) {\n      console.log(chalk.red(`Subdomain \"${options.subdomain}\" not reserved.`));\n      console.log(chalk.dim(`  Reserve it first: beam reserve ${options.subdomain}`));\n      return;\n    }\n  }\n\n  // Check if any security options are set\n  const hasSecurityOptions = options.auth || options.token || options.allowIp;\n  const allowedIPs = options.allowIp ? options.allowIp.split(\",\").map((ip: string) => ip.trim()) : undefined;\n\n  // Start inspector, HTTPS proxy, or security proxy if requested\n  let inspector: { close: () => void } | null = null;\n  let securityProxy: { close: () => void; port: number } | null = null;\n  let httpsProxy: { close: () => void; port: number; isHTTPS: true } | null = null;\n  let tunnelPort = portNum;\n\n  if (options.inspect) {\n    try {\n      inspector = await startInspector(portNum, 4040, { basicAuth: options.auth });\n      tunnelPort = 4040;\n    } catch (err) {\n      console.log(chalk.yellow(\"Could not start inspector, continuing without it\"));\n    }\n  } else if (options.https && options.auth) {\n    try {\n      httpsProxy = await startHTTPSProxyWithAuth(portNum, 4043, options.auth, { useMkcert: true });\n      tunnelPort = httpsProxy.port;\n    } catch (err) {\n      console.log(chalk.yellow(\"Could not start HTTPS proxy, continuing without it\"));\n    }\n  } else if (options.https) {\n    try {\n      httpsProxy = await startHTTPSProxy(portNum, 4043, { useMkcert: true });\n      tunnelPort = httpsProxy.port;\n    } catch (err) {\n      console.log(chalk.yellow(\"Could not start HTTPS proxy, continuing without it\"));\n    }\n  } else if (hasSecurityOptions) {\n    try {\n      const securityOptions: SecurityOptions = {\n        basicAuth: options.auth,\n        token: options.token,\n        allowedIPs,\n      };\n      securityProxy = await startSecurityProxy(portNum, 4040, securityOptions);\n      tunnelPort = securityProxy.port;\n    } catch (err) {\n      console.log(chalk.yellow(\"Could not start security proxy, continuing without it\"));\n    }\n  }\n\n  const spinner = options.urlOnly ? null : ora(isTracked ? \"Starting tunnel...\" : \"Starting anonymous tunnel...\").start();\n\n  let tunnelId: string | null = null;\n  let heartbeatInterval: NodeJS.Timeout | null = null;\n\n  try {\n    // If logged in, register the tunnel with Beam for tracking\n    if (isTracked && auth) {\n      const tunnelName = options.name || `beam-${Date.now()}`;\n\n      const response = await fetch(`${API_URL}/api/tunnels/quick`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({\n          name: tunnelName,\n          port: portNum,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        if (spinner) spinner.fail(chalk.red(data.error || \"Failed to create tunnel\"));\n        else console.error(data.error || \"Failed to create tunnel\");\n        inspector?.close();\n        return;\n      }\n\n      tunnelId = data.tunnelId;\n\n      // Start heartbeat\n      heartbeatInterval = setInterval(() => {\n        sendHeartbeat(auth.token, tunnelId!);\n      }, 30000);\n\n      await updateTunnelStatus(auth.token, tunnelId!, \"active\");\n    }\n\n    if (spinner) spinner.text = \"Starting cloudflared...\";\n\n    let child: ChildProcess;\n    let namedUrl: string | null = null;\n    let usingNamed = false;\n\n    // Named tunnel path (reserved subdomain)\n    if (options.subdomain && auth) {\n      if (spinner) spinner.text = \"Provisioning Cloudflare tunnel...\";\n      const connectResponse = await fetch(`${API_URL}/api/tunnels/connect`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({\n          subdomain: options.subdomain,\n          port: portNum,\n          name: options.name || `beam-${options.subdomain}`,\n        }),\n      });\n\n      const connectData = await connectResponse.json();\n      if (!connectData.success) {\n        if (spinner) spinner.fail(chalk.red(connectData.error || \"Failed to provision subdomain tunnel\"));\n        else console.error(connectData.error || \"Failed to provision subdomain tunnel\");\n        inspector?.close();\n        securityProxy?.close();\n        httpsProxy?.close();\n        return;\n      }\n\n      // Create temp dir for credentials/config\n      const tmpDir = mkdtempSync(path.join(os.tmpdir(), \"beam-tunnel-\"));\n      const credPath = path.join(tmpDir, `${connectData.tunnelId}.json`);\n      const configPath = path.join(tmpDir, `${connectData.tunnelId}.yaml`);\n\n      const credentials = {\n        AccountTag: connectData.accountId,\n        TunnelSecret: connectData.tunnelSecret,\n        TunnelID: connectData.tunnelId,\n        TunnelName: options.subdomain,\n      };\n      writeFileSync(credPath, JSON.stringify(credentials, null, 2));\n\n      const configYaml = [\n        `tunnel: ${connectData.tunnelId}`,\n        `credentials-file: ${credPath}`,\n        `ingress:`,\n        `  - hostname: ${connectData.hostname}`,\n        `    service: http://localhost:${tunnelPort}`,\n        `  - service: http_status:404`,\n      ].join(\"\\n\");\n      writeFileSync(configPath, configYaml);\n\n      if (spinner) spinner.text = \"Starting cloudflared (named tunnel)...\";\n\n      child = spawn(\"cloudflared\", [\"tunnel\", \"--config\", configPath, \"--cred-file\", credPath, \"run\", connectData.tunnelId], {\n        stdio: [\"ignore\", \"pipe\", \"pipe\"],\n      });\n\n      // For named tunnels, the public URL is the hostname\n      namedUrl = `https://${connectData.hostname}`;\n      usingNamed = true;\n\n      // Track tunnelId for heartbeats/status updates\n      tunnelId = connectData.tunnelId || tunnelId;\n      if (isTracked && auth && tunnelId) {\n        heartbeatInterval = setInterval(() => {\n          sendHeartbeat(auth.token, tunnelId!);\n        }, 30000);\n      }\n\n      // Handle cloudflared stdout/stderr similarly to runCloudflared\n      const processLine = (line: string) => {\n        if (!line.trim()) return;\n        const logMatch = line.match(/\\d{4}-\\d{2}-\\d{2}T[\\d:]+Z\\s+(INF|ERR|WRN)\\s+(.+)/);\n        if (logMatch) {\n          const [, level, message] = logMatch;\n          const time = new Date().toLocaleTimeString(\"en-US\", { hour12: false });\n          const fmt = (lvl: string, msg: string) =>\n            lvl === \"ERR\"\n              ? `  ${chalk.dim(time)} ${chalk.red(\"ERR\")} ${msg}`\n              : lvl === \"WRN\"\n                ? `  ${chalk.dim(time)} ${chalk.yellow(\"WRN\")} ${msg}`\n                : `  ${chalk.dim(time)} ${chalk.dim(\"INF\")} ${msg}`;\n          console.log(fmt(level, message));\n        }\n      };\n\n      child.stdout?.on(\"data\", (data: Buffer) => {\n        data.toString().split(\"\\n\").forEach(processLine);\n      });\n      child.stderr?.on(\"data\", (data: Buffer) => {\n        data.toString().split(\"\\n\").forEach(processLine);\n      });\n\n      if (spinner) spinner.succeed(chalk.green(\"Tunnel ready!\"));\n      if (isTracked && auth && tunnelId) {\n        await updateTunnelStatus(auth.token, tunnelId, \"active\", namedUrl);\n      }\n      await displayTunnelUrl(namedUrl, portNum, {\n        copy: options.copy,\n        qr: options.qr,\n        urlOnly: options.urlOnly,\n      });\n      if (options.inspect && !options.urlOnly) {\n        console.log(chalk.dim(\"  Inspector: \") + chalk.cyan(`http://localhost:4040/__beam__`));\n        console.log();\n      }\n\n    } else {\n      // Quick/persistent tunnel\n      if (spinner) spinner.text = \"Starting cloudflared...\";\n      child = runCloudflared(\n        tunnelPort,\n        async (url) => {\n          if (spinner) spinner.succeed(chalk.green(\"Tunnel ready!\"));\n\n          // Update tunnel with URL if tracked\n          if (isTracked && auth && tunnelId) {\n            await updateTunnelStatus(auth.token, tunnelId, \"active\", url);\n          }\n\n          await displayTunnelUrl(url, portNum, {\n            copy: options.copy,\n            qr: options.qr,\n            urlOnly: options.urlOnly,\n          });\n\n          if (!options.urlOnly && !isTracked) {\n            console.log(chalk.dim(\"  This tunnel is anonymous. Login to track tunnel history.\"));\n            console.log(chalk.dim(\"  Run: beam login\"));\n            console.log();\n          }\n\n          if (options.inspect && !options.urlOnly) {\n            console.log(chalk.dim(\"  Inspector: \") + chalk.cyan(`http://localhost:4040/__beam__`));\n            console.log();\n          }\n        },\n        () => {}\n      );\n    }\n\n    // Handle exit\n    const cleanup = async () => {\n      if (heartbeatInterval) clearInterval(heartbeatInterval);\n      inspector?.close();\n      securityProxy?.close();\n      httpsProxy?.close();\n      child.kill();\n      if (!options.urlOnly) {\n        console.log();\n        console.log(chalk.yellow(\"Stopping tunnel...\"));\n      }\n      if (isTracked && auth && tunnelId) {\n        await updateTunnelStatus(auth.token, tunnelId, \"inactive\");\n      }\n      if (!options.urlOnly) {\n        console.log(chalk.green(\"Tunnel stopped.\"));\n      }\n      process.exit(0);\n    };\n\n    process.on(\"SIGINT\", cleanup);\n    process.on(\"SIGTERM\", cleanup);\n\n    child.on(\"error\", (err) => {\n      if (spinner) spinner.fail(chalk.red(\"Failed to start tunnel:\") + \" \" + err.message);\n      else console.error(\"Failed to start tunnel:\", err.message);\n      if (heartbeatInterval) clearInterval(heartbeatInterval);\n    });\n\n    child.on(\"exit\", async (code) => {\n      if (heartbeatInterval) clearInterval(heartbeatInterval);\n      if (isTracked && auth && tunnelId) {\n        await updateTunnelStatus(auth.token, tunnelId, \"inactive\");\n      }\n      if (code !== 0 && code !== null && !options.urlOnly) {\n        console.log(chalk.red(`Tunnel exited with code ${code}`));\n      }\n    });\n\n  } catch {\n    if (spinner) spinner.fail(chalk.red(\"Failed to start tunnel\"));\n    else console.error(\"Failed to start tunnel\");\n    if (heartbeatInterval) clearInterval(heartbeatInterval);\n    inspector?.close();\n    securityProxy?.close();\n    httpsProxy?.close();\n  }\n}\n\n// Handle multiple ports\nasync function handleMultiTunnel(ports: number[], options: TunnelOptions, auth: { email: string; token: string } | null) {\n  if (ports.length > 10) {\n    console.log(chalk.red(\"Maximum 10 ports allowed at once\"));\n    return;\n  }\n\n  console.log();\n  console.log(chalk.bold(`Starting ${ports.length} tunnels...`));\n  if (options.auth) {\n    console.log(chalk.dim(`  With basic auth protection`));\n  }\n  console.log();\n\n  interface TunnelInfo {\n    port: number;\n    tunnelId: string | null;\n    url: string | null;\n    child: ChildProcess | null;\n    heartbeatInterval: NodeJS.Timeout | null;\n    inspector: { close: () => void } | null;\n    authProxy: { close: () => void; port: number } | null;\n  }\n\n  const tunnels: TunnelInfo[] = [];\n  const inspectorBasePort = 4040;\n\n  for (let i = 0; i < ports.length; i++) {\n    const portNum = ports[i];\n    const spinner = ora(`Creating tunnel for port ${portNum}...`).start();\n\n    try {\n      let tunnelId: string | null = null;\n\n      // Register with Beam if logged in\n      if (auth) {\n        const tunnelName = `multi-${portNum}-${Date.now()}`;\n\n        const response = await fetch(`${API_URL}/api/tunnels/quick`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            name: tunnelName,\n            port: portNum,\n          }),\n        });\n\n        const data = await response.json();\n\n        if (!data.success) {\n          spinner.fail(chalk.red(`Port ${portNum}: ${data.error || \"Failed to create tunnel\"}`));\n          continue;\n        }\n\n        tunnelId = data.tunnelId;\n      }\n\n      // Start inspector or auth proxy if requested\n      let inspector: { close: () => void } | null = null;\n      let authProxy: { close: () => void; port: number } | null = null;\n      let tunnelPort = portNum;\n      const proxyPort = inspectorBasePort + i;\n\n      if (options.inspect) {\n        try {\n          inspector = await startInspector(portNum, proxyPort, { basicAuth: options.auth });\n          tunnelPort = proxyPort;\n        } catch {\n          // Continue without inspector\n        }\n      } else if (options.auth) {\n        try {\n          authProxy = await startAuthProxy(portNum, proxyPort, options.auth);\n          tunnelPort = authProxy.port;\n        } catch {\n          // Continue without auth proxy\n        }\n      }\n\n      // Start heartbeat if tracked\n      let heartbeatInterval: NodeJS.Timeout | null = null;\n      if (auth && tunnelId) {\n        heartbeatInterval = setInterval(() => {\n          sendHeartbeat(auth.token, tunnelId!);\n        }, 30000);\n        await updateTunnelStatus(auth.token, tunnelId, \"active\");\n      }\n\n      const tunnelInfo: TunnelInfo = {\n        port: portNum,\n        tunnelId,\n        url: null,\n        child: null,\n        heartbeatInterval,\n        inspector,\n        authProxy,\n      };\n\n      // Start cloudflared\n      const child = runCloudflared(\n        tunnelPort,\n        async (url) => {\n          tunnelInfo.url = url;\n          if (auth && tunnelId) {\n            await updateTunnelStatus(auth.token, tunnelId, \"active\", url);\n          }\n          spinner.succeed(chalk.green(`Port ${portNum} → ${chalk.cyan.underline(url)}`));\n        },\n        () => {}\n      );\n\n      tunnelInfo.child = child;\n      tunnels.push(tunnelInfo);\n\n      child.on(\"error\", (err) => {\n        console.log(chalk.red(`Port ${portNum}: ${err.message}`));\n      });\n\n      child.on(\"exit\", async (code) => {\n        if (tunnelInfo.heartbeatInterval) {\n          clearInterval(tunnelInfo.heartbeatInterval);\n        }\n        if (auth && tunnelInfo.tunnelId) {\n          await updateTunnelStatus(auth.token, tunnelInfo.tunnelId, \"inactive\");\n        }\n      });\n\n    } catch {\n      spinner.fail(chalk.red(`Port ${portNum}: Failed to create tunnel`));\n    }\n  }\n\n  if (tunnels.length === 0) {\n    console.log(chalk.red(\"No tunnels were created\"));\n    return;\n  }\n\n  // Wait for URLs\n  await sleep(3000);\n\n  // Copy all URLs\n  if (options.copy) {\n    const urls = tunnels.filter(t => t.url).map(t => t.url).join(\"\\n\");\n    if (urls) {\n      try {\n        await clipboard.write(urls);\n        console.log();\n        console.log(chalk.dim(\"  All URLs copied to clipboard\"));\n      } catch {\n        // Silently fail\n      }\n    }\n  }\n\n  console.log();\n  console.log(chalk.dim(\"  Press Ctrl+C to stop all tunnels\"));\n  console.log();\n\n  // Handle exit\n  const cleanup = async () => {\n    console.log();\n    console.log(chalk.yellow(\"Stopping all tunnels...\"));\n\n    for (const tunnel of tunnels) {\n      if (tunnel.heartbeatInterval) {\n        clearInterval(tunnel.heartbeatInterval);\n      }\n      tunnel.inspector?.close();\n      tunnel.authProxy?.close();\n      tunnel.child?.kill();\n      if (auth && tunnel.tunnelId) {\n        await updateTunnelStatus(auth.token, tunnel.tunnelId, \"inactive\");\n      }\n    }\n\n    console.log(chalk.green(\"All tunnels stopped.\"));\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n}\n\n// Handle webhook mode\nasync function handleWebhookTunnel(port: number, options: TunnelOptions) {\n  const webhookPort = 4040;\n\n  const spinner = ora(\"Starting webhook capture server...\").start();\n\n  try {\n    const webhook = await startWebhookCapture(port, webhookPort, {\n      basicAuth: options.auth,\n    });\n\n    spinner.succeed(chalk.green(\"Webhook capture server ready!\"));\n\n    const tunnelSpinner = ora(\"Creating tunnel for webhooks...\").start();\n\n    const child = runCloudflared(\n      webhookPort,\n      async (url) => {\n        tunnelSpinner.succeed(chalk.green(\"Webhook tunnel ready!\"));\n\n        console.log();\n        console.log(`  ${chalk.bold(\"Webhook URL:\")} ${chalk.cyan.underline(url)}`);\n        console.log(`  ${chalk.dim(\"Local:\")}       ${chalk.dim(`http://localhost:${port}`)}`);\n        console.log(`  ${chalk.dim(\"Inspector:\")}   ${chalk.cyan(`http://localhost:${webhookPort}/__beam__`)}`);\n        console.log();\n\n        if (options.copy) {\n          try {\n            await clipboard.write(url);\n            console.log(`  ${chalk.dim(\"Copied:\")}     ${chalk.green(\"✓\")} ${chalk.dim(\"URL copied to clipboard\")}`);\n            console.log();\n          } catch {\n            // Silently fail\n          }\n        }\n\n        if (options.qr) {\n          console.log(chalk.dim(\"  Scan QR code to send webhooks:\"));\n          console.log();\n          qrcode.generate(url, { small: true }, (qr) => {\n            const indented = qr.split(\"\\n\").map(line => \"    \" + line).join(\"\\n\");\n            console.log(indented);\n          });\n          console.log();\n        }\n\n        console.log(chalk.dim(\"  Point your webhook provider to the URL above.\"));\n        console.log(chalk.dim(\"  All requests will be captured and can be replayed.\"));\n        console.log();\n        console.log(chalk.dim(\"  Press Ctrl+C to stop\"));\n        console.log();\n      },\n      () => {}\n    );\n\n    const cleanup = async () => {\n      child.kill();\n      webhook.close();\n      console.log();\n      console.log(chalk.yellow(\"Stopping webhook capture...\"));\n      const capturedCount = webhook.getRequests().length;\n      console.log(chalk.green(`Captured ${capturedCount} webhook${capturedCount !== 1 ? 's' : ''} total.`));\n      process.exit(0);\n    };\n\n    process.on(\"SIGINT\", cleanup);\n    process.on(\"SIGTERM\", cleanup);\n\n    child.on(\"error\", (err) => {\n      tunnelSpinner.fail(chalk.red(\"Failed to start tunnel:\") + \" \" + err.message);\n      webhook.close();\n    });\n\n    child.on(\"exit\", (code) => {\n      if (code !== 0 && code !== null) {\n        console.log(chalk.red(`Tunnel exited with code ${code}`));\n      }\n      webhook.close();\n    });\n\n  } catch (err) {\n    spinner.fail(chalk.red(\"Failed to start webhook capture server\"));\n    console.error(err);\n  }\n}\n\n// ============================================================================\n// DEFAULT COMMAND - beam <port> [more-ports...]\n// ============================================================================\n\nprogram\n  .argument(\"[ports...]\", \"Port(s) to expose (e.g., 3000 or 3000 8080)\")\n  .option(\"-c, --copy\", \"Copy URL to clipboard\")\n  .option(\"-q, --qr\", \"Display QR code\")\n  .option(\"--url-only\", \"Output only URL (for scripts)\")\n  .option(\"-i, --inspect\", \"Enable request inspector at localhost:4040\")\n  .option(\"--https\", \"Enable local HTTPS\")\n  .option(\"-w, --webhook\", \"Webhook capture mode\")\n  .option(\"-p, --persistent\", \"Create persistent/named tunnel (requires login)\")\n  .option(\"-a, --auth <credentials>\", \"Basic auth (user:pass)\")\n  .option(\"-t, --token <secret>\", \"Token auth (Bearer)\")\n  .option(\"--allow-ip <ip>\", \"IP whitelist (comma-separated)\")\n  .option(\"-s, --subdomain <name>\", \"Use reserved subdomain\")\n  .option(\"-n, --name <name>\", \"Tunnel name\")\n  .action(handleTunnel);\n\n// ============================================================================\n// AUTH COMMANDS\n// ============================================================================\n\n// Login command\nprogram\n  .command(\"login\")\n  .description(\"Login to your Beam account\")\n  .option(\"--vercel\", \"Login with your Vercel account\")\n  .action(async (options) => {\n    const existingEmail = config.get(\"email\") as string;\n    const existingToken = config.get(\"sessionToken\") as string;\n    if (existingEmail && existingToken) {\n      console.log(chalk.green(\"Already logged in as:\"), existingEmail);\n      console.log(chalk.dim(\"  Run: beam logout to sign out\"));\n      return;\n    }\n\n    if (options.vercel) {\n      console.log();\n      console.log(chalk.bold(\"  Login with Vercel\"));\n      console.log();\n      console.log(chalk.dim(\"  Opening browser for Vercel authorization...\"));\n      console.log();\n\n      const vercelAuthUrl = `${API_URL}/api/auth/vercel`;\n      await open(vercelAuthUrl);\n\n      console.log(chalk.dim(\"  After logging in via browser, run:\"));\n      console.log(chalk.cyan(\"    beam login\"));\n      console.log(chalk.dim(\"  to complete CLI authentication.\"));\n      return;\n    }\n\n    const spinner = ora(\"Creating login session...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/auth/cli`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        spinner.fail(chalk.red(data.error || \"Failed to create login session\"));\n        return;\n      }\n\n      spinner.stop();\n\n      console.log();\n      console.log(chalk.bold(\"  Your login code:\"));\n      console.log();\n      console.log(chalk.cyan.bold(`    ${data.code}`));\n      console.log();\n      console.log(chalk.dim(\"  Opening browser to complete login...\"));\n      console.log(chalk.dim(`  If browser doesn't open, visit: ${API_URL}/cli?code=${data.code}`));\n      console.log();\n\n      const authUrl = `${API_URL}/cli?code=${data.code}`;\n      await open(authUrl);\n\n      const pollSpinner = ora(\"Waiting for browser authorization...\").start();\n      const maxAttempts = 60;\n      let attempts = 0;\n\n      while (attempts < maxAttempts) {\n        await sleep(5000);\n\n        try {\n          const checkResponse = await fetch(`${API_URL}/api/auth/cli?device_code=${data.deviceCode}`);\n          const checkData = await checkResponse.json();\n\n          if (checkData.status === \"approved\") {\n            config.set(\"email\", checkData.email);\n            config.set(\"sessionToken\", checkData.token);\n            pollSpinner.succeed(chalk.green(\"Logged in successfully!\"));\n            console.log(chalk.dim(`  Logged in as ${checkData.email}`));\n            return;\n          }\n\n          if (checkData.status === \"expired\") {\n            pollSpinner.fail(chalk.red(\"Login session expired. Please try again.\"));\n            return;\n          }\n\n          attempts++;\n        } catch {\n          attempts++;\n        }\n      }\n\n      pollSpinner.fail(chalk.red(\"Login timed out. Please try again.\"));\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam. Is the server running?\"));\n    }\n  });\n\n// Logout command\nprogram\n  .command(\"logout\")\n  .description(\"Logout from your Beam account\")\n  .action(() => {\n    config.delete(\"email\");\n    config.delete(\"sessionToken\");\n    console.log(chalk.green(\"Logged out successfully!\"));\n  });\n\n// Status command\nprogram\n  .command(\"status\")\n  .description(\"Check your login status\")\n  .action(async () => {\n    const auth = getLoginStatus();\n\n    if (auth) {\n      console.log(chalk.green(\"Logged in as:\"), auth.email);\n    } else {\n      console.log(chalk.dim(\"Not logged in\"));\n      console.log(chalk.dim(\"  Run: beam login\"));\n    }\n\n    if (checkCloudflared()) {\n      console.log(chalk.green(\"cloudflared:\"), \"Installed\");\n    }\n\n    const configFile = getExistingConfigFile();\n    if (configFile) {\n      console.log(chalk.green(\"Config file:\"), configFile);\n    }\n  });\n\n// ============================================================================\n// CONFIG COMMANDS\n// ============================================================================\n\n// Init command\nprogram\n  .command(\"init\")\n  .description(\"Create a .beam.yaml config file\")\n  .option(\"-p, --port <port>\", \"Default port\")\n  .option(\"-f, --force\", \"Overwrite existing config\")\n  .action((options) => {\n    const existingConfig = getExistingConfigFile();\n\n    if (existingConfig && !options.force) {\n      console.log(chalk.yellow(`Config file already exists: ${existingConfig}`));\n      console.log(chalk.dim(\"  Use --force to overwrite\"));\n      return;\n    }\n\n    const port = options.port ? parseInt(options.port) : undefined;\n    const content = generateDefaultConfig(port);\n\n    try {\n      writeFileSync(\".beam.yaml\", content);\n      console.log(chalk.green(\"Created .beam.yaml\"));\n      console.log();\n      console.log(chalk.dim(\"  Edit the file to customize your settings\"));\n      console.log(chalk.dim(\"  Then just run: beam\"));\n    } catch (error) {\n      console.log(chalk.red(\"Failed to create config file:\"), error);\n    }\n  });\n\n// ============================================================================\n// TUNNEL MANAGEMENT COMMANDS\n// ============================================================================\n\n// List tunnels\nprogram\n  .command(\"list\")\n  .description(\"List your tunnels\")\n  .action(async () => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Fetching tunnels...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/tunnels`, {\n        headers: {\n          Authorization: `Bearer ${auth.token}`,\n        },\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        spinner.fail(chalk.red(data.error || \"Failed to fetch tunnels\"));\n        return;\n      }\n\n      spinner.stop();\n\n      if (!data.tunnels || data.tunnels.length === 0) {\n        console.log(chalk.dim(\"No tunnels found.\"));\n        console.log(chalk.dim(\"  Create one: beam 3000\"));\n        return;\n      }\n\n      console.log(chalk.bold(\"Your tunnels:\\n\"));\n\n      for (const tunnel of data.tunnels) {\n        const statusIcon = tunnel.status === \"active\"\n          ? chalk.green(\"●\")\n          : tunnel.status === \"pending\"\n            ? chalk.yellow(\"●\")\n            : chalk.dim(\"○\");\n\n        const typeLabel = tunnel.type === \"quick\"\n          ? chalk.blue(\"[Quick]\")\n          : tunnel.type === \"persistent\"\n            ? chalk.magenta(\"[Persistent]\")\n            : chalk.cyan(\"[Custom]\");\n\n        console.log(`  ${statusIcon} ${chalk.bold(tunnel.name)} ${typeLabel}`);\n        console.log(chalk.dim(`    Port: ${tunnel.port} | Status: ${tunnel.status}`));\n        if (tunnel.url) {\n          console.log(chalk.dim(`    URL: ${tunnel.url}`));\n        }\n        console.log();\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to fetch tunnels\"));\n    }\n  });\n\n// Stop tunnel (renamed from delete)\nprogram\n  .command(\"stop\")\n  .description(\"Stop/delete a tunnel\")\n  .argument(\"<name>\", \"Tunnel name or ID\")\n  .action(async (name) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Stopping tunnel...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/tunnels/delete`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({ name }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        spinner.succeed(chalk.green(`Tunnel \"${name}\" stopped.`));\n      } else {\n        spinner.fail(chalk.red(data.error || \"Failed to stop tunnel\"));\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n    }\n  });\n\n// ============================================================================\n// SUBDOMAIN COMMANDS\n// ============================================================================\n\n// Reserve subdomain\nprogram\n  .command(\"reserve\")\n  .description(\"Reserve a subdomain (e.g., my-app.beam.byronwade.com)\")\n  .argument(\"<name>\", \"Subdomain name\")\n  .action(async (name) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(`Reserving ${name}.beam.byronwade.com...`).start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/subdomains`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({ subdomain: name }),\n      });\n\n      const raw = await response.text();\n      let data: { success?: boolean; error?: string; url?: string } = {};\n      try {\n        data = raw ? JSON.parse(raw) : {};\n      } catch {\n        data = { success: false, error: raw || `${response.status} ${response.statusText}` };\n      }\n\n      if (response.ok && data.success) {\n        spinner.succeed(chalk.green(\"Subdomain reserved!\"));\n        console.log();\n        console.log(`  ${chalk.bold(\"Your subdomain:\")} ${chalk.cyan.underline(data.url)}`);\n        console.log();\n        console.log(chalk.dim(\"  Use it with: beam 3000 --subdomain \" + name));\n      } else {\n        const message =\n          data.error ||\n          (raw ? raw.trim() : \"\") ||\n          `${response.status} ${response.statusText}` ||\n          \"Failed to reserve subdomain\";\n        spinner.fail(chalk.red(message));\n        // Surface response details to help diagnose\n        console.log(chalk.dim(`  status: ${response.status}`));\n        if (response.statusText) {\n          console.log(chalk.dim(`  statusText: ${response.statusText}`));\n        }\n        if (raw) {\n          console.log(chalk.dim(\"  body:\"));\n          console.log(chalk.dim(raw));\n        }\n      }\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"Failed to connect to Beam\";\n      spinner.fail(chalk.red(message));\n    }\n  });\n\n// List subdomains\nprogram\n  .command(\"subdomains\")\n  .description(\"List your reserved subdomains\")\n  .action(async () => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Fetching subdomains...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/subdomains`, {\n        headers: {\n          Authorization: `Bearer ${auth.token}`,\n        },\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        spinner.fail(chalk.red(data.error || \"Failed to fetch subdomains\"));\n        return;\n      }\n\n      spinner.stop();\n\n      if (!data.subdomains || data.subdomains.length === 0) {\n        console.log(chalk.dim(\"No subdomains reserved.\"));\n        console.log(chalk.dim(\"  Reserve one: beam reserve <name>\"));\n        return;\n      }\n\n      console.log(chalk.bold(\"Your subdomains:\\n\"));\n\n      for (const sub of data.subdomains) {\n        const statusIcon = sub.status === \"active\"\n          ? chalk.green(\"●\")\n          : chalk.dim(\"○\");\n\n        console.log(`  ${statusIcon} ${chalk.bold(sub.subdomain)}`);\n        console.log(chalk.dim(`    ${sub.url}`));\n        console.log();\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to fetch subdomains\"));\n    }\n  });\n\n// Release subdomain\nprogram\n  .command(\"release\")\n  .description(\"Release a reserved subdomain\")\n  .argument(\"<name>\", \"Subdomain name\")\n  .action(async (name) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(`Releasing ${name}...`).start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/subdomains`, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({ subdomain: name }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        spinner.succeed(chalk.green(`Subdomain \"${name}\" released.`));\n      } else {\n        spinner.fail(chalk.red(data.error || \"Failed to release subdomain\"));\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n    }\n  });\n\n// ============================================================================\n// SHARE COMMANDS\n// ============================================================================\n\n// Share tunnel\nprogram\n  .command(\"share\")\n  .description(\"Create a shareable link for a tunnel\")\n  .argument(\"<tunnel>\", \"Tunnel name or ID\")\n  .option(\"-t, --to <recipient>\", \"Share with specific user (@username or email)\")\n  .option(\"-e, --expires <hours>\", \"Hours until link expires (default: 24)\", \"24\")\n  .option(\"-m, --message <msg>\", \"Include a message\")\n  .option(\"-c, --copy\", \"Copy share link to clipboard\")\n  .action(async (tunnel, options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Creating share link...\").start();\n\n    try {\n      const expiresIn = parseInt(options.expires) || 24;\n      const recipient = options.to ? parseRecipient(options.to) : null;\n\n      const response = await fetch(`${API_URL}/api/share`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({\n          tunnelName: tunnel,\n          expiresIn,\n          sharedWith: recipient?.value,\n          sharedWithType: recipient?.type,\n          message: options.message,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        spinner.fail(chalk.red(data.error || \"Failed to create share link\"));\n        return;\n      }\n\n      spinner.succeed(chalk.green(\"Share link created!\"));\n\n      const shareLink: ShareLink = {\n        id: data.share.id,\n        url: data.share.url,\n        tunnelId: data.share.tunnelId,\n        tunnelUrl: data.share.tunnelUrl,\n        createdAt: new Date(data.share.createdAt),\n        expiresAt: new Date(data.share.expiresAt),\n        createdBy: auth.email,\n        sharedWith: options.to,\n        message: options.message,\n      };\n\n      formatShareInfo(shareLink);\n\n      if (options.copy) {\n        try {\n          await clipboard.write(data.share.url);\n          console.log(`  ${chalk.green(\"✓\")} ${chalk.dim(\"Link copied to clipboard\")}`);\n          console.log();\n        } catch {\n          // Silently fail\n        }\n      }\n\n      if (recipient) {\n        console.log(chalk.dim(`  ${recipient.value} will receive a notification.`));\n        console.log();\n      }\n\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n    }\n  });\n\n// List shares\nprogram\n  .command(\"shares\")\n  .description(\"List your shared tunnel links\")\n  .option(\"-a, --all\", \"Show expired shares too\")\n  .action(async (options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Fetching shares...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/share?includeExpired=${options.all || false}`, {\n        headers: {\n          Authorization: `Bearer ${auth.token}`,\n        },\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        spinner.fail(chalk.red(data.error || \"Failed to fetch shares\"));\n        return;\n      }\n\n      spinner.stop();\n\n      if (!data.shares || data.shares.length === 0) {\n        console.log(chalk.dim(\"No shares found.\"));\n        console.log(chalk.dim(\"  Create one: beam share <tunnel-name>\"));\n        return;\n      }\n\n      console.log(chalk.bold(\"Your shares:\\n\"));\n\n      for (const share of data.shares) {\n        const isExpired = new Date(share.expiresAt) < new Date();\n        const statusIcon = isExpired ? chalk.dim(\"○\") : chalk.green(\"●\");\n\n        console.log(`  ${statusIcon} ${chalk.bold(share.tunnelName || share.tunnelId)}`);\n        console.log(chalk.dim(`    URL: ${share.url}`));\n        console.log(chalk.dim(`    Expires: ${new Date(share.expiresAt).toLocaleString()}`));\n        if (share.sharedWith) {\n          console.log(chalk.dim(`    Shared with: ${share.sharedWith}`));\n        }\n        console.log();\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to fetch shares\"));\n    }\n  });\n\n// Unshare\nprogram\n  .command(\"unshare\")\n  .description(\"Revoke a share link\")\n  .argument(\"<share-id>\", \"Share ID to revoke\")\n  .action(async (shareId) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Revoking share...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/share`, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({ shareId }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        spinner.succeed(chalk.green(\"Share revoked.\"));\n      } else {\n        spinner.fail(chalk.red(data.error || \"Failed to revoke share\"));\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n    }\n  });\n\n// ============================================================================\n// VERCEL DOMAIN COMMANDS\n// ============================================================================\n\n// List Vercel domains\nprogram\n  .command(\"domains\")\n  .description(\"List your Vercel domains\")\n  .action(async () => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Fetching domains...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/vercel/domains`, {\n        headers: {\n          Authorization: `Bearer ${auth.token}`,\n        },\n      });\n\n      const data = await response.json();\n\n      if (!data.success) {\n        if (data.error?.includes(\"Vercel\")) {\n          spinner.fail(chalk.yellow(\"Vercel not connected\"));\n          console.log(chalk.dim(\"  Connect Vercel: beam login --vercel\"));\n          return;\n        }\n        spinner.fail(chalk.red(data.error || \"Failed to fetch domains\"));\n        return;\n      }\n\n      spinner.stop();\n\n      if (!data.domains || data.domains.length === 0) {\n        console.log(chalk.dim(\"No Vercel domains found.\"));\n        console.log(chalk.dim(\"  Add domains in your Vercel dashboard first.\"));\n        return;\n      }\n\n      console.log(chalk.bold(\"Your Vercel domains:\\n\"));\n\n      for (const domain of data.domains) {\n        const verifiedIcon = domain.verified ? chalk.green(\"✓\") : chalk.yellow(\"?\");\n        console.log(`  ${verifiedIcon} ${chalk.bold(domain.name)}`);\n        if (domain.projectName) {\n          console.log(chalk.dim(`    Project: ${domain.projectName}`));\n        }\n        console.log();\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to fetch domains\"));\n    }\n  });\n\n// Domain management\nprogram\n  .command(\"domain\")\n  .description(\"Manage custom domain routing\")\n  .argument(\"<action>\", \"Action: add, remove, list\")\n  .argument(\"[domain]\", \"Domain name\")\n  .option(\"-t, --tunnel <name>\", \"Tunnel to route to\")\n  .action(async (action, domain, options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    if (action === \"list\") {\n      const spinner = ora(\"Fetching domain routes...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/vercel/domains/routes`, {\n          headers: {\n            Authorization: `Bearer ${auth.token}`,\n          },\n        });\n\n        const data = await response.json();\n\n        if (!data.success) {\n          spinner.fail(chalk.red(data.error || \"Failed to fetch routes\"));\n          return;\n        }\n\n        spinner.stop();\n\n        if (!data.routes || data.routes.length === 0) {\n          console.log(chalk.dim(\"No domain routes configured.\"));\n          console.log(chalk.dim(\"  Add one: beam domain add <domain> --tunnel <name>\"));\n          return;\n        }\n\n        console.log(chalk.bold(\"Domain routes:\\n\"));\n\n        for (const route of data.routes) {\n          console.log(`  ${chalk.cyan(route.domain)} → ${chalk.bold(route.tunnelName)}`);\n        }\n        console.log();\n      } catch {\n        spinner.fail(chalk.red(\"Failed to fetch routes\"));\n      }\n      return;\n    }\n\n    if (action === \"add\") {\n      if (!domain) {\n        console.log(chalk.red(\"Domain name required\"));\n        console.log(chalk.dim(\"  Usage: beam domain add <domain> --tunnel <name>\"));\n        return;\n      }\n\n      if (!options.tunnel) {\n        console.log(chalk.red(\"Tunnel name required\"));\n        console.log(chalk.dim(\"  Usage: beam domain add <domain> --tunnel <name>\"));\n        return;\n      }\n\n      const spinner = ora(`Adding route ${domain} → ${options.tunnel}...`).start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/vercel/domains/routes`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            domain,\n            tunnelName: options.tunnel,\n          }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(`Route added: ${domain} → ${options.tunnel}`));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to add route\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"remove\") {\n      if (!domain) {\n        console.log(chalk.red(\"Domain name required\"));\n        console.log(chalk.dim(\"  Usage: beam domain remove <domain>\"));\n        return;\n      }\n\n      const spinner = ora(`Removing route for ${domain}...`).start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/vercel/domains/routes`, {\n          method: \"DELETE\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({ domain }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(`Route removed for ${domain}`));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to remove route\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    console.log(chalk.red(`Unknown action: ${action}`));\n    console.log(chalk.dim(\"  Valid actions: add, remove, list\"));\n  });\n\n// ============================================================================\n// SCHEDULE COMMANDS\n// ============================================================================\n\nprogram\n  .command(\"schedule\")\n  .description(\"Schedule a tunnel to run automatically\")\n  .argument(\"<action>\", \"Action: create, list, delete, enable, disable\")\n  .option(\"-n, --name <name>\", \"Schedule name\")\n  .option(\"-p, --port <port>\", \"Port to expose\")\n  .option(\"--cron <expression>\", \"Cron expression (e.g., '0 9 * * 1-5' for weekdays at 9am)\")\n  .option(\"-d, --duration <minutes>\", \"How long to keep tunnel open (default: 60)\", \"60\")\n  .option(\"-z, --timezone <tz>\", \"Timezone (default: UTC)\", \"UTC\")\n  .action(async (action, options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    if (action === \"list\") {\n      const spinner = ora(\"Fetching schedules...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/schedules`, {\n          headers: { Authorization: `Bearer ${auth.token}` },\n        });\n\n        const data = await response.json();\n        spinner.stop();\n\n        if (!data.success) {\n          console.log(chalk.red(data.error || \"Failed to fetch schedules\"));\n          return;\n        }\n\n        if (!data.schedules || data.schedules.length === 0) {\n          console.log(chalk.dim(\"No schedules found.\"));\n          console.log(chalk.dim('  Create one: beam schedule create --name daily-demo --port 3000 --cron \"0 9 * * 1-5\"'));\n          return;\n        }\n\n        console.log(chalk.bold(\"Your schedules:\\n\"));\n        for (const schedule of data.schedules) {\n          const statusIcon = schedule.enabled ? chalk.green(\"●\") : chalk.dim(\"○\");\n          console.log(`  ${statusIcon} ${chalk.bold(schedule.name)}`);\n          console.log(chalk.dim(`    Port: ${schedule.port} | Cron: ${schedule.cronExpression}`));\n          console.log(chalk.dim(`    Duration: ${schedule.duration}min | Timezone: ${schedule.timezone}`));\n          if (schedule.nextRun) {\n            console.log(chalk.dim(`    Next run: ${new Date(schedule.nextRun).toLocaleString()}`));\n          }\n          console.log();\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to fetch schedules\"));\n      }\n      return;\n    }\n\n    if (action === \"create\") {\n      if (!options.name || !options.port || !options.cron) {\n        console.log(chalk.red(\"Missing required options\"));\n        console.log(chalk.dim('  Usage: beam schedule create --name <name> --port <port> --cron \"<expression>\"'));\n        return;\n      }\n\n      const spinner = ora(\"Creating schedule...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/schedules`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            name: options.name,\n            port: parseInt(options.port),\n            cronExpression: options.cron,\n            duration: parseInt(options.duration) || 60,\n            timezone: options.timezone || \"UTC\",\n          }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(`Schedule \"${options.name}\" created!`));\n          if (data.nextRun) {\n            console.log(chalk.dim(`  Next run: ${new Date(data.nextRun).toLocaleString()}`));\n          }\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to create schedule\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"delete\") {\n      if (!options.name) {\n        console.log(chalk.red(\"Schedule name required\"));\n        console.log(chalk.dim(\"  Usage: beam schedule delete --name <name>\"));\n        return;\n      }\n\n      const spinner = ora(`Deleting schedule \"${options.name}\"...`).start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/schedules`, {\n          method: \"DELETE\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({ name: options.name }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(`Schedule \"${options.name}\" deleted.`));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to delete schedule\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"enable\" || action === \"disable\") {\n      if (!options.name) {\n        console.log(chalk.red(\"Schedule name required\"));\n        console.log(chalk.dim(`  Usage: beam schedule ${action} --name <name>`));\n        return;\n      }\n\n      const spinner = ora(`${action === \"enable\" ? \"Enabling\" : \"Disabling\"} schedule...`).start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/schedules`, {\n          method: \"PATCH\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            name: options.name,\n            enabled: action === \"enable\",\n          }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(`Schedule \"${options.name}\" ${action}d.`));\n        } else {\n          spinner.fail(chalk.red(data.error || `Failed to ${action} schedule`));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    console.log(chalk.red(`Unknown action: ${action}`));\n    console.log(chalk.dim(\"  Valid actions: create, list, delete, enable, disable\"));\n  });\n\n// ============================================================================\n// NOTIFICATION COMMANDS\n// ============================================================================\n\nprogram\n  .command(\"notify\")\n  .description(\"Configure tunnel notifications\")\n  .argument(\"<action>\", \"Action: setup, test, status, disable\")\n  .option(\"--slack <url>\", \"Slack webhook URL\")\n  .option(\"--discord <url>\", \"Discord webhook URL\")\n  .action(async (action, options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    if (action === \"status\") {\n      const spinner = ora(\"Fetching notification settings...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/notifications`, {\n          headers: { Authorization: `Bearer ${auth.token}` },\n        });\n\n        const data = await response.json();\n        spinner.stop();\n\n        if (!data.success) {\n          console.log(chalk.red(data.error || \"Failed to fetch settings\"));\n          return;\n        }\n\n        console.log(chalk.bold(\"Notification settings:\\n\"));\n        console.log(`  Slack:   ${data.slack?.enabled ? chalk.green(\"Enabled\") : chalk.dim(\"Not configured\")}`);\n        console.log(`  Discord: ${data.discord?.enabled ? chalk.green(\"Enabled\") : chalk.dim(\"Not configured\")}`);\n        console.log();\n      } catch {\n        spinner.fail(chalk.red(\"Failed to fetch settings\"));\n      }\n      return;\n    }\n\n    if (action === \"setup\") {\n      if (!options.slack && !options.discord) {\n        console.log(chalk.red(\"At least one webhook URL required\"));\n        console.log(chalk.dim(\"  Usage: beam notify setup --slack <url>\"));\n        console.log(chalk.dim(\"         beam notify setup --discord <url>\"));\n        return;\n      }\n\n      const spinner = ora(\"Saving notification settings...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/notifications`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            slackWebhook: options.slack,\n            discordWebhook: options.discord,\n          }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(\"Notification settings saved!\"));\n          console.log(chalk.dim(\"  Test with: beam notify test\"));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to save settings\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"test\") {\n      const spinner = ora(\"Sending test notification...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/notifications/test`, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${auth.token}`,\n          },\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(\"Test notification sent!\"));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to send test\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"disable\") {\n      const spinner = ora(\"Disabling notifications...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/notifications`, {\n          method: \"DELETE\",\n          headers: {\n            Authorization: `Bearer ${auth.token}`,\n          },\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(\"Notifications disabled.\"));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to disable\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    console.log(chalk.red(`Unknown action: ${action}`));\n    console.log(chalk.dim(\"  Valid actions: setup, test, status, disable\"));\n  });\n\n// ============================================================================\n// ANALYTICS COMMAND\n// ============================================================================\n\nfunction formatBytes(bytes: number): string {\n  if (bytes === 0) return \"0 B\";\n  const k = 1024;\n  const sizes = [\"B\", \"KB\", \"MB\", \"GB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + \" \" + sizes[i];\n}\n\nprogram\n  .command(\"analytics\")\n  .description(\"View tunnel analytics\")\n  .option(\"-t, --tunnel <name>\", \"Specific tunnel (default: all)\")\n  .option(\"-r, --range <days>\", \"Time range in days (default: 7)\", \"7\")\n  .action(async (options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Fetching analytics...\").start();\n\n    try {\n      const params = new URLSearchParams({\n        range: options.range,\n      });\n      if (options.tunnel) {\n        params.append(\"tunnel\", options.tunnel);\n      }\n\n      const response = await fetch(`${API_URL}/api/analytics?${params}`, {\n        headers: { Authorization: `Bearer ${auth.token}` },\n      });\n\n      const data = await response.json();\n      spinner.stop();\n\n      if (!data.success) {\n        console.log(chalk.red(data.error || \"Failed to fetch analytics\"));\n        return;\n      }\n\n      console.log(chalk.bold(`Analytics (last ${options.range} days):\\n`));\n\n      console.log(`  ${chalk.bold(\"Total Requests:\")}  ${data.totalRequests.toLocaleString()}`);\n      console.log(`  ${chalk.bold(\"Total Bandwidth:\")} ${formatBytes(data.totalBytes)}`);\n      console.log(`  ${chalk.bold(\"Avg Latency:\")}     ${data.avgLatency}ms`);\n      console.log(`  ${chalk.bold(\"Error Rate:\")}      ${data.errorRate}%`);\n      console.log();\n\n      if (data.topPaths && data.topPaths.length > 0) {\n        console.log(chalk.bold(\"  Top Paths:\"));\n        for (const path of data.topPaths.slice(0, 5)) {\n          console.log(`    ${path.count.toString().padStart(6)} ${path.path}`);\n        }\n        console.log();\n      }\n\n      if (data.statusCodes) {\n        console.log(chalk.bold(\"  Status Codes:\"));\n        for (const [code, count] of Object.entries(data.statusCodes)) {\n          const color = code.startsWith(\"2\") ? chalk.green : code.startsWith(\"4\") ? chalk.yellow : chalk.red;\n          console.log(`    ${color(code)}: ${count}`);\n        }\n        console.log();\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to fetch analytics\"));\n    }\n  });\n\n// ============================================================================\n// GITHUB COMMAND\n// ============================================================================\n\nprogram\n  .command(\"github\")\n  .description(\"Manage GitHub integration\")\n  .argument(\"<action>\", \"Action: status, connect, disconnect, post\")\n  .option(\"-o, --owner <owner>\", \"Repository owner\")\n  .option(\"-r, --repo <repo>\", \"Repository name\")\n  .option(\"-p, --pr <number>\", \"Pull request number\")\n  .option(\"-t, --tunnel <name>\", \"Tunnel name to post\")\n  .action(async (action, options) => {\n    const auth = requireLogin();\n    if (!auth) return;\n\n    if (action === \"status\") {\n      const spinner = ora(\"Checking GitHub connection...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/github`, {\n          headers: { Authorization: `Bearer ${auth.token}` },\n        });\n\n        const data = await response.json();\n        spinner.stop();\n\n        if (data.connected) {\n          console.log(chalk.green(\"GitHub connected\"));\n          console.log(chalk.dim(`  Username: ${data.username}`));\n          if (data.repos && data.repos.length > 0) {\n            console.log(chalk.dim(`  Repos: ${data.repos.slice(0, 5).join(\", \")}${data.repos.length > 5 ? \"...\" : \"\"}`));\n          }\n        } else {\n          console.log(chalk.dim(\"GitHub not connected\"));\n          console.log(chalk.dim(\"  Connect with: beam github connect\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to check status\"));\n      }\n      return;\n    }\n\n    if (action === \"connect\") {\n      console.log();\n      console.log(chalk.bold(\"  Connect GitHub\"));\n      console.log();\n      console.log(chalk.dim(\"  Opening browser for GitHub authorization...\"));\n\n      const githubAuthUrl = `${API_URL}/api/auth/github`;\n      await open(githubAuthUrl);\n\n      console.log();\n      console.log(chalk.dim(\"  After authorizing, your GitHub will be connected.\"));\n      console.log(chalk.dim(\"  Check status with: beam github status\"));\n      return;\n    }\n\n    if (action === \"disconnect\") {\n      const spinner = ora(\"Disconnecting GitHub...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/github`, {\n          method: \"DELETE\",\n          headers: { Authorization: `Bearer ${auth.token}` },\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(\"GitHub disconnected.\"));\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to disconnect\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    if (action === \"post\") {\n      if (!options.owner || !options.repo || !options.pr || !options.tunnel) {\n        console.log(chalk.red(\"Missing required options\"));\n        console.log(chalk.dim(\"  Usage: beam github post --owner <owner> --repo <repo> --pr <number> --tunnel <name>\"));\n        return;\n      }\n\n      const spinner = ora(\"Posting tunnel URL to PR...\").start();\n\n      try {\n        const response = await fetch(`${API_URL}/api/github/comment`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${auth.token}`,\n          },\n          body: JSON.stringify({\n            owner: options.owner,\n            repo: options.repo,\n            prNumber: parseInt(options.pr),\n            tunnelName: options.tunnel,\n          }),\n        });\n\n        const data = await response.json();\n\n        if (data.success) {\n          spinner.succeed(chalk.green(\"Tunnel URL posted to PR!\"));\n          if (data.commentUrl) {\n            console.log(chalk.dim(`  ${data.commentUrl}`));\n          }\n        } else {\n          spinner.fail(chalk.red(data.error || \"Failed to post comment\"));\n        }\n      } catch {\n        spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n      }\n      return;\n    }\n\n    console.log(chalk.red(`Unknown action: ${action}`));\n    console.log(chalk.dim(\"  Valid actions: status, connect, disconnect, post\"));\n  });\n\n// ============================================================================\n// DEPRECATED COMMANDS (hidden, show helpful message)\n// ============================================================================\n\nprogram\n  .command(\"try\", { hidden: true })\n  .argument(\"<port>\")\n  .allowUnknownOption()\n  .action((port) => {\n    console.log(chalk.yellow(`Tip: Just use 'beam ${port}' now!`));\n    console.log();\n    handleTunnel([port], {});\n  });\n\nprogram\n  .command(\"quick\", { hidden: true })\n  .argument(\"<port>\")\n  .allowUnknownOption()\n  .action((port) => {\n    console.log(chalk.yellow(`Tip: Just use 'beam ${port}' now!`));\n    console.log();\n    handleTunnel([port], {});\n  });\n\nprogram\n  .command(\"connect\", { hidden: true })\n  .argument(\"<port>\")\n  .allowUnknownOption()\n  .action((port) => {\n    console.log(chalk.yellow(`Tip: Just use 'beam ${port}' now!`));\n    console.log();\n    handleTunnel([port], {});\n  });\n\nprogram\n  .command(\"webhook\", { hidden: true })\n  .argument(\"<port>\")\n  .allowUnknownOption()\n  .action((port) => {\n    console.log(chalk.yellow(`Tip: Use 'beam ${port} --webhook' now!`));\n    console.log();\n    handleTunnel([port], { webhook: true });\n  });\n\nprogram\n  .command(\"multi\", { hidden: true })\n  .argument(\"<ports...>\")\n  .allowUnknownOption()\n  .action((ports) => {\n    console.log(chalk.yellow(`Tip: Just use 'beam ${ports.join(\" \")}' now!`));\n    console.log();\n    handleTunnel(ports, {});\n  });\n\nprogram\n  .command(\"delete\", { hidden: true })\n  .argument(\"<name>\")\n  .action(async (name) => {\n    console.log(chalk.yellow(\"Tip: Use 'beam stop' instead of 'beam delete'\"));\n    console.log();\n\n    const auth = requireLogin();\n    if (!auth) return;\n\n    const spinner = ora(\"Stopping tunnel...\").start();\n\n    try {\n      const response = await fetch(`${API_URL}/api/tunnels/delete`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${auth.token}`,\n        },\n        body: JSON.stringify({ name }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        spinner.succeed(chalk.green(`Tunnel \"${name}\" stopped.`));\n      } else {\n        spinner.fail(chalk.red(data.error || \"Failed to stop tunnel\"));\n      }\n    } catch {\n      spinner.fail(chalk.red(\"Failed to connect to Beam\"));\n    }\n  });\n\n// Parse and run\nprogram.parse();\n","import { readFileSync, existsSync } from \"fs\";\nimport { join } from \"path\";\n\nexport interface BeamConfig {\n  port?: number;\n  name?: string;\n  copy?: boolean;\n  qr?: boolean;\n  urlOnly?: boolean;\n  inspect?: boolean;\n  subdomain?: string;\n  auth?: string;\n  token?: string;\n  allowIp?: string[];\n  https?: boolean;\n}\n\nconst CONFIG_FILES = [\n  \".beam.yaml\",\n  \".beam.yml\",\n  \"beam.config.js\",\n  \"beam.config.json\",\n];\n\n/**\n * Load beam configuration from the current directory\n * Looks for .beam.yaml, .beam.yml, beam.config.js, or beam.config.json\n */\nexport function loadConfig(cwd: string = process.cwd()): BeamConfig | null {\n  for (const filename of CONFIG_FILES) {\n    const filepath = join(cwd, filename);\n\n    if (!existsSync(filepath)) {\n      continue;\n    }\n\n    try {\n      if (filename.endsWith(\".yaml\") || filename.endsWith(\".yml\")) {\n        return parseYaml(filepath);\n      } else if (filename.endsWith(\".js\")) {\n        // Dynamic import for JS config\n        // eslint-disable-next-line @typescript-eslint/no-require-imports\n        const config = require(filepath);\n        return config.default || config;\n      } else if (filename.endsWith(\".json\")) {\n        const content = readFileSync(filepath, \"utf-8\");\n        return JSON.parse(content);\n      }\n    } catch (error) {\n      console.error(`Error loading config from ${filename}:`, error);\n      return null;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Simple YAML parser for beam config\n * Handles basic key: value pairs and booleans\n */\nfunction parseYaml(filepath: string): BeamConfig {\n  const content = readFileSync(filepath, \"utf-8\");\n  const config: BeamConfig = {};\n\n  const lines = content.split(\"\\n\");\n\n  for (const line of lines) {\n    const trimmed = line.trim();\n\n    // Skip comments and empty lines\n    if (!trimmed || trimmed.startsWith(\"#\")) {\n      continue;\n    }\n\n    // Parse key: value\n    const colonIndex = trimmed.indexOf(\":\");\n    if (colonIndex === -1) continue;\n\n    const key = trimmed.slice(0, colonIndex).trim();\n    let value: string | number | boolean = trimmed.slice(colonIndex + 1).trim();\n\n    // Remove quotes\n    if ((value.startsWith('\"') && value.endsWith('\"')) ||\n        (value.startsWith(\"'\") && value.endsWith(\"'\"))) {\n      value = value.slice(1, -1);\n    }\n\n    // Parse booleans\n    if (value === \"true\") {\n      value = true;\n    } else if (value === \"false\") {\n      value = false;\n    } else if (!isNaN(Number(value)) && value !== \"\") {\n      value = Number(value);\n    }\n\n    // Map to config\n    switch (key) {\n      case \"port\":\n        config.port = typeof value === \"number\" ? value : parseInt(String(value));\n        break;\n      case \"name\":\n        config.name = String(value);\n        break;\n      case \"copy\":\n        config.copy = Boolean(value);\n        break;\n      case \"qr\":\n        config.qr = Boolean(value);\n        break;\n      case \"url-only\":\n      case \"urlOnly\":\n        config.urlOnly = Boolean(value);\n        break;\n      case \"inspect\":\n        config.inspect = Boolean(value);\n        break;\n      case \"subdomain\":\n        config.subdomain = String(value);\n        break;\n      case \"auth\":\n        config.auth = String(value);\n        break;\n      case \"token\":\n        config.token = String(value);\n        break;\n      case \"allow-ip\":\n      case \"allowIp\":\n        // Handle comma-separated or array format\n        if (typeof value === \"string\") {\n          config.allowIp = value.split(\",\").map(ip => ip.trim());\n        }\n        break;\n      case \"https\":\n        config.https = Boolean(value);\n        break;\n    }\n  }\n\n  return config;\n}\n\n/**\n * Generate a default config file content\n */\nexport function generateDefaultConfig(port?: number): string {\n  return `# Beam Configuration\n# https://beam.byronwade.com\n\n# Local port to expose\nport: ${port || 3000}\n\n# Tunnel name (optional)\n# name: my-app\n\n# Auto-copy URL to clipboard\ncopy: true\n\n# Show QR code for mobile testing\n# qr: false\n\n# Output only the URL (for scripts)\n# url-only: false\n\n# Open request inspector on localhost:4040\n# inspect: false\n\n# Create local HTTPS proxy (auto-generates certificates)\n# https: false\n\n# Reserved subdomain (requires beam reserve <name>)\n# subdomain: my-app\n\n# Basic auth protection (user:password)\n# auth: admin:secret\n\n# Token auth (Bearer or X-Beam-Token header)\n# token: my-secret-token\n\n# IP whitelist (comma-separated)\n# allow-ip: 1.2.3.4, 5.6.7.8\n`;\n}\n\n/**\n * Check which config files exist\n */\nexport function getExistingConfigFile(cwd: string = process.cwd()): string | null {\n  for (const filename of CONFIG_FILES) {\n    const filepath = join(cwd, filename);\n    if (existsSync(filepath)) {\n      return filename;\n    }\n  }\n  return null;\n}\n","import { createServer, IncomingMessage, ServerResponse } from \"http\";\nimport { request as httpRequest } from \"http\";\nimport chalk from \"chalk\";\nimport { getInspectorHTML } from \"./inspector-ui.js\";\n\ninterface RequestLog {\n  id: string;\n  timestamp: Date;\n  method: string;\n  path: string;\n  headers: Record<string, string | string[] | undefined>;\n  body?: string;\n  response?: {\n    status: number;\n    headers: Record<string, string | string[] | undefined>;\n    body?: string;\n    duration: number;\n  };\n}\n\nconst MAX_BODY_SIZE = 1024 * 100; // 100KB max body to store\nlet requestLogs: RequestLog[] = [];\nconst MAX_LOGS = 100;\n\n/**\n * Format bytes to human readable\n */\nfunction formatBytes(bytes: number): string {\n  if (bytes < 1024) return `${bytes}B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)}KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)}MB`;\n}\n\n/**\n * Get status color based on code\n */\nfunction getStatusColor(status: number): (text: string) => string {\n  if (status >= 500) return chalk.red;\n  if (status >= 400) return chalk.yellow;\n  if (status >= 300) return chalk.cyan;\n  if (status >= 200) return chalk.green;\n  return chalk.white;\n}\n\n/**\n * Format duration in ms\n */\nfunction formatDuration(ms: number): string {\n  if (ms < 1000) return `${ms}ms`;\n  return `${(ms / 1000).toFixed(2)}s`;\n}\n\n/**\n * Log a request to console in a clean format\n */\nfunction logRequest(log: RequestLog): void {\n  const time = log.timestamp.toLocaleTimeString(\"en-US\", { hour12: false });\n  const method = log.method.padEnd(6);\n  const path = log.path.length > 50 ? log.path.slice(0, 47) + \"...\" : log.path;\n\n  if (log.response) {\n    const statusColor = getStatusColor(log.response.status);\n    const status = statusColor(String(log.response.status));\n    const duration = chalk.dim(formatDuration(log.response.duration));\n\n    console.log(`  ${chalk.dim(time)} ${chalk.bold(method)} ${path} ${status} ${duration}`);\n  } else {\n    console.log(`  ${chalk.dim(time)} ${chalk.bold(method)} ${path} ${chalk.dim(\"pending...\")}`);\n  }\n}\n\ninterface InspectorOptions {\n  basicAuth?: string; // \"user:password\" format\n}\n\n/**\n * Start the inspector proxy server with Web UI\n * Serves UI on inspectorPort, proxies requests to targetPort\n */\nexport function startInspector(\n  targetPort: number,\n  inspectorPort: number = 4040,\n  options: InspectorOptions = {}\n): Promise<{ close: () => void }> {\n  return new Promise((resolve, reject) => {\n    // Clear logs when starting new inspector\n    requestLogs = [];\n\n    const server = createServer(async (req: IncomingMessage, res: ServerResponse) => {\n      const url = req.url || \"/\";\n\n      // Handle inspector UI and API requests\n      if (url === \"/__beam__\" || url === \"/__beam__/\") {\n        res.writeHead(200, { \"Content-Type\": \"text/html\" });\n        res.end(getInspectorHTML(targetPort, inspectorPort));\n        return;\n      }\n\n      if (url === \"/__beam__/requests\") {\n        res.writeHead(200, { \"Content-Type\": \"application/json\" });\n        res.end(JSON.stringify(requestLogs));\n        return;\n      }\n\n      if (url === \"/__beam__/clear\" && req.method === \"POST\") {\n        requestLogs = [];\n        res.writeHead(200, { \"Content-Type\": \"application/json\" });\n        res.end(JSON.stringify({ success: true }));\n        return;\n      }\n\n      // Check basic auth if configured (not for inspector UI)\n      if (options.basicAuth) {\n        const authHeader = req.headers.authorization;\n        const expectedAuth = `Basic ${Buffer.from(options.basicAuth).toString(\"base64\")}`;\n\n        if (!authHeader || authHeader !== expectedAuth) {\n          res.writeHead(401, {\n            \"WWW-Authenticate\": 'Basic realm=\"Beam Tunnel\"',\n            \"Content-Type\": \"text/plain\",\n          });\n          res.end(\"Unauthorized\");\n          return;\n        }\n      }\n\n      const startTime = Date.now();\n      const logId = `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n\n      // Collect request body\n      const bodyChunks: Buffer[] = [];\n      let bodySize = 0;\n\n      req.on(\"data\", (chunk: Buffer) => {\n        bodySize += chunk.length;\n        if (bodySize <= MAX_BODY_SIZE) {\n          bodyChunks.push(chunk);\n        }\n      });\n\n      req.on(\"end\", () => {\n        const requestBody = bodySize <= MAX_BODY_SIZE\n          ? Buffer.concat(bodyChunks).toString(\"utf-8\")\n          : `[Body too large: ${formatBytes(bodySize)}]`;\n\n        const log: RequestLog = {\n          id: logId,\n          timestamp: new Date(),\n          method: req.method || \"GET\",\n          path: req.url || \"/\",\n          headers: req.headers as Record<string, string | string[] | undefined>,\n          body: requestBody || undefined,\n        };\n\n        // Add to logs immediately (shows as pending)\n        requestLogs.unshift(log);\n        if (requestLogs.length > MAX_LOGS) {\n          requestLogs.pop();\n        }\n\n        // Forward request to target\n        const proxyReq = httpRequest(\n          {\n            hostname: \"localhost\",\n            port: targetPort,\n            path: req.url,\n            method: req.method,\n            headers: req.headers,\n          },\n          (proxyRes) => {\n            const responseChunks: Buffer[] = [];\n            let responseSize = 0;\n\n            proxyRes.on(\"data\", (chunk: Buffer) => {\n              responseSize += chunk.length;\n              if (responseSize <= MAX_BODY_SIZE) {\n                responseChunks.push(chunk);\n              }\n              res.write(chunk);\n            });\n\n            proxyRes.on(\"end\", () => {\n              const duration = Date.now() - startTime;\n              const responseBody = responseSize <= MAX_BODY_SIZE\n                ? Buffer.concat(responseChunks).toString(\"utf-8\")\n                : `[Body too large: ${formatBytes(responseSize)}]`;\n\n              log.response = {\n                status: proxyRes.statusCode || 500,\n                headers: proxyRes.headers as Record<string, string | string[] | undefined>,\n                body: responseBody,\n                duration,\n              };\n\n              logRequest(log);\n              res.end();\n            });\n\n            // Copy response headers\n            res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n          }\n        );\n\n        proxyReq.on(\"error\", (err) => {\n          log.response = {\n            status: 502,\n            headers: {},\n            body: err.message,\n            duration: Date.now() - startTime,\n          };\n\n          logRequest(log);\n\n          res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n          res.end(`Proxy Error: ${err.message}`);\n        });\n\n        // Forward request body\n        if (bodyChunks.length > 0) {\n          proxyReq.write(Buffer.concat(bodyChunks));\n        }\n        proxyReq.end();\n      });\n    });\n\n    server.on(\"error\", (err: NodeJS.ErrnoException) => {\n      if (err.code === \"EADDRINUSE\") {\n        // Try next port\n        startInspector(targetPort, inspectorPort + 1, options)\n          .then(resolve)\n          .catch(reject);\n      } else {\n        reject(err);\n      }\n    });\n\n    server.listen(inspectorPort, () => {\n      console.log();\n      console.log(chalk.dim(`  Inspector UI: `) + chalk.cyan(`http://localhost:${inspectorPort}/__beam__`));\n      console.log(chalk.dim(`  Proxying to: http://localhost:${targetPort}`));\n      console.log();\n\n      resolve({\n        close: () => server.close(),\n      });\n    });\n  });\n}\n\n/**\n * Get all request logs\n */\nexport function getRequestLogs(): RequestLog[] {\n  return [...requestLogs];\n}\n\n/**\n * Clear all request logs\n */\nexport function clearRequestLogs(): void {\n  requestLogs = [];\n}\n","/**\n * Inspector Web UI - serves a real-time request inspector interface\n */\n\nexport function getInspectorHTML(targetPort: number, proxyPort: number): string {\n  return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Beam Inspector - localhost:${targetPort}</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      background: #0a0a0a;\n      color: #e5e5e5;\n      min-height: 100vh;\n    }\n    .header {\n      background: #171717;\n      border-bottom: 1px solid #262626;\n      padding: 16px 24px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      position: sticky;\n      top: 0;\n      z-index: 100;\n    }\n    .logo {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n    .logo svg {\n      width: 28px;\n      height: 28px;\n    }\n    .logo h1 {\n      font-size: 18px;\n      font-weight: 600;\n    }\n    .logo span {\n      color: #737373;\n      font-size: 14px;\n    }\n    .status {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 8px 16px;\n      background: #262626;\n      border-radius: 8px;\n      font-size: 13px;\n    }\n    .status-dot {\n      width: 8px;\n      height: 8px;\n      border-radius: 50%;\n      background: #22c55e;\n      animation: pulse 2s infinite;\n    }\n    @keyframes pulse {\n      0%, 100% { opacity: 1; }\n      50% { opacity: 0.5; }\n    }\n    .container {\n      display: flex;\n      height: calc(100vh - 65px);\n    }\n    .requests-list {\n      width: 400px;\n      border-right: 1px solid #262626;\n      overflow-y: auto;\n      flex-shrink: 0;\n    }\n    .request-item {\n      padding: 12px 16px;\n      border-bottom: 1px solid #262626;\n      cursor: pointer;\n      transition: background 0.15s;\n    }\n    .request-item:hover {\n      background: #171717;\n    }\n    .request-item.selected {\n      background: #1e3a5f;\n      border-left: 3px solid #3b82f6;\n    }\n    .request-header {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      margin-bottom: 4px;\n    }\n    .method {\n      font-weight: 600;\n      font-size: 12px;\n      padding: 2px 6px;\n      border-radius: 4px;\n      min-width: 50px;\n      text-align: center;\n    }\n    .method.GET { background: #064e3b; color: #34d399; }\n    .method.POST { background: #1e3a5f; color: #60a5fa; }\n    .method.PUT { background: #4c1d95; color: #a78bfa; }\n    .method.DELETE { background: #7f1d1d; color: #f87171; }\n    .method.PATCH { background: #713f12; color: #fbbf24; }\n    .path {\n      font-size: 13px;\n      color: #e5e5e5;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      flex: 1;\n    }\n    .request-meta {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      font-size: 12px;\n      color: #737373;\n    }\n    .status-badge {\n      padding: 2px 6px;\n      border-radius: 4px;\n      font-weight: 500;\n    }\n    .status-2xx { background: #064e3b; color: #34d399; }\n    .status-3xx { background: #164e63; color: #22d3ee; }\n    .status-4xx { background: #713f12; color: #fbbf24; }\n    .status-5xx { background: #7f1d1d; color: #f87171; }\n    .detail-panel {\n      flex: 1;\n      overflow-y: auto;\n      padding: 24px;\n    }\n    .empty-state {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n      color: #737373;\n    }\n    .empty-state svg {\n      width: 64px;\n      height: 64px;\n      margin-bottom: 16px;\n      opacity: 0.5;\n    }\n    .tabs {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 16px;\n      border-bottom: 1px solid #262626;\n      padding-bottom: 8px;\n    }\n    .tab {\n      padding: 8px 16px;\n      background: none;\n      border: none;\n      color: #737373;\n      cursor: pointer;\n      font-size: 14px;\n      border-radius: 6px;\n      transition: all 0.15s;\n    }\n    .tab:hover {\n      color: #e5e5e5;\n      background: #262626;\n    }\n    .tab.active {\n      color: #e5e5e5;\n      background: #262626;\n    }\n    .section {\n      margin-bottom: 24px;\n    }\n    .section-title {\n      font-size: 12px;\n      font-weight: 600;\n      text-transform: uppercase;\n      color: #737373;\n      margin-bottom: 12px;\n    }\n    .headers-table {\n      width: 100%;\n      font-size: 13px;\n    }\n    .headers-table tr {\n      border-bottom: 1px solid #262626;\n    }\n    .headers-table td {\n      padding: 8px 0;\n      vertical-align: top;\n    }\n    .headers-table td:first-child {\n      color: #a78bfa;\n      font-weight: 500;\n      width: 200px;\n    }\n    .headers-table td:last-child {\n      color: #e5e5e5;\n      word-break: break-all;\n    }\n    .body-content {\n      background: #171717;\n      border-radius: 8px;\n      padding: 16px;\n      font-family: 'SF Mono', Monaco, monospace;\n      font-size: 13px;\n      line-height: 1.5;\n      overflow-x: auto;\n      white-space: pre-wrap;\n      word-break: break-all;\n    }\n    .replay-btn {\n      padding: 8px 16px;\n      background: #3b82f6;\n      color: white;\n      border: none;\n      border-radius: 6px;\n      font-size: 13px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      transition: background 0.15s;\n    }\n    .replay-btn:hover {\n      background: #2563eb;\n    }\n    .clear-btn {\n      padding: 8px 16px;\n      background: #262626;\n      color: #e5e5e5;\n      border: none;\n      border-radius: 6px;\n      font-size: 13px;\n      cursor: pointer;\n      transition: background 0.15s;\n    }\n    .clear-btn:hover {\n      background: #404040;\n    }\n    .actions {\n      display: flex;\n      gap: 8px;\n    }\n    .request-count {\n      background: #262626;\n      padding: 4px 10px;\n      border-radius: 12px;\n      font-size: 12px;\n      color: #a3a3a3;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <div class=\"logo\">\n      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <path d=\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"/>\n      </svg>\n      <div>\n        <h1>Beam Inspector</h1>\n        <span>localhost:${targetPort} via :${proxyPort}</span>\n      </div>\n    </div>\n    <div class=\"actions\">\n      <span class=\"request-count\" id=\"requestCount\">0 requests</span>\n      <button class=\"clear-btn\" onclick=\"clearRequests()\">Clear</button>\n      <div class=\"status\">\n        <div class=\"status-dot\"></div>\n        Listening\n      </div>\n    </div>\n  </div>\n\n  <div class=\"container\">\n    <div class=\"requests-list\" id=\"requestsList\">\n      <div class=\"empty-state\" id=\"emptyState\">\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n          <path d=\"M12 2a10 10 0 100 20 10 10 0 000-20z\"/>\n          <path d=\"M12 6v6l4 2\"/>\n        </svg>\n        <p>Waiting for requests...</p>\n        <p style=\"font-size: 12px; margin-top: 8px;\">Make a request to your tunnel URL</p>\n      </div>\n    </div>\n\n    <div class=\"detail-panel\" id=\"detailPanel\">\n      <div class=\"empty-state\">\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n          <path d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2\"/>\n          <rect x=\"9\" y=\"3\" width=\"6\" height=\"4\" rx=\"1\"/>\n        </svg>\n        <p>Select a request to view details</p>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    let requests = [];\n    let selectedId = null;\n\n    function formatTime(date) {\n      return new Date(date).toLocaleTimeString('en-US', { hour12: false });\n    }\n\n    function getStatusClass(status) {\n      if (status >= 500) return 'status-5xx';\n      if (status >= 400) return 'status-4xx';\n      if (status >= 300) return 'status-3xx';\n      return 'status-2xx';\n    }\n\n    function formatBody(body, contentType) {\n      if (!body) return '<em style=\"color: #737373\">No body</em>';\n      try {\n        if (contentType && contentType.includes('application/json')) {\n          return JSON.stringify(JSON.parse(body), null, 2);\n        }\n      } catch {}\n      return body;\n    }\n\n    function renderRequests() {\n      const list = document.getElementById('requestsList');\n      const emptyState = document.getElementById('emptyState');\n      const countEl = document.getElementById('requestCount');\n\n      countEl.textContent = requests.length + ' request' + (requests.length !== 1 ? 's' : '');\n\n      if (requests.length === 0) {\n        emptyState.style.display = 'flex';\n        list.innerHTML = '';\n        list.appendChild(emptyState);\n        return;\n      }\n\n      emptyState.style.display = 'none';\n      list.innerHTML = requests.map(req => \\`\n        <div class=\"request-item \\${selectedId === req.id ? 'selected' : ''}\" onclick=\"selectRequest('\\${req.id}')\">\n          <div class=\"request-header\">\n            <span class=\"method \\${req.method}\">\\${req.method}</span>\n            <span class=\"path\">\\${req.path}</span>\n          </div>\n          <div class=\"request-meta\">\n            <span>\\${formatTime(req.timestamp)}</span>\n            \\${req.response ? \\`\n              <span class=\"status-badge \\${getStatusClass(req.response.status)}\">\\${req.response.status}</span>\n              <span>\\${req.response.duration}ms</span>\n            \\` : '<span style=\"color: #fbbf24\">pending...</span>'}\n          </div>\n        </div>\n      \\`).join('');\n    }\n\n    function selectRequest(id) {\n      selectedId = id;\n      renderRequests();\n\n      const req = requests.find(r => r.id === id);\n      if (!req) return;\n\n      const panel = document.getElementById('detailPanel');\n      const reqHeaders = Object.entries(req.headers || {})\n        .map(([k, v]) => \\`<tr><td>\\${k}</td><td>\\${Array.isArray(v) ? v.join(', ') : v}</td></tr>\\`)\n        .join('');\n      const resHeaders = req.response ? Object.entries(req.response.headers || {})\n        .map(([k, v]) => \\`<tr><td>\\${k}</td><td>\\${Array.isArray(v) ? v.join(', ') : v}</td></tr>\\`)\n        .join('') : '';\n\n      panel.innerHTML = \\`\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;\">\n          <div>\n            <span class=\"method \\${req.method}\" style=\"font-size: 14px; padding: 4px 12px;\">\\${req.method}</span>\n            <span style=\"margin-left: 12px; font-size: 16px;\">\\${req.path}</span>\n          </div>\n          <button class=\"replay-btn\" onclick=\"replayRequest('\\${req.id}')\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <path d=\"M3 12a9 9 0 109-9 9.75 9.75 0 00-6.74 2.74L3 8\"/>\n              <path d=\"M3 3v5h5\"/>\n            </svg>\n            Replay\n          </button>\n        </div>\n\n        <div class=\"tabs\">\n          <button class=\"tab active\" onclick=\"showTab(this, 'request')\">Request</button>\n          <button class=\"tab\" onclick=\"showTab(this, 'response')\">Response</button>\n        </div>\n\n        <div id=\"request-tab\">\n          <div class=\"section\">\n            <div class=\"section-title\">Headers</div>\n            <table class=\"headers-table\">\n              \\${reqHeaders || '<tr><td colspan=\"2\" style=\"color: #737373\">No headers</td></tr>'}\n            </table>\n          </div>\n\n          <div class=\"section\">\n            <div class=\"section-title\">Body</div>\n            <div class=\"body-content\">\\${formatBody(req.body, req.headers['content-type'])}</div>\n          </div>\n        </div>\n\n        <div id=\"response-tab\" style=\"display: none;\">\n          \\${req.response ? \\`\n            <div class=\"section\">\n              <div class=\"section-title\">Status</div>\n              <span class=\"status-badge \\${getStatusClass(req.response.status)}\" style=\"font-size: 14px; padding: 4px 12px;\">\n                \\${req.response.status}\n              </span>\n              <span style=\"margin-left: 8px; color: #737373\">\\${req.response.duration}ms</span>\n            </div>\n\n            <div class=\"section\">\n              <div class=\"section-title\">Headers</div>\n              <table class=\"headers-table\">\n                \\${resHeaders || '<tr><td colspan=\"2\" style=\"color: #737373\">No headers</td></tr>'}\n              </table>\n            </div>\n\n            <div class=\"section\">\n              <div class=\"section-title\">Body</div>\n              <div class=\"body-content\">\\${formatBody(req.response.body, req.response.headers['content-type'])}</div>\n            </div>\n          \\` : '<div class=\"empty-state\"><p>Response pending...</p></div>'}\n        </div>\n      \\`;\n    }\n\n    function showTab(btn, tab) {\n      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));\n      btn.classList.add('active');\n      document.getElementById('request-tab').style.display = tab === 'request' ? 'block' : 'none';\n      document.getElementById('response-tab').style.display = tab === 'response' ? 'block' : 'none';\n    }\n\n    function clearRequests() {\n      requests = [];\n      selectedId = null;\n      renderRequests();\n      document.getElementById('detailPanel').innerHTML = \\`\n        <div class=\"empty-state\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n            <path d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2\"/>\n            <rect x=\"9\" y=\"3\" width=\"6\" height=\"4\" rx=\"1\"/>\n          </svg>\n          <p>Select a request to view details</p>\n        </div>\n      \\`;\n      fetch('/__beam__/clear', { method: 'POST' });\n    }\n\n    async function replayRequest(id) {\n      const req = requests.find(r => r.id === id);\n      if (!req) return;\n\n      try {\n        await fetch(req.path, {\n          method: req.method,\n          headers: req.headers,\n          body: req.body || undefined,\n        });\n      } catch (e) {\n        console.error('Replay failed:', e);\n      }\n    }\n\n    // Poll for new requests\n    async function pollRequests() {\n      try {\n        const res = await fetch('/__beam__/requests');\n        const data = await res.json();\n        requests = data;\n        renderRequests();\n        if (selectedId) {\n          const stillExists = requests.find(r => r.id === selectedId);\n          if (stillExists) selectRequest(selectedId);\n        }\n      } catch (e) {\n        console.error('Poll failed:', e);\n      }\n      setTimeout(pollRequests, 500);\n    }\n\n    pollRequests();\n  </script>\n</body>\n</html>`;\n}\n","import { createServer, IncomingMessage, ServerResponse } from \"http\";\nimport { request as httpRequest } from \"http\";\nimport chalk from \"chalk\";\n\n/**\n * Start a basic auth proxy server\n * Adds HTTP Basic Auth protection to any local service\n */\nexport function startAuthProxy(\n  targetPort: number,\n  proxyPort: number,\n  credentials: string // \"user:password\" format\n): Promise<{ close: () => void; port: number }> {\n  return new Promise((resolve, reject) => {\n    const expectedAuth = `Basic ${Buffer.from(credentials).toString(\"base64\")}`;\n\n    const server = createServer((req: IncomingMessage, res: ServerResponse) => {\n      // Check basic auth\n      const authHeader = req.headers.authorization;\n\n      if (!authHeader || authHeader !== expectedAuth) {\n        res.writeHead(401, {\n          \"WWW-Authenticate\": 'Basic realm=\"Beam Tunnel\"',\n          \"Content-Type\": \"text/plain\",\n        });\n        res.end(\"Unauthorized\");\n        return;\n      }\n\n      // Collect request body\n      const bodyChunks: Buffer[] = [];\n\n      req.on(\"data\", (chunk: Buffer) => {\n        bodyChunks.push(chunk);\n      });\n\n      req.on(\"end\", () => {\n        // Forward request to target\n        const proxyReq = httpRequest(\n          {\n            hostname: \"localhost\",\n            port: targetPort,\n            path: req.url,\n            method: req.method,\n            headers: req.headers,\n          },\n          (proxyRes) => {\n            // Copy response headers and stream response\n            res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n            proxyRes.pipe(res);\n          }\n        );\n\n        proxyReq.on(\"error\", (err) => {\n          res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n          res.end(`Proxy Error: ${err.message}`);\n        });\n\n        // Forward request body\n        if (bodyChunks.length > 0) {\n          proxyReq.write(Buffer.concat(bodyChunks));\n        }\n        proxyReq.end();\n      });\n    });\n\n    server.on(\"error\", (err: NodeJS.ErrnoException) => {\n      if (err.code === \"EADDRINUSE\") {\n        // Try next port\n        startAuthProxy(targetPort, proxyPort + 1, credentials)\n          .then(resolve)\n          .catch(reject);\n      } else {\n        reject(err);\n      }\n    });\n\n    server.listen(proxyPort, () => {\n      console.log(chalk.dim(`  Auth proxy: http://localhost:${proxyPort} → http://localhost:${targetPort}`));\n\n      resolve({\n        close: () => server.close(),\n        port: proxyPort,\n      });\n    });\n  });\n}\n","import { createServer, IncomingMessage, ServerResponse } from \"http\";\nimport { request as httpRequest } from \"http\";\nimport chalk from \"chalk\";\n\nexport interface SecurityOptions {\n  basicAuth?: string;      // \"user:password\" format\n  token?: string;          // Bearer token or X-Beam-Token header\n  allowedIPs?: string[];   // List of allowed IP addresses\n}\n\n/**\n * Get client IP from request\n */\nfunction getClientIP(req: IncomingMessage): string {\n  // Check various headers for proxied requests\n  const forwarded = req.headers[\"x-forwarded-for\"];\n  if (forwarded) {\n    const ips = Array.isArray(forwarded) ? forwarded[0] : forwarded;\n    return ips.split(\",\")[0].trim();\n  }\n\n  const realIP = req.headers[\"x-real-ip\"];\n  if (realIP) {\n    return Array.isArray(realIP) ? realIP[0] : realIP;\n  }\n\n  // Fall back to socket address\n  return req.socket.remoteAddress || \"unknown\";\n}\n\n/**\n * Check if IP matches allowed list (supports CIDR notation in future)\n */\nfunction isIPAllowed(clientIP: string, allowedIPs: string[]): boolean {\n  // Normalize IPv6 localhost\n  const normalizedIP = clientIP === \"::1\" ? \"127.0.0.1\" : clientIP;\n  const cleanIP = normalizedIP.replace(/^::ffff:/, \"\");\n\n  return allowedIPs.some(allowed => {\n    const cleanAllowed = allowed.replace(/^::ffff:/, \"\");\n    return cleanIP === cleanAllowed || cleanIP === \"127.0.0.1\" && cleanAllowed === \"localhost\";\n  });\n}\n\n/**\n * Start a security proxy server with multiple auth methods\n */\nexport function startSecurityProxy(\n  targetPort: number,\n  proxyPort: number,\n  options: SecurityOptions\n): Promise<{ close: () => void; port: number }> {\n  return new Promise((resolve, reject) => {\n    const server = createServer((req: IncomingMessage, res: ServerResponse) => {\n      // Check IP whitelist first\n      if (options.allowedIPs && options.allowedIPs.length > 0) {\n        const clientIP = getClientIP(req);\n        if (!isIPAllowed(clientIP, options.allowedIPs)) {\n          console.log(chalk.yellow(`  Blocked IP: ${clientIP}`));\n          res.writeHead(403, { \"Content-Type\": \"text/plain\" });\n          res.end(\"Forbidden: IP not allowed\");\n          return;\n        }\n      }\n\n      // Check basic auth\n      if (options.basicAuth) {\n        const authHeader = req.headers.authorization;\n        const expectedAuth = `Basic ${Buffer.from(options.basicAuth).toString(\"base64\")}`;\n\n        if (!authHeader || authHeader !== expectedAuth) {\n          res.writeHead(401, {\n            \"WWW-Authenticate\": 'Basic realm=\"Beam Tunnel\"',\n            \"Content-Type\": \"text/plain\",\n          });\n          res.end(\"Unauthorized\");\n          return;\n        }\n      }\n\n      // Check token auth\n      if (options.token) {\n        const authHeader = req.headers.authorization;\n        const tokenHeader = req.headers[\"x-beam-token\"];\n        const expectedBearer = `Bearer ${options.token}`;\n\n        const hasValidAuth = authHeader === expectedBearer || tokenHeader === options.token;\n\n        if (!hasValidAuth) {\n          res.writeHead(401, { \"Content-Type\": \"text/plain\" });\n          res.end(\"Unauthorized: Invalid token\");\n          return;\n        }\n      }\n\n      // Collect request body\n      const bodyChunks: Buffer[] = [];\n\n      req.on(\"data\", (chunk: Buffer) => {\n        bodyChunks.push(chunk);\n      });\n\n      req.on(\"end\", () => {\n        // Forward request to target\n        const proxyReq = httpRequest(\n          {\n            hostname: \"localhost\",\n            port: targetPort,\n            path: req.url,\n            method: req.method,\n            headers: req.headers,\n          },\n          (proxyRes) => {\n            res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n            proxyRes.pipe(res);\n          }\n        );\n\n        proxyReq.on(\"error\", (err) => {\n          res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n          res.end(`Proxy Error: ${err.message}`);\n        });\n\n        if (bodyChunks.length > 0) {\n          proxyReq.write(Buffer.concat(bodyChunks));\n        }\n        proxyReq.end();\n      });\n    });\n\n    server.on(\"error\", (err: NodeJS.ErrnoException) => {\n      if (err.code === \"EADDRINUSE\") {\n        startSecurityProxy(targetPort, proxyPort + 1, options)\n          .then(resolve)\n          .catch(reject);\n      } else {\n        reject(err);\n      }\n    });\n\n    server.listen(proxyPort, () => {\n      const authTypes: string[] = [];\n      if (options.basicAuth) authTypes.push(\"basic-auth\");\n      if (options.token) authTypes.push(\"token\");\n      if (options.allowedIPs?.length) authTypes.push(`ip-whitelist(${options.allowedIPs.length})`);\n\n      console.log(chalk.dim(`  Security: ${authTypes.join(\", \")} on :${proxyPort}`));\n\n      resolve({\n        close: () => server.close(),\n        port: proxyPort,\n      });\n    });\n  });\n}\n","import { createServer, IncomingMessage, ServerResponse } from \"http\";\nimport { request as httpRequest } from \"http\";\nimport chalk from \"chalk\";\nimport { getInspectorHTML } from \"./inspector-ui.js\";\n\ninterface WebhookRequest {\n  id: string;\n  timestamp: Date;\n  method: string;\n  path: string;\n  headers: Record<string, string | string[] | undefined>;\n  body?: string;\n  response?: {\n    status: number;\n    headers: Record<string, string | string[] | undefined>;\n    body?: string;\n    duration: number;\n  };\n}\n\nconst MAX_BODY_SIZE = 1024 * 100; // 100KB\nlet webhookRequests: WebhookRequest[] = [];\nconst MAX_REQUESTS = 100;\n\nfunction formatBytes(bytes: number): string {\n  if (bytes < 1024) return `${bytes}B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)}KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)}MB`;\n}\n\nfunction getStatusColor(status: number): (text: string) => string {\n  if (status >= 500) return chalk.red;\n  if (status >= 400) return chalk.yellow;\n  if (status >= 300) return chalk.cyan;\n  if (status >= 200) return chalk.green;\n  return chalk.white;\n}\n\nfunction formatDuration(ms: number): string {\n  if (ms < 1000) return `${ms}ms`;\n  return `${(ms / 1000).toFixed(2)}s`;\n}\n\nfunction logRequest(log: WebhookRequest): void {\n  const time = log.timestamp.toLocaleTimeString(\"en-US\", { hour12: false });\n  const method = log.method.padEnd(6);\n  const path = log.path.length > 50 ? log.path.slice(0, 47) + \"...\" : log.path;\n\n  if (log.response) {\n    const statusColor = getStatusColor(log.response.status);\n    const status = statusColor(String(log.response.status));\n    const duration = chalk.dim(formatDuration(log.response.duration));\n    console.log(`  ${chalk.dim(time)} ${chalk.bold(method)} ${path} ${status} ${duration}`);\n  } else {\n    console.log(`  ${chalk.dim(time)} ${chalk.bold(method)} ${path} ${chalk.dim(\"pending...\")}`);\n  }\n}\n\n/**\n * Replay a captured webhook request\n */\nexport async function replayWebhook(\n  request: WebhookRequest,\n  targetPort: number\n): Promise<{ status: number; body: string; duration: number }> {\n  return new Promise((resolve, reject) => {\n    const startTime = Date.now();\n\n    const req = httpRequest(\n      {\n        hostname: \"localhost\",\n        port: targetPort,\n        path: request.path,\n        method: request.method,\n        headers: request.headers as Record<string, string>,\n      },\n      (res) => {\n        const chunks: Buffer[] = [];\n\n        res.on(\"data\", (chunk) => chunks.push(chunk));\n        res.on(\"end\", () => {\n          resolve({\n            status: res.statusCode || 500,\n            body: Buffer.concat(chunks).toString(\"utf-8\"),\n            duration: Date.now() - startTime,\n          });\n        });\n      }\n    );\n\n    req.on(\"error\", reject);\n\n    if (request.body) {\n      req.write(request.body);\n    }\n    req.end();\n  });\n}\n\n/**\n * Get webhook UI HTML with replay functionality\n */\nfunction getWebhookHTML(targetPort: number, proxyPort: number): string {\n  // Use the base inspector HTML but with webhook-specific additions\n  const baseHTML = getInspectorHTML(targetPort, proxyPort);\n\n  // Modify the title and add replay endpoint\n  return baseHTML\n    .replace(\"<title>Beam Inspector\", \"<title>Beam Webhook Capture\")\n    .replace(\"Beam Inspector\", \"Beam Webhooks\")\n    .replace(\n      \"async function replayRequest(id)\",\n      `async function replayRequest(id) {\n      const req = requests.find(r => r.id === id);\n      if (!req) return;\n\n      try {\n        const res = await fetch('/__beam__/replay', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ id })\n        });\n        const result = await res.json();\n        if (result.success) {\n          console.log('Replayed:', result.status, result.duration + 'ms');\n        }\n      } catch (e) {\n        console.error('Replay failed:', e);\n      }\n    }\n\n    async function _replayRequest_disabled(id)`\n    );\n}\n\ninterface WebhookOptions {\n  basicAuth?: string;\n}\n\n/**\n * Start webhook capture server\n */\nexport function startWebhookCapture(\n  targetPort: number,\n  webhookPort: number = 4040,\n  options: WebhookOptions = {}\n): Promise<{ close: () => void; getRequests: () => WebhookRequest[] }> {\n  return new Promise((resolve, reject) => {\n    webhookRequests = [];\n\n    const server = createServer(async (req: IncomingMessage, res: ServerResponse) => {\n      const url = req.url || \"/\";\n\n      // Serve webhook UI\n      if (url === \"/__beam__\" || url === \"/__beam__/\") {\n        res.writeHead(200, { \"Content-Type\": \"text/html\" });\n        res.end(getWebhookHTML(targetPort, webhookPort));\n        return;\n      }\n\n      // Get captured requests\n      if (url === \"/__beam__/requests\") {\n        res.writeHead(200, { \"Content-Type\": \"application/json\" });\n        res.end(JSON.stringify(webhookRequests));\n        return;\n      }\n\n      // Clear requests\n      if (url === \"/__beam__/clear\" && req.method === \"POST\") {\n        webhookRequests = [];\n        res.writeHead(200, { \"Content-Type\": \"application/json\" });\n        res.end(JSON.stringify({ success: true }));\n        return;\n      }\n\n      // Replay request\n      if (url === \"/__beam__/replay\" && req.method === \"POST\") {\n        const bodyChunks: Buffer[] = [];\n        req.on(\"data\", (chunk) => bodyChunks.push(chunk));\n        req.on(\"end\", async () => {\n          try {\n            const body = JSON.parse(Buffer.concat(bodyChunks).toString(\"utf-8\"));\n            const request = webhookRequests.find(r => r.id === body.id);\n\n            if (!request) {\n              res.writeHead(404, { \"Content-Type\": \"application/json\" });\n              res.end(JSON.stringify({ success: false, error: \"Request not found\" }));\n              return;\n            }\n\n            const result = await replayWebhook(request, targetPort);\n            console.log(chalk.cyan(`  Replayed: ${request.method} ${request.path} → ${result.status} (${result.duration}ms)`));\n\n            res.writeHead(200, { \"Content-Type\": \"application/json\" });\n            res.end(JSON.stringify({ success: true, ...result }));\n          } catch (err) {\n            res.writeHead(500, { \"Content-Type\": \"application/json\" });\n            res.end(JSON.stringify({ success: false, error: String(err) }));\n          }\n        });\n        return;\n      }\n\n      // Check basic auth if configured\n      if (options.basicAuth) {\n        const authHeader = req.headers.authorization;\n        const expectedAuth = `Basic ${Buffer.from(options.basicAuth).toString(\"base64\")}`;\n\n        if (!authHeader || authHeader !== expectedAuth) {\n          res.writeHead(401, {\n            \"WWW-Authenticate\": 'Basic realm=\"Beam Webhook\"',\n            \"Content-Type\": \"text/plain\",\n          });\n          res.end(\"Unauthorized\");\n          return;\n        }\n      }\n\n      const startTime = Date.now();\n      const logId = `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n\n      // Collect request body\n      const bodyChunks: Buffer[] = [];\n      let bodySize = 0;\n\n      req.on(\"data\", (chunk: Buffer) => {\n        bodySize += chunk.length;\n        if (bodySize <= MAX_BODY_SIZE) {\n          bodyChunks.push(chunk);\n        }\n      });\n\n      req.on(\"end\", () => {\n        const requestBody = bodySize <= MAX_BODY_SIZE\n          ? Buffer.concat(bodyChunks).toString(\"utf-8\")\n          : `[Body too large: ${formatBytes(bodySize)}]`;\n\n        const log: WebhookRequest = {\n          id: logId,\n          timestamp: new Date(),\n          method: req.method || \"GET\",\n          path: req.url || \"/\",\n          headers: req.headers as Record<string, string | string[] | undefined>,\n          body: requestBody || undefined,\n        };\n\n        webhookRequests.unshift(log);\n        if (webhookRequests.length > MAX_REQUESTS) {\n          webhookRequests.pop();\n        }\n\n        // Forward to target\n        const proxyReq = httpRequest(\n          {\n            hostname: \"localhost\",\n            port: targetPort,\n            path: req.url,\n            method: req.method,\n            headers: req.headers,\n          },\n          (proxyRes) => {\n            const responseChunks: Buffer[] = [];\n            let responseSize = 0;\n\n            proxyRes.on(\"data\", (chunk: Buffer) => {\n              responseSize += chunk.length;\n              if (responseSize <= MAX_BODY_SIZE) {\n                responseChunks.push(chunk);\n              }\n              res.write(chunk);\n            });\n\n            proxyRes.on(\"end\", () => {\n              const duration = Date.now() - startTime;\n              const responseBody = responseSize <= MAX_BODY_SIZE\n                ? Buffer.concat(responseChunks).toString(\"utf-8\")\n                : `[Body too large: ${formatBytes(responseSize)}]`;\n\n              log.response = {\n                status: proxyRes.statusCode || 500,\n                headers: proxyRes.headers as Record<string, string | string[] | undefined>,\n                body: responseBody,\n                duration,\n              };\n\n              logRequest(log);\n              res.end();\n            });\n\n            res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n          }\n        );\n\n        proxyReq.on(\"error\", (err) => {\n          log.response = {\n            status: 502,\n            headers: {},\n            body: err.message,\n            duration: Date.now() - startTime,\n          };\n\n          logRequest(log);\n\n          res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n          res.end(`Proxy Error: ${err.message}`);\n        });\n\n        if (bodyChunks.length > 0) {\n          proxyReq.write(Buffer.concat(bodyChunks));\n        }\n        proxyReq.end();\n      });\n    });\n\n    server.on(\"error\", (err: NodeJS.ErrnoException) => {\n      if (err.code === \"EADDRINUSE\") {\n        startWebhookCapture(targetPort, webhookPort + 1, options)\n          .then(resolve)\n          .catch(reject);\n      } else {\n        reject(err);\n      }\n    });\n\n    server.listen(webhookPort, () => {\n      console.log();\n      console.log(chalk.bold(\"  Webhook Capture Mode\"));\n      console.log(chalk.dim(`  UI: `) + chalk.cyan(`http://localhost:${webhookPort}/__beam__`));\n      console.log(chalk.dim(`  Forwarding to: http://localhost:${targetPort}`));\n      console.log();\n      console.log(chalk.dim(\"  All requests are captured and can be replayed.\"));\n      console.log(chalk.dim(\"  Incoming webhooks:\"));\n      console.log();\n\n      resolve({\n        close: () => server.close(),\n        getRequests: () => [...webhookRequests],\n      });\n    });\n  });\n}\n\n/**\n * Get all captured webhook requests\n */\nexport function getWebhookRequests(): WebhookRequest[] {\n  return [...webhookRequests];\n}\n\n/**\n * Clear all captured webhook requests\n */\nexport function clearWebhookRequests(): void {\n  webhookRequests = [];\n}\n","import chalk from \"chalk\";\n\nexport interface ShareOptions {\n  expiresIn?: number; // hours until expiry (default: 24)\n  message?: string;   // optional message to include\n}\n\nexport interface ShareLink {\n  id: string;\n  url: string;\n  tunnelId: string;\n  tunnelUrl: string;\n  createdAt: Date;\n  expiresAt: Date;\n  createdBy: string;\n  sharedWith?: string;\n  message?: string;\n}\n\n/**\n * Generate a shareable link for a tunnel\n * The link will include the tunnel URL and optional metadata\n */\nexport function generateShareUrl(\n  apiUrl: string,\n  shareId: string\n): string {\n  return `${apiUrl}/share/${shareId}`;\n}\n\n/**\n * Format share link info for display\n */\nexport function formatShareInfo(share: ShareLink): void {\n  console.log();\n  console.log(chalk.bold(\"  Share Link Created\"));\n  console.log();\n  console.log(`  ${chalk.dim(\"Share URL:\")}    ${chalk.cyan.underline(share.url)}`);\n  console.log(`  ${chalk.dim(\"Tunnel URL:\")}   ${chalk.dim(share.tunnelUrl)}`);\n  console.log(`  ${chalk.dim(\"Expires:\")}      ${chalk.dim(formatExpiry(share.expiresAt))}`);\n  if (share.sharedWith) {\n    console.log(`  ${chalk.dim(\"Shared with:\")} ${chalk.dim(share.sharedWith)}`);\n  }\n  if (share.message) {\n    console.log(`  ${chalk.dim(\"Message:\")}      ${chalk.dim(`\"${share.message}\"`)}`);\n  }\n  console.log();\n}\n\n/**\n * Format expiry time in a human-readable way\n */\nfunction formatExpiry(date: Date): string {\n  const now = new Date();\n  const diffMs = date.getTime() - now.getTime();\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n  const diffMins = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\n\n  if (diffHours > 24) {\n    const days = Math.floor(diffHours / 24);\n    return `in ${days} day${days > 1 ? 's' : ''}`;\n  } else if (diffHours > 0) {\n    return `in ${diffHours}h ${diffMins}m`;\n  } else if (diffMins > 0) {\n    return `in ${diffMins} minutes`;\n  } else {\n    return \"expired\";\n  }\n}\n\n/**\n * Parse share recipient\n * Supports @username format or email\n */\nexport function parseRecipient(recipient: string): { type: 'username' | 'email'; value: string } {\n  if (recipient.startsWith('@')) {\n    return { type: 'username', value: recipient.slice(1) };\n  }\n  if (recipient.includes('@')) {\n    return { type: 'email', value: recipient };\n  }\n  // Assume it's a username without @\n  return { type: 'username', value: recipient };\n}\n","import { createServer as createHTTPSServer } from \"https\";\nimport { createServer as createHTTPServer, IncomingMessage, ServerResponse } from \"http\";\nimport { request as httpRequest } from \"http\";\nimport { execSync } from \"child_process\";\nimport { existsSync, mkdirSync, readFileSync, writeFileSync } from \"fs\";\nimport { join } from \"path\";\nimport { homedir } from \"os\";\nimport chalk from \"chalk\";\n\nexport interface HTTPSProxyOptions {\n  useMkcert?: boolean; // Use mkcert for trusted local certs (if available)\n}\n\n/**\n * Get the directory for storing Beam certificates\n */\nfunction getCertDir(): string {\n  const certDir = join(homedir(), \".beam\", \"certs\");\n  if (!existsSync(certDir)) {\n    mkdirSync(certDir, { recursive: true });\n  }\n  return certDir;\n}\n\n/**\n * Check if mkcert is installed\n */\nfunction isMkcertInstalled(): boolean {\n  try {\n    execSync(\"mkcert -version\", { stdio: \"pipe\" });\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Generate a self-signed certificate using OpenSSL\n */\nfunction generateSelfSignedCert(): { key: Buffer; cert: Buffer } {\n  const certDir = getCertDir();\n  const keyPath = join(certDir, \"localhost-key.pem\");\n  const certPath = join(certDir, \"localhost-cert.pem\");\n\n  // Check if certificates already exist\n  if (existsSync(keyPath) && existsSync(certPath)) {\n    console.log(chalk.dim(\"  Using existing self-signed certificate\"));\n    return {\n      key: readFileSync(keyPath),\n      cert: readFileSync(certPath),\n    };\n  }\n\n  console.log(chalk.dim(\"  Generating self-signed certificate...\"));\n\n  try {\n    // Generate private key\n    execSync(\n      `openssl genrsa -out \"${keyPath}\" 2048`,\n      { stdio: \"pipe\" }\n    );\n\n    // Generate certificate\n    execSync(\n      `openssl req -new -x509 -key \"${keyPath}\" -out \"${certPath}\" -days 365 -subj \"/CN=localhost\"`,\n      { stdio: \"pipe\" }\n    );\n\n    console.log(chalk.dim(\"  Self-signed certificate created\"));\n    console.log(chalk.yellow(\"  Warning: Browsers will show security warnings for self-signed certificates\"));\n\n    return {\n      key: readFileSync(keyPath),\n      cert: readFileSync(certPath),\n    };\n  } catch (err) {\n    throw new Error(`Failed to generate self-signed certificate: ${err}`);\n  }\n}\n\n/**\n * Generate a trusted certificate using mkcert\n */\nfunction generateMkcertCert(): { key: Buffer; cert: Buffer } {\n  const certDir = getCertDir();\n  const keyPath = join(certDir, \"localhost-key.pem\");\n  const certPath = join(certDir, \"localhost-cert.pem\");\n\n  // Check if certificates already exist\n  if (existsSync(keyPath) && existsSync(certPath)) {\n    console.log(chalk.dim(\"  Using existing mkcert certificate\"));\n    return {\n      key: readFileSync(keyPath),\n      cert: readFileSync(certPath),\n    };\n  }\n\n  console.log(chalk.dim(\"  Generating trusted local certificate with mkcert...\"));\n\n  try {\n    // Generate certificate for localhost\n    execSync(\n      `cd \"${certDir}\" && mkcert -key-file localhost-key.pem -cert-file localhost-cert.pem localhost 127.0.0.1 ::1`,\n      { stdio: \"pipe\" }\n    );\n\n    console.log(chalk.green(\"  Trusted local certificate created\"));\n    console.log(chalk.dim(\"  Browsers will trust this certificate without warnings\"));\n\n    return {\n      key: readFileSync(keyPath),\n      cert: readFileSync(certPath),\n    };\n  } catch (err) {\n    console.log(chalk.yellow(\"  Failed to generate mkcert certificate, falling back to self-signed\"));\n    return generateSelfSignedCert();\n  }\n}\n\n/**\n * Get or generate SSL certificates\n */\nfunction getCertificates(useMkcert: boolean): { key: Buffer; cert: Buffer } {\n  if (useMkcert && isMkcertInstalled()) {\n    return generateMkcertCert();\n  }\n\n  if (useMkcert && !isMkcertInstalled()) {\n    console.log(chalk.yellow(\"  mkcert not found, using self-signed certificate\"));\n    console.log(chalk.dim(\"  Install mkcert for trusted local certificates:\"));\n    console.log(chalk.dim(\"    macOS: brew install mkcert\"));\n    console.log(chalk.dim(\"    Linux: https://github.com/FiloSottile/mkcert#installation\"));\n  }\n\n  return generateSelfSignedCert();\n}\n\n/**\n * Start an HTTPS proxy server\n * Creates a local HTTPS server that proxies requests to the target HTTP port\n */\nexport function startHTTPSProxy(\n  targetPort: number,\n  proxyPort: number,\n  options: HTTPSProxyOptions = {}\n): Promise<{ close: () => void; port: number; isHTTPS: true }> {\n  return new Promise((resolve, reject) => {\n    try {\n      // Get or generate certificates\n      const { key, cert } = getCertificates(options.useMkcert || false);\n\n      // Create HTTPS server\n      const server = createHTTPSServer({ key, cert }, (req: IncomingMessage, res: ServerResponse) => {\n        // Collect request body\n        const bodyChunks: Buffer[] = [];\n\n        req.on(\"data\", (chunk: Buffer) => {\n          bodyChunks.push(chunk);\n        });\n\n        req.on(\"end\", () => {\n          // Forward request to target HTTP server\n          const proxyReq = httpRequest(\n            {\n              hostname: \"localhost\",\n              port: targetPort,\n              path: req.url,\n              method: req.method,\n              headers: req.headers,\n            },\n            (proxyRes) => {\n              // Copy response headers and stream response\n              res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n              proxyRes.pipe(res);\n            }\n          );\n\n          proxyReq.on(\"error\", (err) => {\n            res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n            res.end(`Proxy Error: ${err.message}`);\n          });\n\n          // Forward request body\n          if (bodyChunks.length > 0) {\n            proxyReq.write(Buffer.concat(bodyChunks));\n          }\n          proxyReq.end();\n        });\n      });\n\n      server.on(\"error\", (err: NodeJS.ErrnoException) => {\n        if (err.code === \"EADDRINUSE\") {\n          // Try next port\n          startHTTPSProxy(targetPort, proxyPort + 1, options)\n            .then(resolve)\n            .catch(reject);\n        } else {\n          reject(err);\n        }\n      });\n\n      server.listen(proxyPort, () => {\n        const certType = options.useMkcert && isMkcertInstalled() ? \"trusted\" : \"self-signed\";\n        console.log(chalk.dim(`  HTTPS proxy (${certType}): https://localhost:${proxyPort} → http://localhost:${targetPort}`));\n\n        resolve({\n          close: () => server.close(),\n          port: proxyPort,\n          isHTTPS: true,\n        });\n      });\n    } catch (err) {\n      reject(err);\n    }\n  });\n}\n\n/**\n * Start an HTTPS server with basic auth protection\n */\nexport function startHTTPSProxyWithAuth(\n  targetPort: number,\n  proxyPort: number,\n  credentials: string, // \"user:password\" format\n  options: HTTPSProxyOptions = {}\n): Promise<{ close: () => void; port: number; isHTTPS: true }> {\n  return new Promise((resolve, reject) => {\n    try {\n      const expectedAuth = `Basic ${Buffer.from(credentials).toString(\"base64\")}`;\n      const { key, cert } = getCertificates(options.useMkcert || false);\n\n      const server = createHTTPSServer({ key, cert }, (req: IncomingMessage, res: ServerResponse) => {\n        // Check basic auth\n        const authHeader = req.headers.authorization;\n\n        if (!authHeader || authHeader !== expectedAuth) {\n          res.writeHead(401, {\n            \"WWW-Authenticate\": 'Basic realm=\"Beam Tunnel\"',\n            \"Content-Type\": \"text/plain\",\n          });\n          res.end(\"Unauthorized\");\n          return;\n        }\n\n        // Collect request body\n        const bodyChunks: Buffer[] = [];\n\n        req.on(\"data\", (chunk: Buffer) => {\n          bodyChunks.push(chunk);\n        });\n\n        req.on(\"end\", () => {\n          const proxyReq = httpRequest(\n            {\n              hostname: \"localhost\",\n              port: targetPort,\n              path: req.url,\n              method: req.method,\n              headers: req.headers,\n            },\n            (proxyRes) => {\n              res.writeHead(proxyRes.statusCode || 500, proxyRes.headers);\n              proxyRes.pipe(res);\n            }\n          );\n\n          proxyReq.on(\"error\", (err) => {\n            res.writeHead(502, { \"Content-Type\": \"text/plain\" });\n            res.end(`Proxy Error: ${err.message}`);\n          });\n\n          if (bodyChunks.length > 0) {\n            proxyReq.write(Buffer.concat(bodyChunks));\n          }\n          proxyReq.end();\n        });\n      });\n\n      server.on(\"error\", (err: NodeJS.ErrnoException) => {\n        if (err.code === \"EADDRINUSE\") {\n          startHTTPSProxyWithAuth(targetPort, proxyPort + 1, credentials, options)\n            .then(resolve)\n            .catch(reject);\n        } else {\n          reject(err);\n        }\n      });\n\n      server.listen(proxyPort, () => {\n        const certType = options.useMkcert && isMkcertInstalled() ? \"trusted\" : \"self-signed\";\n        console.log(chalk.dim(`  HTTPS proxy (${certType}, auth): https://localhost:${proxyPort} → http://localhost:${targetPort}`));\n\n        resolve({\n          close: () => server.close(),\n          port: proxyPort,\n          isHTTPS: true,\n        });\n      });\n    } catch (err) {\n      reject(err);\n    }\n  });\n}\n","{\n  \"name\": \"@byronwade/beam\",\n  \"version\": \"1.1.6\",\n  \"description\": \"Expose localhost to the internet in seconds. Zero-config tunneling for Next.js, Vite, Astro, and more.\",\n  \"bin\": {\n    \"beam\": \"dist/index.js\"\n  },\n  \"main\": \"dist/index.js\",\n  \"type\": \"module\",\n  \"exports\": {\n    \".\": {\n      \"import\": \"./dist/index.js\",\n      \"types\": \"./dist/index.d.ts\"\n    },\n    \"./next\": {\n      \"import\": \"./dist/frameworks/nextjs/index.js\",\n      \"types\": \"./dist/frameworks/nextjs/index.d.ts\"\n    },\n    \"./vite\": {\n      \"import\": \"./dist/frameworks/vite/index.js\",\n      \"types\": \"./dist/frameworks/vite/index.d.ts\"\n    },\n    \"./astro\": {\n      \"import\": \"./dist/frameworks/astro/index.js\",\n      \"types\": \"./dist/frameworks/astro/index.d.ts\"\n    },\n    \"./remix\": {\n      \"import\": \"./dist/frameworks/vite/index.js\",\n      \"types\": \"./dist/frameworks/vite/index.d.ts\"\n    }\n  },\n  \"scripts\": {\n    \"build\": \"tsup\",\n    \"dev\": \"tsup --watch\",\n    \"start\": \"node dist/index.js\",\n    \"postinstall\": \"node dist/auto-setup.js || true\",\n    \"test\": \"vitest run\",\n    \"test:watch\": \"vitest\",\n    \"test:coverage\": \"vitest run --coverage\",\n    \"prepublishOnly\": \"npm run build\",\n    \"publish:public\": \"npm publish --access public\"\n  },\n  \"keywords\": [\n    \"cloudflare\",\n    \"tunnel\",\n    \"cloudflared\",\n    \"beam\",\n    \"localhost\",\n    \"expose\",\n    \"ngrok\",\n    \"localtunnel\",\n    \"nextjs\",\n    \"vite\",\n    \"astro\",\n    \"remix\",\n    \"webhook\",\n    \"development\",\n    \"dev-server\"\n  ],\n  \"author\": \"Byron Wade\",\n  \"license\": \"AGPL-3.0\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/byronwade/beam.git\"\n  },\n  \"dependencies\": {\n    \"chalk\": \"^5.3.0\",\n    \"clipboardy\": \"^5.0.1\",\n    \"commander\": \"^12.1.0\",\n    \"conf\": \"^13.0.1\",\n    \"open\": \"^11.0.0\",\n    \"ora\": \"^8.1.1\",\n    \"qrcode-terminal\": \"^0.12.0\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^22.10.1\",\n    \"@types/qrcode-terminal\": \"^0.12.2\",\n    \"tsup\": \"^8.3.5\",\n    \"typescript\": \"^5.7.2\",\n    \"vitest\": \"^2.1.4\"\n  },\n  \"engines\": {\n    \"node\": \">=18\"\n  },\n  \"files\": [\n    \"dist\"\n  ]\n}\n"],"mappings":"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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAkQtB,UAAU,SAAS,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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","names":["chalk","execSync","writeFileSync","config","path","createServer","httpRequest","chalk","createServer","httpRequest","chalk","createServer","httpRequest","chalk","MAX_BODY_SIZE","formatBytes","getStatusColor","chalk","formatDuration","logRequest","path","httpRequest","createServer","bodyChunks","chalk","chalk","httpRequest","existsSync","readFileSync","join","chalk","chalk","execSync","portNum","writeFileSync","formatBytes","path"]}
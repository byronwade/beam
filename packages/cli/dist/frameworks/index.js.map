{"version":3,"sources":["../../src/frameworks/index.ts"],"sourcesContent":["/**\n * Framework Detection and Auto-Integration\n *\n * Detects the user's framework from package.json and provides\n * the appropriate integration method.\n */\n\nimport { readFileSync, existsSync } from \"fs\";\nimport { join } from \"path\";\n\nexport type FrameworkType = \"nextjs\" | \"vite\" | \"remix\" | \"astro\" | \"nuxt\" | \"sveltekit\" | \"unknown\";\n\nexport interface FrameworkInfo {\n  type: FrameworkType;\n  name: string;\n  version?: string;\n  configFile?: string;\n  devCommand: string;\n  defaultPort: number;\n  integrationMethod: \"wrapper\" | \"plugin\" | \"integration\" | \"generic\";\n}\n\ninterface PackageJson {\n  name?: string;\n  dependencies?: Record<string, string>;\n  devDependencies?: Record<string, string>;\n  scripts?: Record<string, string>;\n}\n\n/**\n * Detect the framework used in a project\n */\nexport function detectFramework(projectPath: string = process.cwd()): FrameworkInfo {\n  const packageJsonPath = join(projectPath, \"package.json\");\n\n  if (!existsSync(packageJsonPath)) {\n    return {\n      type: \"unknown\",\n      name: \"Unknown\",\n      devCommand: \"npm run dev\",\n      defaultPort: 3000,\n      integrationMethod: \"generic\",\n    };\n  }\n\n  try {\n    const packageJson: PackageJson = JSON.parse(readFileSync(packageJsonPath, \"utf-8\"));\n    const allDeps = {\n      ...packageJson.dependencies,\n      ...packageJson.devDependencies,\n    };\n\n    // Next.js detection\n    if (allDeps[\"next\"]) {\n      const nextConfigFiles = [\"next.config.js\", \"next.config.mjs\", \"next.config.ts\"];\n      const configFile = nextConfigFiles.find(f => existsSync(join(projectPath, f)));\n\n      return {\n        type: \"nextjs\",\n        name: \"Next.js\",\n        version: allDeps[\"next\"],\n        configFile,\n        devCommand: \"next dev\",\n        defaultPort: 3000,\n        integrationMethod: \"wrapper\",\n      };\n    }\n\n    // Remix detection (uses Vite)\n    if (allDeps[\"@remix-run/react\"] || allDeps[\"@remix-run/node\"]) {\n      const configFile = existsSync(join(projectPath, \"vite.config.ts\"))\n        ? \"vite.config.ts\"\n        : existsSync(join(projectPath, \"vite.config.js\"))\n          ? \"vite.config.js\"\n          : undefined;\n\n      return {\n        type: \"remix\",\n        name: \"Remix\",\n        version: allDeps[\"@remix-run/react\"] || allDeps[\"@remix-run/node\"],\n        configFile,\n        devCommand: \"remix vite:dev\",\n        defaultPort: 5173,\n        integrationMethod: \"plugin\",\n      };\n    }\n\n    // Astro detection\n    if (allDeps[\"astro\"]) {\n      const configFile = existsSync(join(projectPath, \"astro.config.mjs\"))\n        ? \"astro.config.mjs\"\n        : existsSync(join(projectPath, \"astro.config.ts\"))\n          ? \"astro.config.ts\"\n          : undefined;\n\n      return {\n        type: \"astro\",\n        name: \"Astro\",\n        version: allDeps[\"astro\"],\n        configFile,\n        devCommand: \"astro dev\",\n        defaultPort: 4321,\n        integrationMethod: \"integration\",\n      };\n    }\n\n    // Nuxt detection\n    if (allDeps[\"nuxt\"]) {\n      const configFile = existsSync(join(projectPath, \"nuxt.config.ts\"))\n        ? \"nuxt.config.ts\"\n        : existsSync(join(projectPath, \"nuxt.config.js\"))\n          ? \"nuxt.config.js\"\n          : undefined;\n\n      return {\n        type: \"nuxt\",\n        name: \"Nuxt\",\n        version: allDeps[\"nuxt\"],\n        configFile,\n        devCommand: \"nuxt dev\",\n        defaultPort: 3000,\n        integrationMethod: \"plugin\",\n      };\n    }\n\n    // SvelteKit detection\n    if (allDeps[\"@sveltejs/kit\"]) {\n      const configFile = existsSync(join(projectPath, \"vite.config.ts\"))\n        ? \"vite.config.ts\"\n        : existsSync(join(projectPath, \"vite.config.js\"))\n          ? \"vite.config.js\"\n          : undefined;\n\n      return {\n        type: \"sveltekit\",\n        name: \"SvelteKit\",\n        version: allDeps[\"@sveltejs/kit\"],\n        configFile,\n        devCommand: \"vite dev\",\n        defaultPort: 5173,\n        integrationMethod: \"plugin\",\n      };\n    }\n\n    // Generic Vite detection (check last as many frameworks use Vite)\n    if (allDeps[\"vite\"]) {\n      const configFile = existsSync(join(projectPath, \"vite.config.ts\"))\n        ? \"vite.config.ts\"\n        : existsSync(join(projectPath, \"vite.config.js\"))\n          ? \"vite.config.js\"\n          : undefined;\n\n      return {\n        type: \"vite\",\n        name: \"Vite\",\n        version: allDeps[\"vite\"],\n        configFile,\n        devCommand: \"vite\",\n        defaultPort: 5173,\n        integrationMethod: \"plugin\",\n      };\n    }\n\n    // Unknown framework\n    return {\n      type: \"unknown\",\n      name: \"Unknown\",\n      devCommand: \"npm run dev\",\n      defaultPort: 3000,\n      integrationMethod: \"generic\",\n    };\n  } catch {\n    return {\n      type: \"unknown\",\n      name: \"Unknown\",\n      devCommand: \"npm run dev\",\n      defaultPort: 3000,\n      integrationMethod: \"generic\",\n    };\n  }\n}\n\n/**\n * Get setup instructions for a framework\n */\nexport function getSetupInstructions(framework: FrameworkInfo): string {\n  switch (framework.type) {\n    case \"nextjs\":\n      return `\nAdd Beam to your next.config.js:\n\n  const withBeam = require('@byronwade/beam/next');\n  module.exports = withBeam({\n    // your existing config\n  });\n\nOr with ES modules (next.config.mjs):\n\n  import withBeam from '@byronwade/beam/next';\n  export default withBeam({\n    // your existing config\n  });\n`;\n\n    case \"vite\":\n    case \"remix\":\n    case \"sveltekit\":\n      return `\nAdd Beam to your vite.config.ts:\n\n  import beam from '@byronwade/beam/vite';\n\n  export default {\n    plugins: [beam()],\n  };\n`;\n\n    case \"astro\":\n      return `\nAdd Beam to your astro.config.mjs:\n\n  import beam from '@byronwade/beam/astro';\n\n  export default {\n    integrations: [beam()],\n  };\n`;\n\n    case \"nuxt\":\n      return `\nAdd Beam to your nuxt.config.ts:\n\n  export default defineNuxtConfig({\n    modules: ['@byronwade/beam/nuxt'],\n  });\n`;\n\n    default:\n      return `\nFor generic projects, Beam will auto-detect ports.\nJust run your dev server and Beam will tunnel it.\n\nOr use the CLI directly:\n  beam 3000\n`;\n  }\n}\n"],"mappings":"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","names":[]}
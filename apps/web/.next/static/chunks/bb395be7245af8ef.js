(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63178,e=>{"use strict";var t=e.i(71645),s=(e,t,s,r,n,i,o,a)=>{let l=document.documentElement,u=["light","dark"];function c(t){var s;(Array.isArray(e)?e:[e]).forEach(e=>{let s="class"===e,r=s&&i?n.map(e=>i[e]||e):n;s?(l.classList.remove(...r),l.classList.add(i&&i[t]?i[t]:t)):l.setAttribute(e,t)}),s=t,a&&u.includes(s)&&(l.style.colorScheme=s)}if(r)c(r);else try{let e=localStorage.getItem(t)||s,r=o&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(r)}catch(e){}},r=["light","dark"],n="(prefers-color-scheme: dark)",i="undefined"==typeof window,o=t.createContext(void 0),a={setTheme:e=>{},themes:[]},l=()=>{var e;return null!=(e=t.useContext(o))?e:a},u=e=>t.useContext(o)?t.createElement(t.Fragment,null,e.children):t.createElement(d,{...e}),c=["light","dark"],d=({forcedTheme:e,disableTransitionOnChange:s=!1,enableSystem:i=!0,enableColorScheme:a=!0,storageKey:l="theme",themes:u=c,defaultTheme:d=i?"system":"light",attribute:p="data-theme",value:y,children:v,nonce:b,scriptProps:w})=>{let[k,S]=t.useState(()=>f(l,d)),[x,T]=t.useState(()=>"system"===k?m():k),C=y?Object.values(y):u,R=t.useCallback(e=>{let t=e;if(!t)return;"system"===e&&i&&(t=m());let n=y?y[t]:t,o=s?g(b):null,l=document.documentElement,u=e=>{"class"===e?(l.classList.remove(...C),n&&l.classList.add(n)):e.startsWith("data-")&&(n?l.setAttribute(e,n):l.removeAttribute(e))};if(Array.isArray(p)?p.forEach(u):u(p),a){let e=r.includes(d)?d:null,s=r.includes(t)?t:e;l.style.colorScheme=s}null==o||o()},[b]),A=t.useCallback(e=>{let t="function"==typeof e?e(k):e;S(t);try{localStorage.setItem(l,t)}catch(e){}},[k]),E=t.useCallback(t=>{T(m(t)),"system"===k&&i&&!e&&R("system")},[k,e]);t.useEffect(()=>{let e=window.matchMedia(n);return e.addListener(E),E(e),()=>e.removeListener(E)},[E]),t.useEffect(()=>{let e=e=>{e.key===l&&(e.newValue?S(e.newValue):A(d))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[A]),t.useEffect(()=>{R(null!=e?e:k)},[e,k]);let M=t.useMemo(()=>({theme:k,setTheme:A,forcedTheme:e,resolvedTheme:"system"===k?x:k,themes:i?[...u,"system"]:u,systemTheme:i?x:void 0}),[k,A,e,x,i,u]);return t.createElement(o.Provider,{value:M},t.createElement(h,{forcedTheme:e,storageKey:l,attribute:p,enableSystem:i,enableColorScheme:a,defaultTheme:d,value:y,themes:u,nonce:b,scriptProps:w}),v)},h=t.memo(({forcedTheme:e,storageKey:r,attribute:n,enableSystem:i,enableColorScheme:o,defaultTheme:a,value:l,themes:u,nonce:c,scriptProps:d})=>{let h=JSON.stringify([n,r,a,e,u,l,i,o]).slice(1,-1);return t.createElement("script",{...d,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?c:"",dangerouslySetInnerHTML:{__html:`(${s.toString()})(${h})`}})}),f=(e,t)=>{let s;if(!i){try{s=localStorage.getItem(e)||void 0}catch(e){}return s||t}},g=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},m=e=>(e||(e=window.matchMedia(n)),e.matches?"dark":"light");e.s(["ThemeProvider",()=>u,"useTheme",()=>l])},88990,e=>{"use strict";let t;e.i(47167);for(var s,r,n=e.i(43476),i=e.i(71645),o=[],a=[],l=Uint8Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,d=u.length;c<d;++c)o[c]=u[c],a[u.charCodeAt(c)]=c;function h(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");-1===s&&(s=t);var r=s===t?0:4-s%4;return[s,r]}function f(e){var t=h(e),s=t[0],r=t[1];return(s+r)*3/4-r}function g(e){var t,s,r=h(e),n=r[0],i=r[1],o=new l((n+i)*3/4-i),u=0,c=i>0?n-4:n;for(s=0;s<c;s+=4)t=a[e.charCodeAt(s)]<<18|a[e.charCodeAt(s+1)]<<12|a[e.charCodeAt(s+2)]<<6|a[e.charCodeAt(s+3)],o[u++]=t>>16&255,o[u++]=t>>8&255,o[u++]=255&t;return 2===i&&(t=a[e.charCodeAt(s)]<<2|a[e.charCodeAt(s+1)]>>4,o[u++]=255&t),1===i&&(t=a[e.charCodeAt(s)]<<10|a[e.charCodeAt(s+1)]<<4|a[e.charCodeAt(s+2)]>>2,o[u++]=t>>8&255,o[u++]=255&t),o}function m(e){for(var t,s=e.length,r=s%3,n=[],i=0,a=s-r;i<a;i+=16383)n.push(function(e,t,s){for(var r,n=[],i=t;i<s;i+=3)r=(e[i]<<16&0xff0000)+(e[i+1]<<8&65280)+(255&e[i+2]),n.push(o[r>>18&63]+o[r>>12&63]+o[r>>6&63]+o[63&r]);return n.join("")}(e,i,i+16383>a?a:i+16383));return 1===r?n.push(o[(t=e[s-1])>>2]+o[t<<4&63]+"=="):2===r&&n.push(o[(t=(e[s-2]<<8)+e[s-1])>>10]+o[t>>4&63]+o[t<<2&63]+"="),n.join("")}function p(e){return m(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function y(e){if(void 0===e)return{};if(!v(e))throw Error(`The arguments to a Convex function must be an object. Received: ${e}`);return e}function v(e){let t="object"==typeof e,s=Object.getPrototypeOf(e),r=null===s||s===Object.prototype||s?.constructor?.name==="Object";return t&&r}a[45]=62,a[95]=63,e.s(["byteLength",()=>f,"fromByteArray",()=>m,"fromByteArrayUrlSafeNoPadding",()=>p,"toByteArray",()=>g],95543);let b=BigInt("-9223372036854775808"),w=BigInt("9223372036854775807"),k=BigInt("0"),S=BigInt("8"),x=BigInt("256");function T(e){return Number.isNaN(e)||!Number.isFinite(e)||Object.is(e,-0)}let C=DataView.prototype.setBigInt64?function(e){if(e<b||w<e)throw Error(`BigInt ${e} does not fit into a 64-bit signed integer.`);let t=new ArrayBuffer(8);return new DataView(t).setBigInt64(0,e,!0),m(new Uint8Array(t))}:function(e){e<k&&(e-=b+b);let t=e.toString(16);t.length%2==1&&(t="0"+t);let s=new Uint8Array(new ArrayBuffer(8)),r=0;for(let n of t.match(/.{2}/g).reverse())s.set([parseInt(n,16)],r++),e>>=S;return m(s)},R=DataView.prototype.getBigInt64?function(e){let t=g(e);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);return new DataView(t.buffer).getBigInt64(0,!0)}:function(e){let t=g(e);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $integer`);let s=k,r=k;for(let e of t)s+=BigInt(e)*x**r,r++;return s>w&&(s+=b+b),s};function A(e){if(e.length>1024)throw Error(`Field name ${e} exceeds maximum field name length 1024.`);if(e.startsWith("$"))throw Error(`Field name ${e} starts with a '$', which is reserved.`);for(let t=0;t<e.length;t+=1){let s=e.charCodeAt(t);if(s<32||s>=127)throw Error(`Field name ${e} has invalid character '${e[t]}': Field names can only contain non-control ASCII characters`)}}function E(e){if(null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>E(e));if("object"!=typeof e)throw Error(`Unexpected type of ${e}`);let t=Object.entries(e);if(1===t.length){let s=t[0][0];if("$bytes"===s){if("string"!=typeof e.$bytes)throw Error(`Malformed $bytes field on ${e}`);return g(e.$bytes).buffer}if("$integer"===s){if("string"!=typeof e.$integer)throw Error(`Malformed $integer field on ${e}`);return R(e.$integer)}if("$float"===s){if("string"!=typeof e.$float)throw Error(`Malformed $float field on ${e}`);let t=g(e.$float);if(8!==t.byteLength)throw Error(`Received ${t.byteLength} bytes, expected 8 for $float`);let s=new DataView(t.buffer).getFloat64(0,!0);if(!T(s))throw Error(`Float ${s} should be encoded as a number`);return s}if("$set"===s)throw Error("Received a Set which is no longer supported as a Convex type.");if("$map"===s)throw Error("Received a Map which is no longer supported as a Convex type.")}let s={};for(let[t,r]of Object.entries(e))A(t),s[t]=E(r);return s}function M(e){let t=JSON.stringify(e,(e,t)=>void 0===t?"undefined":"bigint"==typeof t?`${t.toString()}n`:t);if(t.length>16384){let e="[...truncated]",s=16384-e.length,r=t.codePointAt(s-1);return void 0!==r&&r>65535&&(s-=1),t.substring(0,s)+e}return t}function q(e,t,s,r){return e?`${t}${M(s)} is not a supported Convex type (present at path ${e} in original object ${M(r)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`:`${t}${M(s)} is not a supported Convex type.`}function I(e){return function e(t,s,r,n){if(void 0===t){let e=r&&` (present at path ${r} in original object ${M(s)})`;throw Error(`undefined is not a valid Convex value${e}. To learn about Convex's supported types, see https://docs.convex.dev/using/types.`)}if(null===t)return t;if("bigint"==typeof t){if(t<b||w<t)throw Error(`BigInt ${t} does not fit into a 64-bit signed integer.`);return{$integer:C(t)}}if("number"==typeof t)if(!T(t))return t;else{let e=new ArrayBuffer(8);return new DataView(e).setFloat64(0,t,!0),{$float:m(new Uint8Array(e))}}if("boolean"==typeof t||"string"==typeof t)return t;if(t instanceof ArrayBuffer)return{$bytes:m(new Uint8Array(t))};if(Array.isArray(t))return t.map((t,n)=>e(t,s,r+`[${n}]`,!1));if(t instanceof Set)throw Error(q(r,"Set",[...t],s));if(t instanceof Map)throw Error(q(r,"Map",[...t],s));if(!v(t)){let e=t?.constructor?.name;throw Error(q(r,e?`${e} `:"",t,s))}let i={},o=Object.entries(t);for(let[t,a]of(o.sort(([e,t],[s,r])=>e===s?0:e<s?-1:1),o))void 0!==a?(A(t),i[t]=e(a,s,r+`.${t}`,!1)):n&&(A(t),i[t]=function(t,s,r){if(void 0===t)return{$undefined:null};if(void 0===s)throw Error(`Programming error. Current value is ${M(t)} but original value is undefined`);return e(t,s,r,!1)}(a,s,r+`.${t}`));return i}(e,e,"",!1)}var $=e.i(95543),P=Object.defineProperty,Q=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?P(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};let O=Symbol.for("ConvexError");class L extends(r=Error,s=O,r){constructor(e){super("string"==typeof e?e:M(e)),Q(this,"name","ConvexError"),Q(this,"data"),Q(this,s,!0),this.data=e}}let V=()=>Array.from({length:4},()=>0);V(),V();let N="1.30.0";var B=Object.defineProperty,_=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?B(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};function j(e){switch(e){case"query":return"Q";case"mutation":return"M";case"action":return"A";case"any":return"?"}}class D{constructor(e){_(this,"_onLogLineFuncs"),_(this,"_verbose"),this._onLogLineFuncs={},this._verbose=e.verbose}addLogLineListener(e){let t=Math.random().toString(36).substring(2,15);for(let e=0;e<10&&void 0!==this._onLogLineFuncs[t];e++)t=Math.random().toString(36).substring(2,15);return this._onLogLineFuncs[t]=e,()=>{delete this._onLogLineFuncs[t]}}logVerbose(...e){if(this._verbose)for(let t of Object.values(this._onLogLineFuncs))t("debug",`${new Date().toISOString()}`,...e)}log(...e){for(let t of Object.values(this._onLogLineFuncs))t("info",...e)}warn(...e){for(let t of Object.values(this._onLogLineFuncs))t("warn",...e)}error(...e){for(let t of Object.values(this._onLogLineFuncs))t("error",...e)}}function F(e){let t=new D(e);return t.addLogLineListener((e,...t)=>{switch(e){case"debug":console.debug(...t);break;case"info":default:console.log(...t);break;case"warn":console.warn(...t);break;case"error":console.error(...t)}}),t}function U(e,t,s,r,n){let i=j(s);if("object"==typeof n&&(n=`ConvexError ${JSON.stringify(n.errorData,null,2)}`),"info"===t){let t=n.match(/^\[.*?\] /);if(null===t)return void e.error(`[CONVEX ${i}(${r})] Could not parse console.log`);let s=n.slice(1,t[0].length-2),o=n.slice(t[0].length);e.log(`%c[CONVEX ${i}(${r})] [${s}]`,"color:rgb(0, 145, 255)",o)}else e.error(`[CONVEX ${i}(${r})] ${n}`)}function z(e,t,s){let r=j(e);return`[CONVEX ${r}(${t})] ${s.errorMessage}
  Called by client`}function W(e,t){return t.data=e.errorData,t}function K(e){let t,s,r=e.split(":");return 1===r.length?(t=r[0],s="default"):(t=r.slice(0,r.length-1).join(":"),s=r[r.length-1]),t.endsWith(".js")&&(t=t.slice(0,-3)),`${t}:${s}`}function H(e,t){return JSON.stringify({udfPath:K(e),args:I(t)})}function Y(e,t,s){let{initialNumItems:r,id:n}=s;return JSON.stringify({type:"paginated",udfPath:K(e),args:I(t),options:I({initialNumItems:r,id:n})})}var J=Object.defineProperty,X=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?J(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class G{constructor(){X(this,"nextQueryId"),X(this,"querySetVersion"),X(this,"querySet"),X(this,"queryIdToToken"),X(this,"identityVersion"),X(this,"auth"),X(this,"outstandingQueriesOlderThanRestart"),X(this,"outstandingAuthOlderThanRestart"),X(this,"paused"),X(this,"pendingQuerySetModifications"),this.nextQueryId=0,this.querySetVersion=0,this.identityVersion=0,this.querySet=new Map,this.queryIdToToken=new Map,this.outstandingQueriesOlderThanRestart=new Set,this.outstandingAuthOlderThanRestart=!1,this.paused=!1,this.pendingQuerySetModifications=new Map}hasSyncedPastLastReconnect(){return 0===this.outstandingQueriesOlderThanRestart.size&&!this.outstandingAuthOlderThanRestart}markAuthCompletion(){this.outstandingAuthOlderThanRestart=!1}subscribe(e,t,s,r){let n=K(e),i=H(n,t),o=this.querySet.get(i);if(void 0!==o)return o.numSubscribers+=1,{queryToken:i,modification:null,unsubscribe:()=>this.removeSubscriber(i)};{let e=this.nextQueryId++;this.querySet.set(i,{id:e,canonicalizedUdfPath:n,args:t,numSubscribers:1,journal:s,componentPath:r}),this.queryIdToToken.set(e,i);let o=this.querySetVersion,a=this.querySetVersion+1,l={type:"Add",queryId:e,udfPath:n,args:[I(t)],journal:s,componentPath:r};return this.paused?this.pendingQuerySetModifications.set(e,l):this.querySetVersion=a,{queryToken:i,modification:{type:"ModifyQuerySet",baseVersion:o,newVersion:a,modifications:[l]},unsubscribe:()=>this.removeSubscriber(i)}}}transition(e){for(let t of e.modifications)switch(t.type){case"QueryUpdated":case"QueryFailed":{this.outstandingQueriesOlderThanRestart.delete(t.queryId);let e=t.journal;if(void 0!==e){let s=this.queryIdToToken.get(t.queryId);void 0!==s&&(this.querySet.get(s).journal=e)}break}case"QueryRemoved":this.outstandingQueriesOlderThanRestart.delete(t.queryId);break;default:throw Error(`Invalid modification ${t.type}`)}}queryId(e,t){let s=H(K(e),t),r=this.querySet.get(s);return void 0!==r?r.id:null}isCurrentOrNewerAuthVersion(e){return e>=this.identityVersion}getAuth(){return this.auth}setAuth(e){this.auth={tokenType:"User",value:e};let t=this.identityVersion;return this.paused||(this.identityVersion=t+1),{type:"Authenticate",baseVersion:t,...this.auth}}setAdminAuth(e,t){let s={tokenType:"Admin",value:e,impersonating:t};this.auth=s;let r=this.identityVersion;return this.paused||(this.identityVersion=r+1),{type:"Authenticate",baseVersion:r,...s}}clearAuth(){this.auth=void 0,this.markAuthCompletion();let e=this.identityVersion;return this.paused||(this.identityVersion=e+1),{type:"Authenticate",tokenType:"None",baseVersion:e}}hasAuth(){return!!this.auth}isNewAuth(e){return this.auth?.value!==e}queryPath(e){let t=this.queryIdToToken.get(e);return t?this.querySet.get(t).canonicalizedUdfPath:null}queryArgs(e){let t=this.queryIdToToken.get(e);return t?this.querySet.get(t).args:null}queryToken(e){return this.queryIdToToken.get(e)??null}queryJournal(e){return this.querySet.get(e)?.journal}restart(e){this.unpause(),this.outstandingQueriesOlderThanRestart.clear();let t=[];for(let s of this.querySet.values()){let r={type:"Add",queryId:s.id,udfPath:s.canonicalizedUdfPath,args:[I(s.args)],journal:s.journal,componentPath:s.componentPath};t.push(r),e.has(s.id)||this.outstandingQueriesOlderThanRestart.add(s.id)}this.querySetVersion=1;let s={type:"ModifyQuerySet",baseVersion:0,newVersion:1,modifications:t};if(!this.auth)return this.identityVersion=0,[s,void 0];this.outstandingAuthOlderThanRestart=!0;let r={type:"Authenticate",baseVersion:0,...this.auth};return this.identityVersion=1,[s,r]}pause(){this.paused=!0}resume(){let e=this.pendingQuerySetModifications.size>0?{type:"ModifyQuerySet",baseVersion:this.querySetVersion,newVersion:++this.querySetVersion,modifications:Array.from(this.pendingQuerySetModifications.values())}:void 0,t=void 0!==this.auth?{type:"Authenticate",baseVersion:this.identityVersion++,...this.auth}:void 0;return this.unpause(),[e,t]}unpause(){this.paused=!1,this.pendingQuerySetModifications.clear()}removeSubscriber(e){let t=this.querySet.get(e);if(t.numSubscribers>1)return t.numSubscribers-=1,null;{this.querySet.delete(e),this.queryIdToToken.delete(t.id),this.outstandingQueriesOlderThanRestart.delete(t.id);let s=this.querySetVersion,r=this.querySetVersion+1,n={type:"Remove",queryId:t.id};return this.paused?this.pendingQuerySetModifications.has(t.id)?this.pendingQuerySetModifications.delete(t.id):this.pendingQuerySetModifications.set(t.id,n):this.querySetVersion=r,{type:"ModifyQuerySet",baseVersion:s,newVersion:r,modifications:[n]}}}}var Z=Object.defineProperty,ee=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?Z(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class et{constructor(e,t){this.logger=e,this.markConnectionStateDirty=t,ee(this,"inflightRequests"),ee(this,"requestsOlderThanRestart"),ee(this,"inflightMutationsCount",0),ee(this,"inflightActionsCount",0),this.inflightRequests=new Map,this.requestsOlderThanRestart=new Set}request(e,t){let s=new Promise(s=>{this.inflightRequests.set(e.requestId,{message:e,status:{status:t?"Requested":"NotSent",requestedAt:new Date,onResult:s}}),"Mutation"===e.type?this.inflightMutationsCount++:"Action"===e.type&&this.inflightActionsCount++});return this.markConnectionStateDirty(),s}onResponse(e){let t,s,r=this.inflightRequests.get(e.requestId);if(void 0===r||"Completed"===r.status.status)return null;let n="Mutation"===r.message.type?"mutation":"action",i=r.message.udfPath;for(let t of e.logLines)U(this.logger,"info",n,i,t);let o=r.status;if(e.success)t={success:!0,logLines:e.logLines,value:E(e.result)},s=()=>o.onResult(t);else{let r=e.result,{errorData:a}=e;U(this.logger,"error",n,i,r),t={success:!1,errorMessage:r,errorData:void 0!==a?E(a):void 0,logLines:e.logLines},s=()=>o.onResult(t)}return"ActionResponse"!==e.type&&e.success?(r.status={status:"Completed",result:t,ts:e.ts,onResolve:s},null):(s(),this.inflightRequests.delete(e.requestId),this.requestsOlderThanRestart.delete(e.requestId),"Action"===r.message.type?this.inflightActionsCount--:"Mutation"===r.message.type&&this.inflightMutationsCount--,this.markConnectionStateDirty(),{requestId:e.requestId,result:t})}removeCompleted(e){let t=new Map;for(let[s,r]of this.inflightRequests.entries()){let n=r.status;"Completed"===n.status&&n.ts.lessThanOrEqual(e)&&(n.onResolve(),t.set(s,n.result),"Mutation"===r.message.type?this.inflightMutationsCount--:"Action"===r.message.type&&this.inflightActionsCount--,this.inflightRequests.delete(s),this.requestsOlderThanRestart.delete(s))}return t.size>0&&this.markConnectionStateDirty(),t}restart(){this.requestsOlderThanRestart=new Set(this.inflightRequests.keys());let e=[];for(let[t,s]of this.inflightRequests){if("NotSent"===s.status.status){s.status.status="Requested",e.push(s.message);continue}if("Mutation"===s.message.type)e.push(s.message);else if("Action"===s.message.type){if(this.inflightRequests.delete(t),this.requestsOlderThanRestart.delete(t),this.inflightActionsCount--,"Completed"===s.status.status)throw Error("Action should never be in 'Completed' state");s.status.onResult({success:!1,errorMessage:"Connection lost while action was in flight",logLines:[]})}}return this.markConnectionStateDirty(),e}resume(){let e=[];for(let[,t]of this.inflightRequests)if("NotSent"===t.status.status){t.status.status="Requested",e.push(t.message);continue}return e}hasIncompleteRequests(){for(let e of this.inflightRequests.values())if("Requested"===e.status.status)return!0;return!1}hasInflightRequests(){return this.inflightRequests.size>0}hasSyncedPastLastReconnect(){return 0===this.requestsOlderThanRestart.size}timeOfOldestInflightRequest(){if(0===this.inflightRequests.size)return null;let e=Date.now();for(let t of this.inflightRequests.values())"Completed"!==t.status.status&&t.status.requestedAt.getTime()<e&&(e=t.status.requestedAt.getTime());return new Date(e)}inflightMutations(){return this.inflightMutationsCount}inflightActions(){return this.inflightActionsCount}}let es=Symbol.for("functionName"),er=Symbol.for("toReferencePath");function en(e){let t=function(e){let t;if("string"==typeof e)t=e.startsWith("function://")?{functionHandle:e}:{name:e};else if(e[es])t={name:e[es]};else{let s=e[er]??null;if(!s)throw Error(`${e} is not a functionReference`);t={reference:s}}return t}(e);if(void 0===t.name){if(void 0!==t.functionHandle)throw Error(`Expected function reference like "api.file.func" or "internal.file.func", but received function handle ${t.functionHandle}`);if(void 0!==t.reference)throw Error(`Expected function reference in the current component like "api.file.func" or "internal.file.func", but received reference ${t.reference}`);throw Error(`Expected function reference like "api.file.func" or "internal.file.func", but received ${JSON.stringify(t)}`)}if("string"==typeof e)return e;let s=e[es];if(!s)throw Error(`${e} is not a functionReference`);return s}!function e(t=[]){return new Proxy({},{get(s,r){if("string"==typeof r)return e([...t,r]);if(r===es){if(t.length<2){let e=["api",...t].join(".");throw Error(`API path is expected to be of the form \`api.moduleName.functionName\`. Found: \`${e}\``)}let e=t.slice(0,-1).join("/"),s=t[t.length-1];return"default"===s?e:e+":"+s}return r===Symbol.toStringTag?"FunctionReference":void 0}})}();var ei=Object.defineProperty,eo=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?ei(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class ea{constructor(e){eo(this,"queryResults"),eo(this,"modifiedQueries"),this.queryResults=e,this.modifiedQueries=[]}getQuery(e,...t){let s=y(t[0]),r=en(e),n=this.queryResults.get(H(r,s));if(void 0!==n)return ea.queryValue(n.result)}getAllQueries(e){let t=[],s=en(e);for(let e of this.queryResults.values())e.udfPath===K(s)&&t.push({args:e.args,value:ea.queryValue(e.result)});return t}setQuery(e,t,s){let r=y(t),n=en(e),i=H(n,r);this.queryResults.set(i,{udfPath:n,args:r,result:void 0===s?void 0:{success:!0,value:s,logLines:[]}}),this.modifiedQueries.push(i)}static queryValue(e){return void 0===e?void 0:e.success?e.value:void 0}}class el{constructor(){eo(this,"queryResults"),eo(this,"optimisticUpdates"),this.queryResults=new Map,this.optimisticUpdates=[]}ingestQueryResultsFromServer(e,t){this.optimisticUpdates=this.optimisticUpdates.filter(e=>!t.has(e.mutationId));let s=this.queryResults;this.queryResults=new Map(e);let r=new ea(this.queryResults);for(let e of this.optimisticUpdates)e.update(r);let n=[];for(let[e,t]of this.queryResults){let r=s.get(e);(void 0===r||r.result!==t.result)&&n.push(e)}return n}applyOptimisticUpdate(e,t){this.optimisticUpdates.push({update:e,mutationId:t});let s=new ea(this.queryResults);return e(s),s.modifiedQueries}rawQueryResult(e){let t=this.queryResults.get(e);if(void 0!==t)return t.result}queryResult(e){let t=this.queryResults.get(e);if(void 0===t)return;let s=t.result;if(void 0!==s){if(s.success)return s.value;if(void 0!==s.errorData)throw W(s,new L(z("query",t.udfPath,s)));throw Error(z("query",t.udfPath,s))}}hasQueryResult(e){return void 0!==this.queryResults.get(e)}queryLogs(e){let t=this.queryResults.get(e);return t?.result?.logLines}}var eu=Object.defineProperty,ec=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?eu(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class ed{constructor(e,t){ec(this,"low"),ec(this,"high"),ec(this,"__isUnsignedLong__"),this.low=0|e,this.high=0|t,this.__isUnsignedLong__=!0}static isLong(e){return!0===(e&&e.__isUnsignedLong__)}static fromBytesLE(e){return new ed(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24)}toBytesLE(){let e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}static fromNumber(e){return isNaN(e)||e<0?eh:e>=eg?em:new ed(e%ef|0,e/ef|0)}toString(){return(BigInt(this.high)*BigInt(ef)+BigInt(this.low)).toString()}equals(e){return ed.isLong(e)||(e=ed.fromValue(e)),(this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low}notEquals(e){return!this.equals(e)}comp(e){return(ed.isLong(e)||(e=ed.fromValue(e)),this.equals(e))?0:e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1}lessThanOrEqual(e){return 0>=this.comp(e)}static fromValue(e){return"number"==typeof e?ed.fromNumber(e):new ed(e.low,e.high)}}let eh=new ed(0,0),ef=0x100000000,eg=0xffffffffffffffff,em=new ed(-1,-1);var ep=Object.defineProperty,ey=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?ep(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class ev{constructor(e,t){ey(this,"version"),ey(this,"remoteQuerySet"),ey(this,"queryPath"),ey(this,"logger"),this.version={querySet:0,ts:ed.fromNumber(0),identity:0},this.remoteQuerySet=new Map,this.queryPath=e,this.logger=t}transition(e){let t=e.startVersion;if(this.version.querySet!==t.querySet||this.version.ts.notEquals(t.ts)||this.version.identity!==t.identity)throw Error(`Invalid start version: ${t.ts.toString()}:${t.querySet}:${t.identity}, transitioning from ${this.version.ts.toString()}:${this.version.querySet}:${this.version.identity}`);for(let t of e.modifications)switch(t.type){case"QueryUpdated":{let e=this.queryPath(t.queryId);if(e)for(let s of t.logLines)U(this.logger,"info","query",e,s);let s=E(t.value??null);this.remoteQuerySet.set(t.queryId,{success:!0,value:s,logLines:t.logLines});break}case"QueryFailed":{let e=this.queryPath(t.queryId);if(e)for(let s of t.logLines)U(this.logger,"info","query",e,s);let{errorData:s}=t;this.remoteQuerySet.set(t.queryId,{success:!1,errorMessage:t.errorMessage,errorData:void 0!==s?E(s):void 0,logLines:t.logLines});break}case"QueryRemoved":this.remoteQuerySet.delete(t.queryId);break;default:throw Error(`Invalid modification ${t.type}`)}this.version=e.endVersion}remoteQueryResults(){return this.remoteQuerySet}timestamp(){return this.version.ts}}function eb(e){let t=$.toByteArray(e);return ed.fromBytesLE(Array.from(t))}function ew(e){switch(e.type){case"FatalError":case"AuthError":case"ActionResponse":case"TransitionChunk":case"Ping":return{...e};case"MutationResponse":if(e.success)return{...e,ts:eb(e.ts)};return{...e};case"Transition":return{...e,startVersion:{...e.startVersion,ts:eb(e.startVersion.ts)},endVersion:{...e.endVersion,ts:eb(e.endVersion.ts)}}}}var ek=Object.defineProperty,eS=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?ek(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};function ex(){return(void 0===t&&(t=Date.now()),"undefined"!=typeof performance&&performance.now)?Math.round(t+performance.now()):Date.now()}function eT(){return`t=${Math.round((ex()-t)/100)/10}s`}let eC={InternalServerError:{timeout:1e3},SubscriptionsWorkerFullError:{timeout:3e3},TooManyConcurrentRequests:{timeout:3e3},CommitterFullError:{timeout:3e3},AwsTooManyRequestsException:{timeout:3e3},ExecuteFullError:{timeout:3e3},SystemTimeoutError:{timeout:3e3},ExpiredInQueue:{timeout:3e3},VectorIndexesUnavailable:{timeout:1e3},SearchIndexesUnavailable:{timeout:1e3},TableSummariesUnavailable:{timeout:1e3},VectorIndexTooLarge:{timeout:3e3},SearchIndexTooLarge:{timeout:3e3},TooManyWritesInTimePeriod:{timeout:3e3}};class eR{constructor(e,t,s,r,n,i){this.markConnectionStateDirty=n,this.debug=i,eS(this,"socket"),eS(this,"connectionCount"),eS(this,"_hasEverConnected",!1),eS(this,"lastCloseReason"),eS(this,"transitionChunkBuffer",null),eS(this,"defaultInitialBackoff"),eS(this,"maxBackoff"),eS(this,"retries"),eS(this,"serverInactivityThreshold"),eS(this,"reconnectDueToServerInactivityTimeout"),eS(this,"uri"),eS(this,"onOpen"),eS(this,"onResume"),eS(this,"onMessage"),eS(this,"webSocketConstructor"),eS(this,"logger"),eS(this,"onServerDisconnectError"),this.webSocketConstructor=s,this.socket={state:"disconnected"},this.connectionCount=0,this.lastCloseReason="InitialConnect",this.defaultInitialBackoff=1e3,this.maxBackoff=16e3,this.retries=0,this.serverInactivityThreshold=6e4,this.reconnectDueToServerInactivityTimeout=null,this.uri=e,this.onOpen=t.onOpen,this.onResume=t.onResume,this.onMessage=t.onMessage,this.onServerDisconnectError=t.onServerDisconnectError,this.logger=r,this.connect()}setSocketState(e){this.socket=e,this._logVerbose(`socket state changed: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}`),this.markConnectionStateDirty()}assembleTransition(e){if(e.partNumber<0||e.partNumber>=e.totalParts||0===e.totalParts||this.transitionChunkBuffer&&(this.transitionChunkBuffer.totalParts!==e.totalParts||this.transitionChunkBuffer.transitionId!==e.transitionId))throw this.transitionChunkBuffer=null,Error("Invalid TransitionChunk");if(null===this.transitionChunkBuffer&&(this.transitionChunkBuffer={chunks:[],totalParts:e.totalParts,transitionId:e.transitionId}),e.partNumber!==this.transitionChunkBuffer.chunks.length){let t=this.transitionChunkBuffer.chunks.length;throw this.transitionChunkBuffer=null,Error(`TransitionChunk received out of order: expected part ${t}, got ${e.partNumber}`)}if(this.transitionChunkBuffer.chunks.push(e.chunk),this.transitionChunkBuffer.chunks.length===e.totalParts){let e=this.transitionChunkBuffer.chunks.join("");this.transitionChunkBuffer=null;let t=ew(JSON.parse(e));if("Transition"!==t.type)throw Error(`Expected Transition, got ${t.type} after assembling chunks`);return t}return null}connect(){if("terminated"===this.socket.state)return;if("disconnected"!==this.socket.state&&"stopped"!==this.socket.state)throw Error("Didn't start connection from disconnected state: "+this.socket.state);let e=new this.webSocketConstructor(this.uri);this._logVerbose("constructed WebSocket"),this.setSocketState({state:"connecting",ws:e,paused:"no"}),this.resetServerInactivityTimeout(),e.onopen=()=>{if(this.logger.logVerbose("begin ws.onopen"),"connecting"!==this.socket.state)throw Error("onopen called with socket not in connecting state");this.setSocketState({state:"ready",ws:e,paused:"yes"===this.socket.paused?"uninitialized":"no"}),this.resetServerInactivityTimeout(),"no"===this.socket.paused&&(this._hasEverConnected=!0,this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason,clientTs:ex()})),"InitialConnect"!==this.lastCloseReason&&(this.lastCloseReason?this.logger.log("WebSocket reconnected at",eT(),"after disconnect due to",this.lastCloseReason):this.logger.log("WebSocket reconnected at",eT())),this.connectionCount+=1,this.lastCloseReason=null},e.onerror=e=>{this.transitionChunkBuffer=null;let t=e.message;t&&this.logger.log(`WebSocket error message: ${t}`)},e.onmessage=e=>{this.resetServerInactivityTimeout();let t=e.data.length,s=ew(JSON.parse(e.data));if(this._logVerbose(`received ws message with type ${s.type}`),"Ping"!==s.type){if("TransitionChunk"===s.type){let e=this.assembleTransition(s);if(!e)return;s=e,this._logVerbose(`assembled full ws message of type ${s.type}`)}null!==this.transitionChunkBuffer&&(this.transitionChunkBuffer=null,this.logger.log(`Received unexpected ${s.type} while buffering TransitionChunks`)),"Transition"===s.type&&this.reportLargeTransition({messageLength:t,transition:s}),this.onMessage(s).hasSyncedPastLastReconnect&&(this.retries=0,this.markConnectionStateDirty())}},e.onclose=e=>{if(this._logVerbose("begin ws.onclose"),this.transitionChunkBuffer=null,null===this.lastCloseReason&&(this.lastCloseReason=e.reason||`closed with code ${e.code}`),1e3!==e.code&&1001!==e.code&&1005!==e.code&&4040!==e.code){let t=`WebSocket closed with code ${e.code}`;e.reason&&(t+=`: ${e.reason}`),this.logger.log(t),this.onServerDisconnectError&&e.reason&&this.onServerDisconnectError(t)}let t=function(e){if(void 0===e)return"Unknown";for(let t of Object.keys(eC))if(e.startsWith(t))return t;return"Unknown"}(e.reason);this.scheduleReconnect(t)}}socketState(){return this.socket.state}sendMessage(e){let t={type:e.type,..."Authenticate"===e.type&&"User"===e.tokenType?{value:`...${e.value.slice(-7)}`}:{}};if("ready"===this.socket.state&&"no"===this.socket.paused){let s=JSON.stringify(function(e){switch(e.type){case"Authenticate":case"ModifyQuerySet":case"Mutation":case"Action":case"Event":return{...e};case"Connect":let t;if(void 0===e.maxObservedTimestamp)return{...e,maxObservedTimestamp:void 0};return{...e,maxObservedTimestamp:(t=new Uint8Array(e.maxObservedTimestamp.toBytesLE()),$.fromByteArray(t))}}}(e)),r=!1;try{this.socket.ws.send(s),r=!0}catch(e){this.logger.log(`Failed to send message on WebSocket, reconnecting: ${e}`),this.closeAndReconnect("FailedToSendMessage")}return this._logVerbose(`${r?"sent":"failed to send"} message with type ${e.type}: ${JSON.stringify(t)}`),!0}return this._logVerbose(`message not sent (socket state: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}): ${JSON.stringify(t)}`),!1}resetServerInactivityTimeout(){"terminated"!==this.socket.state&&(null!==this.reconnectDueToServerInactivityTimeout&&(clearTimeout(this.reconnectDueToServerInactivityTimeout),this.reconnectDueToServerInactivityTimeout=null),this.reconnectDueToServerInactivityTimeout=setTimeout(()=>{this.closeAndReconnect("InactiveServer")},this.serverInactivityThreshold))}scheduleReconnect(e){this.socket={state:"disconnected"};let t=this.nextBackoff(e);this.markConnectionStateDirty(),this.logger.log(`Attempting reconnect in ${Math.round(t)}ms`),setTimeout(()=>this.connect(),t)}closeAndReconnect(e){switch(this._logVerbose(`begin closeAndReconnect with reason ${e}`),this.socket.state){case"disconnected":case"terminated":case"stopped":return;case"connecting":case"ready":this.lastCloseReason=e,this.close(),this.scheduleReconnect("client");return;default:this.socket}}close(){switch(this.transitionChunkBuffer=null,this.socket.state){case"disconnected":case"terminated":case"stopped":return Promise.resolve();case"connecting":{let e=this.socket.ws;return e.onmessage=e=>{this._logVerbose("Ignoring message received after close")},new Promise(t=>{e.onclose=()=>{this._logVerbose("Closed after connecting"),t()},e.onopen=()=>{this._logVerbose("Opened after connecting"),e.close()}})}case"ready":{this._logVerbose("ws.close called");let e=this.socket.ws;e.onmessage=e=>{this._logVerbose("Ignoring message received after close")};let t=new Promise(t=>{e.onclose=()=>{t()}});return e.close(),t}default:return this.socket,Promise.resolve()}}terminate(){switch(this.reconnectDueToServerInactivityTimeout&&clearTimeout(this.reconnectDueToServerInactivityTimeout),this.socket.state){case"terminated":case"stopped":case"disconnected":case"connecting":case"ready":{let e=this.close();return this.setSocketState({state:"terminated"}),e}default:throw this.socket,Error(`Invalid websocket state: ${this.socket.state}`)}}stop(){switch(this.socket.state){case"terminated":return Promise.resolve();case"connecting":case"stopped":case"disconnected":case"ready":{let e=this.close();return this.socket={state:"stopped"},e}default:return this.socket,Promise.resolve()}}tryRestart(){switch(this.socket.state){case"stopped":break;case"terminated":case"connecting":case"ready":case"disconnected":this.logger.logVerbose("Restart called without stopping first");return;default:this.socket}this.connect()}pause(){switch(this.socket.state){case"disconnected":case"stopped":case"terminated":return;case"connecting":case"ready":this.socket={...this.socket,paused:"yes"};return;default:return void this.socket}}resume(){switch(this.socket.state){case"connecting":this.socket={...this.socket,paused:"no"};return;case"ready":"uninitialized"===this.socket.paused?(this.socket={...this.socket,paused:"no"},this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason,clientTs:ex()})):"yes"===this.socket.paused&&(this.socket={...this.socket,paused:"no"},this.onResume());return;case"terminated":case"stopped":case"disconnected":return;default:this.socket}this.connect()}connectionState(){return{isConnected:"ready"===this.socket.state,hasEverConnected:this._hasEverConnected,connectionCount:this.connectionCount,connectionRetries:this.retries}}_logVerbose(e){this.logger.logVerbose(e)}nextBackoff(e){let t=("client"===e?100:"Unknown"===e?this.defaultInitialBackoff:eC[e].timeout)*Math.pow(2,this.retries);this.retries+=1;let s=Math.min(t,this.maxBackoff),r=s*(Math.random()-.5);return s+r}reportLargeTransition({transition:e,messageLength:t}){if(void 0===e.clientClockSkew||void 0===e.serverTs)return;let s=ex()-e.clientClockSkew-e.serverTs/1e6,r=`${Math.round(s)}ms`,n=`${Math.round(t/1e4)/100}MB`,i=t/(s/1e3),o=`${Math.round(i/1e4)/100}MB per second`;this._logVerbose(`received ${n} transition in ${r} at ${o}`),t>2e7?this.logger.log(`received query results totaling more that 20MB (${n}) which will take a long time to download on slower connections`):s>2e4&&this.logger.log(`received query results totaling ${n} which took more than 20s to arrive (${r})`),this.debug&&this.sendMessage({type:"Event",eventType:"ClientReceivedTransition",event:{transitionTransitTime:s,messageLength:t}})}}class eA extends Error{}function eE(e,t){let s;if("string"!=typeof e)throw new eA("Invalid token specified: must be a string");t||(t={});let r=+(!0!==t.header),n=e.split(".")[r];if("string"!=typeof n)throw new eA(`Invalid token specified: missing part #${r+1}`);try{s=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var s;return s=t,decodeURIComponent(atob(s).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}catch{return atob(t)}}(n)}catch(e){throw new eA(`Invalid token specified: invalid base64 for part #${r+1} (${e.message})`)}try{return JSON.parse(s)}catch(e){throw new eA(`Invalid token specified: invalid json for part #${r+1} (${e.message})`)}}eA.prototype.name="InvalidTokenError";var eM=Object.defineProperty,eq=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?eM(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class eI{constructor(e,t,s){eq(this,"authState",{state:"noAuth"}),eq(this,"configVersion",0),eq(this,"syncState"),eq(this,"authenticate"),eq(this,"stopSocket"),eq(this,"tryRestartSocket"),eq(this,"pauseSocket"),eq(this,"resumeSocket"),eq(this,"clearAuth"),eq(this,"logger"),eq(this,"refreshTokenLeewaySeconds"),eq(this,"tokenConfirmationAttempts",0),this.syncState=e,this.authenticate=t.authenticate,this.stopSocket=t.stopSocket,this.tryRestartSocket=t.tryRestartSocket,this.pauseSocket=t.pauseSocket,this.resumeSocket=t.resumeSocket,this.clearAuth=t.clearAuth,this.logger=s.logger,this.refreshTokenLeewaySeconds=s.refreshTokenLeewaySeconds}async setConfig(e,t){this.resetAuthState(),this._logVerbose("pausing WS for auth token fetch"),this.pauseSocket();let s=await this.fetchTokenAndGuardAgainstRace(e,{forceRefreshToken:!1});s.isFromOutdatedConfig||(s.value?(this.setAuthState({state:"waitingForServerConfirmationOfCachedToken",config:{fetchToken:e,onAuthChange:t},hasRetried:!1}),this.authenticate(s.value)):(this.setAuthState({state:"initialRefetch",config:{fetchToken:e,onAuthChange:t}}),await this.refetchToken()),this._logVerbose("resuming WS after auth token fetch"),this.resumeSocket())}onTransition(e){if(this.syncState.isCurrentOrNewerAuthVersion(e.endVersion.identity)&&!(e.endVersion.identity<=e.startVersion.identity)){if("waitingForServerConfirmationOfCachedToken"===this.authState.state){this._logVerbose("server confirmed auth token is valid"),this.refetchToken(),this.authState.config.onAuthChange(!0);return}"waitingForServerConfirmationOfFreshToken"===this.authState.state&&(this._logVerbose("server confirmed new auth token is valid"),this.scheduleTokenRefetch(this.authState.token),this.tokenConfirmationAttempts=0,this.authState.hadAuth||this.authState.config.onAuthChange(!0))}}onAuthError(e){if(!1===e.authUpdateAttempted&&("waitingForServerConfirmationOfFreshToken"===this.authState.state||"waitingForServerConfirmationOfCachedToken"===this.authState.state))return void this._logVerbose("ignoring non-auth token expired error");let{baseVersion:t}=e;this.syncState.isCurrentOrNewerAuthVersion(t+1)?this.tryToReauthenticate(e):this._logVerbose("ignoring auth error for previous auth attempt")}async tryToReauthenticate(e){if(this._logVerbose(`attempting to reauthenticate: ${e.error}`),"noAuth"===this.authState.state||"waitingForServerConfirmationOfFreshToken"===this.authState.state&&this.tokenConfirmationAttempts>=2){this.logger.error(`Failed to authenticate: "${e.error}", check your server auth config`),this.syncState.hasAuth()&&this.syncState.clearAuth(),"noAuth"!==this.authState.state&&this.setAndReportAuthFailed(this.authState.config.onAuthChange);return}"waitingForServerConfirmationOfFreshToken"===this.authState.state&&(this.tokenConfirmationAttempts++,this._logVerbose(`retrying reauthentication, ${2-this.tokenConfirmationAttempts} attempts remaining`)),await this.stopSocket();let t=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});t.isFromOutdatedConfig||(t.value&&this.syncState.isNewAuth(t.value)?(this.authenticate(t.value),this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",config:this.authState.config,token:t.value,hadAuth:"notRefetching"===this.authState.state||"waitingForScheduledRefetch"===this.authState.state})):(this._logVerbose("reauthentication failed, could not fetch a new token"),this.syncState.hasAuth()&&this.syncState.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this.tryRestartSocket())}async refetchToken(){if("noAuth"===this.authState.state)return;this._logVerbose("refetching auth token");let e=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});e.isFromOutdatedConfig||(e.value?this.syncState.isNewAuth(e.value)?(this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",hadAuth:this.syncState.hasAuth(),token:e.value,config:this.authState.config}),this.authenticate(e.value)):this.setAuthState({state:"notRefetching",config:this.authState.config}):(this._logVerbose("refetching token failed"),this.syncState.hasAuth()&&this.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this._logVerbose("restarting WS after auth token fetch (if currently stopped)"),this.tryRestartSocket())}scheduleTokenRefetch(e){if("noAuth"===this.authState.state)return;let t=this.decodeToken(e);if(!t)return void this.logger.error("Auth token is not a valid JWT, cannot refetch the token");let{iat:s,exp:r}=t;if(!s||!r)return void this.logger.error("Auth token does not have required fields, cannot refetch the token");let n=r-s;if(n<=2)return void this.logger.error("Auth token does not live long enough, cannot refetch the token");let i=Math.min(1728e6,(n-this.refreshTokenLeewaySeconds)*1e3);i<=0&&(this.logger.warn(`Refetching auth token immediately, configured leeway ${this.refreshTokenLeewaySeconds}s is larger than the token's lifetime ${n}s`),i=0);let o=setTimeout(()=>{this._logVerbose("running scheduled token refetch"),this.refetchToken()},i);this.setAuthState({state:"waitingForScheduledRefetch",refetchTokenTimeoutId:o,config:this.authState.config}),this._logVerbose(`scheduled preemptive auth token refetching in ${i}ms`)}async fetchTokenAndGuardAgainstRace(e,t){let s=++this.configVersion;this._logVerbose(`fetching token with config version ${s}`);let r=await e(t);return this.configVersion!==s?(this._logVerbose(`stale config version, expected ${s}, got ${this.configVersion}`),{isFromOutdatedConfig:!0}):{isFromOutdatedConfig:!1,value:r}}stop(){this.resetAuthState(),this.configVersion++,this._logVerbose(`config version bumped to ${this.configVersion}`)}setAndReportAuthFailed(e){e(!1),this.resetAuthState()}resetAuthState(){this.setAuthState({state:"noAuth"})}setAuthState(e){let t="waitingForServerConfirmationOfFreshToken"===e.state?{hadAuth:e.hadAuth,state:e.state,token:`...${e.token.slice(-7)}`}:{state:e.state};switch(this._logVerbose(`setting auth state to ${JSON.stringify(t)}`),e.state){case"waitingForScheduledRefetch":case"notRefetching":case"noAuth":this.tokenConfirmationAttempts=0}"waitingForScheduledRefetch"===this.authState.state&&(clearTimeout(this.authState.refetchTokenTimeoutId),this.syncState.markAuthCompletion()),this.authState=e}decodeToken(e){try{return eE(e)}catch(e){return this._logVerbose(`Error decoding token: ${e instanceof Error?e.message:"Unknown error"}`),null}}_logVerbose(e){this.logger.logVerbose(`${e} [v${this.configVersion}]`)}}let e$=["convexClientConstructed","convexWebSocketOpen","convexFirstMessageReceived"];function eP(e){let t=e.name.slice(6);return{name:t=t.charAt(0).toLowerCase()+t.slice(1),startTime:e.startTime}}var eQ=Object.defineProperty,eO=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?eQ(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class eL{constructor(e,t,s){let r;if(eO(this,"address"),eO(this,"state"),eO(this,"requestManager"),eO(this,"webSocketManager"),eO(this,"authenticationManager"),eO(this,"remoteQuerySet"),eO(this,"optimisticQueryResults"),eO(this,"_transitionHandlerCounter",0),eO(this,"_nextRequestId"),eO(this,"_onTransitionFns",new Map),eO(this,"_sessionId"),eO(this,"firstMessageReceived",!1),eO(this,"debug"),eO(this,"logger"),eO(this,"maxObservedTimestamp"),eO(this,"connectionStateSubscribers",new Map),eO(this,"nextConnectionStateSubscriberId",0),eO(this,"_lastPublishedConnectionState"),eO(this,"markConnectionStateDirty",()=>{Promise.resolve().then(()=>{let e=this.connectionState();if(JSON.stringify(e)!==JSON.stringify(this._lastPublishedConnectionState))for(let t of(this._lastPublishedConnectionState=e,this.connectionStateSubscribers.values()))t(e)})}),eO(this,"mark",e=>{var t;this.debug&&(t=this.sessionId,"undefined"!=typeof performance&&performance.mark&&performance.mark(e,{detail:{sessionId:t}}))}),"object"==typeof e)throw Error("Passing a ClientConfig object is no longer supported. Pass the URL of the Convex deployment as a string directly.");s?.skipConvexDeploymentUrlCheck!==!0&&function(e){if(void 0===e)throw Error("Client created with undefined deployment address. If you used an environment variable, check that it's set.");if("string"!=typeof e)throw Error(`Invalid deployment address: found ${e}".`);if(!(e.startsWith("http:")||e.startsWith("https:")))throw Error(`Invalid deployment address: Must start with "https://" or "http://". Found "${e}".`);try{new URL(e)}catch{throw Error(`Invalid deployment address: "${e}" is not a valid URL. If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}if(e.endsWith(".convex.site"))throw Error(`Invalid deployment address: "${e}" ends with .convex.site, which is used for HTTP Actions. Convex deployment URLs typically end with .convex.cloud? If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}(e);const n=(s={...s}).authRefreshTokenLeewaySeconds??2;let i=s.webSocketConstructor;if(!i&&"undefined"==typeof WebSocket)throw Error("No WebSocket global variable defined! To use Convex in an environment without WebSocket try the HTTP client: https://docs.convex.dev/api/classes/browser.ConvexHttpClient");i=i||WebSocket,this.debug=s.reportDebugInfoToConvex??!1,this.address=e,this.logger=!1===s.logger?new D({verbose:s.verbose??!1}):!0!==s.logger&&s.logger?s.logger:F({verbose:s.verbose??!1});const o=e.search("://");if(-1===o)throw Error("Provided address was not an absolute URL.");const a=e.substring(o+3),l=e.substring(0,o);if("http"===l)r="ws";else if("https"===l)r="wss";else throw Error(`Unknown parent protocol ${l}`);const u=`${r}://${a}/api/${N}/sync`;this.state=new G,this.remoteQuerySet=new ev(e=>this.state.queryPath(e),this.logger),this.requestManager=new et(this.logger,this.markConnectionStateDirty);const c=()=>{this.webSocketManager.pause(),this.state.pause()};this.authenticationManager=new eI(this.state,{authenticate:e=>{let t=this.state.setAuth(e);return this.webSocketManager.sendMessage(t),t.baseVersion},stopSocket:()=>this.webSocketManager.stop(),tryRestartSocket:()=>this.webSocketManager.tryRestart(),pauseSocket:c,resumeSocket:()=>this.webSocketManager.resume(),clearAuth:()=>{this.clearAuth()}},{logger:this.logger,refreshTokenLeewaySeconds:n}),this.optimisticQueryResults=new el,this.addOnTransitionHandler(e=>{t(e.queries.map(e=>e.token))}),this._nextRequestId=0,this._sessionId="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});const{unsavedChangesWarning:d}=s;if("undefined"==typeof window||void 0===window.addEventListener){if(!0===d)throw Error("unsavedChangesWarning requested, but window.addEventListener not found! Remove {unsavedChangesWarning: true} from Convex client options.")}else!1!==d&&window.addEventListener("beforeunload",e=>{if(this.requestManager.hasIncompleteRequests()){e.preventDefault();let t="Are you sure you want to leave? Your changes may not be saved.";return(e||window.event).returnValue=t,t}});this.webSocketManager=new eR(u,{onOpen:e=>{this.mark("convexWebSocketOpen"),this.webSocketManager.sendMessage({...e,type:"Connect",sessionId:this._sessionId,maxObservedTimestamp:this.maxObservedTimestamp});let t=new Set(this.remoteQuerySet.remoteQueryResults().keys());this.remoteQuerySet=new ev(e=>this.state.queryPath(e),this.logger);let[s,r]=this.state.restart(t);for(let e of(r&&this.webSocketManager.sendMessage(r),this.webSocketManager.sendMessage(s),this.requestManager.restart()))this.webSocketManager.sendMessage(e)},onResume:()=>{let[e,t]=this.state.resume();for(let s of(t&&this.webSocketManager.sendMessage(t),e&&this.webSocketManager.sendMessage(e),this.requestManager.resume()))this.webSocketManager.sendMessage(s)},onMessage:e=>{switch(!this.firstMessageReceived&&(this.firstMessageReceived=!0,this.mark("convexFirstMessageReceived"),this.reportMarks()),e.type){case"Transition":{this.observedTimestamp(e.endVersion.ts),this.authenticationManager.onTransition(e),this.remoteQuerySet.transition(e),this.state.transition(e);let t=this.requestManager.removeCompleted(this.remoteQuerySet.timestamp());this.notifyOnQueryResultChanges(t);break}case"MutationResponse":{e.success&&this.observedTimestamp(e.ts);let t=this.requestManager.onResponse(e);null!==t&&this.notifyOnQueryResultChanges(new Map([[t.requestId,t.result]]));break}case"ActionResponse":this.requestManager.onResponse(e);break;case"AuthError":this.authenticationManager.onAuthError(e);break;case"FatalError":{var t,s;let r,n=(t=this.logger,s=e.error,r=`[CONVEX FATAL ERROR] ${s}`,t.error(r),Error(r));throw this.webSocketManager.terminate(),n}}return{hasSyncedPastLastReconnect:this.hasSyncedPastLastReconnect()}},onServerDisconnectError:s.onServerDisconnectError},i,this.logger,this.markConnectionStateDirty,this.debug),this.mark("convexClientConstructed"),s.expectAuth&&c()}hasSyncedPastLastReconnect(){return this.requestManager.hasSyncedPastLastReconnect()||this.state.hasSyncedPastLastReconnect()}observedTimestamp(e){(void 0===this.maxObservedTimestamp||this.maxObservedTimestamp.lessThanOrEqual(e))&&(this.maxObservedTimestamp=e)}getMaxObservedTimestamp(){return this.maxObservedTimestamp}notifyOnQueryResultChanges(e){let t=this.remoteQuerySet.remoteQueryResults(),s=new Map;for(let[e,r]of t){let t=this.state.queryToken(e);if(null!==t){let n={result:r,udfPath:this.state.queryPath(e),args:this.state.queryArgs(e)};s.set(t,n)}}let r=this.optimisticQueryResults.ingestQueryResultsFromServer(s,new Set(e.keys()));this.handleTransition({queries:r.map(e=>{let t=this.optimisticQueryResults.rawQueryResult(e);return{token:e,modification:{kind:"Updated",result:t}}}),reflectedMutations:Array.from(e).map(([e,t])=>({requestId:e,result:t})),timestamp:this.remoteQuerySet.timestamp()})}handleTransition(e){for(let t of this._onTransitionFns.values())t(e)}addOnTransitionHandler(e){let t=this._transitionHandlerCounter++;return this._onTransitionFns.set(t,e),()=>this._onTransitionFns.delete(t)}getCurrentAuthClaims(){let e=this.state.getAuth(),t={};if(e&&"User"===e.tokenType){try{t=e?eE(e.value):{}}catch{t={}}return{token:e.value,decoded:t}}}setAuth(e,t){this.authenticationManager.setConfig(e,t)}hasAuth(){return this.state.hasAuth()}setAdminAuth(e,t){let s=this.state.setAdminAuth(e,t);this.webSocketManager.sendMessage(s)}clearAuth(){let e=this.state.clearAuth();this.webSocketManager.sendMessage(e)}subscribe(e,t,s){let r=y(t),{modification:n,queryToken:i,unsubscribe:o}=this.state.subscribe(e,r,s?.journal,s?.componentPath);return null!==n&&this.webSocketManager.sendMessage(n),{queryToken:i,unsubscribe:()=>{let e=o();e&&this.webSocketManager.sendMessage(e)}}}localQueryResult(e,t){let s=H(e,y(t));return this.optimisticQueryResults.queryResult(s)}localQueryResultByToken(e){return this.optimisticQueryResults.queryResult(e)}hasLocalQueryResultByToken(e){return this.optimisticQueryResults.hasQueryResult(e)}localQueryLogs(e,t){let s=H(e,y(t));return this.optimisticQueryResults.queryLogs(s)}queryJournal(e,t){let s=H(e,y(t));return this.state.queryJournal(s)}connectionState(){let e=this.webSocketManager.connectionState();return{hasInflightRequests:this.requestManager.hasInflightRequests(),isWebSocketConnected:e.isConnected,hasEverConnected:e.hasEverConnected,connectionCount:e.connectionCount,connectionRetries:e.connectionRetries,timeOfOldestInflightRequest:this.requestManager.timeOfOldestInflightRequest(),inflightMutations:this.requestManager.inflightMutations(),inflightActions:this.requestManager.inflightActions()}}subscribeToConnectionState(e){let t=this.nextConnectionStateSubscriberId++;return this.connectionStateSubscribers.set(t,e),()=>{this.connectionStateSubscribers.delete(t)}}async mutation(e,t,s){let r=await this.mutationInternal(e,t,s);if(!r.success){if(void 0!==r.errorData)throw W(r,new L(z("mutation",e,r)));throw Error(z("mutation",e,r))}return r.value}async mutationInternal(e,t,s,r){let{mutationPromise:n}=this.enqueueMutation(e,t,s,r);return n}enqueueMutation(e,t,s,r){let n=y(t);this.tryReportLongDisconnect();let i=this.nextRequestId;if(this._nextRequestId++,void 0!==s){let e=s.optimisticUpdate;if(void 0!==e){let t=t=>{e(t,n)instanceof Promise&&this.logger.warn("Optimistic update handler returned a Promise. Optimistic updates should be synchronous.")},s=this.optimisticQueryResults.applyOptimisticUpdate(t,i).map(e=>{let t=this.localQueryResultByToken(e);return{token:e,modification:{kind:"Updated",result:void 0===t?void 0:{success:!0,value:t,logLines:[]}}}});this.handleTransition({queries:s,reflectedMutations:[],timestamp:this.remoteQuerySet.timestamp()})}}let o={type:"Mutation",requestId:i,udfPath:e,componentPath:r,args:[I(n)]},a=this.webSocketManager.sendMessage(o);return{requestId:i,mutationPromise:this.requestManager.request(o,a)}}async action(e,t){let s=await this.actionInternal(e,t);if(!s.success){if(void 0!==s.errorData)throw W(s,new L(z("action",e,s)));throw Error(z("action",e,s))}return s.value}async actionInternal(e,t,s){let r=y(t),n=this.nextRequestId;this._nextRequestId++,this.tryReportLongDisconnect();let i={type:"Action",requestId:n,udfPath:e,componentPath:s,args:[I(r)]},o=this.webSocketManager.sendMessage(i);return this.requestManager.request(i,o)}async close(){return this.authenticationManager.stop(),this.webSocketManager.terminate()}get url(){return this.address}get nextRequestId(){return this._nextRequestId}get sessionId(){return this._sessionId}reportMarks(){if(this.debug){let e=function(e){if("undefined"==typeof performance||!performance.getEntriesByName)return[];let t=[];for(let s of e$){let r=performance.getEntriesByName(s).filter(e=>"mark"===e.entryType).filter(t=>t.detail.sessionId===e);t.push(...r)}return t.map(eP)}(this.sessionId);this.webSocketManager.sendMessage({type:"Event",eventType:"ClientConnect",event:e})}}tryReportLongDisconnect(){if(!this.debug)return;let e=this.connectionState().timeOfOldestInflightRequest;null===e||Date.now()-e.getTime()<=6e4||fetch(`${this.address}/api/debug_event`,{method:"POST",headers:{"Content-Type":"application/json","Convex-Client":`npm-${N}`},body:JSON.stringify({event:"LongWebsocketDisconnect"})}).then(e=>{e.ok||this.logger.warn("Analytics request failed with response:",e.body)}).catch(e=>{this.logger.warn("Analytics response failed with error:",e)})}}function eV(e){if("object"!=typeof e||null===e||!Array.isArray(e.page)||"boolean"!=typeof e.isDone||"string"!=typeof e.continueCursor)throw Error(`Not a valid paginated query result: ${e?.toString()}`);return e}var eN=Object.defineProperty,eB=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?eN(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};class e_{constructor(e,t){this.client=e,this.onTransition=t,eB(this,"paginatedQuerySet",new Map),eB(this,"lastTransitionTs"),this.lastTransitionTs=ed.fromNumber(0),this.client.addOnTransitionHandler(e=>this.onBaseTransition(e))}subscribe(e,t,s){let r=K(e),n=Y(r,t,s),i=()=>this.removePaginatedQuerySubscriber(n),o=this.paginatedQuerySet.get(n);return o?o.numSubscribers+=1:(this.paginatedQuerySet.set(n,{token:n,canonicalizedUdfPath:r,args:t,numSubscribers:1,options:{initialNumItems:s.initialNumItems},nextPageKey:0,pageKeys:[],pageKeyToQuery:new Map,ongoingSplits:new Map,skip:!1,id:s.id}),this.addPageToPaginatedQuery(n,null,s.initialNumItems)),{paginatedQueryToken:n,unsubscribe:i}}localQueryResult(e,t,s){let r=Y(K(e),t,s);return this.localQueryResultByToken(r)}localQueryResultByToken(e){let t,s=this.paginatedQuerySet.get(e);if(!s)return;let r=this.activePageQueryTokens(s);if(0===r.length)return{results:[],status:"LoadingFirstPage",loadMore:t=>this.loadMoreOfPaginatedQuery(e,t)};let n=[],i=!1,o=!1;for(let e of r){let t=this.client.localQueryResultByToken(e);if(void 0===t){i=!0,o=!1;continue}let s=eV(t);n=n.concat(s.page),o=!!s.isDone}return t=i?0===n.length?"LoadingFirstPage":"LoadingMore":o?"Exhausted":"CanLoadMore",{results:n,status:t,loadMore:t=>this.loadMoreOfPaginatedQuery(e,t)}}onBaseTransition(e){let t=e.queries.map(e=>e.token),s=this.queriesContainingTokens(t),r=[];s.length>0&&(this.processPaginatedQuerySplits(s,e=>this.client.localQueryResultByToken(e)),r=s.map(e=>({token:e,modification:{kind:"Updated",result:this.localQueryResultByToken(e)}})));let n={...e,paginatedQueries:r};this.onTransition(n)}loadMoreOfPaginatedQuery(e,t){this.mustGetPaginatedQuery(e);let s=this.queryTokenForLastPageOfPaginatedQuery(e),r=this.client.localQueryResultByToken(s);if(!r)return!1;let n=eV(r);if(n.isDone)return!1;this.addPageToPaginatedQuery(e,n.continueCursor,t);let i={timestamp:this.lastTransitionTs,reflectedMutations:[],queries:[],paginatedQueries:[{token:e,modification:{kind:"Updated",result:this.localQueryResultByToken(e)}}]};return this.onTransition(i),!0}queriesContainingTokens(e){if(0===e.length)return[];let t=[],s=new Set(e);for(let[e,r]of this.paginatedQuerySet)for(let n of this.allQueryTokens(r))if(s.has(n)){t.push(e);break}return t}processPaginatedQuerySplits(e,t){for(let s of e){let e=this.mustGetPaginatedQuery(s),{ongoingSplits:r,pageKeyToQuery:n,pageKeys:i}=e;for(let[s,[i,o]]of r)void 0!==t(n.get(i).queryToken)&&void 0!==t(n.get(o).queryToken)&&this.completePaginatedQuerySplit(e,s,i,o);for(let s of i){if(r.has(s))continue;let i=t(n.get(s).queryToken);if(!i)continue;let o=eV(i);o.splitCursor&&("SplitRecommended"===o.pageStatus||"SplitRequired"===o.pageStatus||o.page.length>2*e.options.initialNumItems)&&this.splitPaginatedQueryPage(e,s,o.splitCursor,o.continueCursor)}}}splitPaginatedQueryPage(e,t,s,r){let n=e.nextPageKey++,i=e.nextPageKey++,o={cursor:r,numItems:e.options.initialNumItems,id:e.id},a=this.client.subscribe(e.canonicalizedUdfPath,{...e.args,paginationOpts:{...o,cursor:null,endCursor:s}});e.pageKeyToQuery.set(n,a);let l=this.client.subscribe(e.canonicalizedUdfPath,{...e.args,paginationOpts:{...o,cursor:s,endCursor:r}});e.pageKeyToQuery.set(i,l),e.ongoingSplits.set(t,[n,i])}addPageToPaginatedQuery(e,t,s){let r=this.mustGetPaginatedQuery(e),n=r.nextPageKey++,i={cursor:t,numItems:s,id:r.id},o={...r.args,paginationOpts:i},a=this.client.subscribe(r.canonicalizedUdfPath,o);return r.pageKeys.push(n),r.pageKeyToQuery.set(n,a),a}removePaginatedQuerySubscriber(e){let t=this.paginatedQuerySet.get(e);if(t&&(t.numSubscribers-=1,!(t.numSubscribers>0))){for(let e of t.pageKeyToQuery.values())e.unsubscribe();this.paginatedQuerySet.delete(e)}}completePaginatedQuerySplit(e,t,s,r){let n=e.pageKeyToQuery.get(t);e.pageKeyToQuery.delete(t);let i=e.pageKeys.indexOf(t);e.pageKeys.splice(i,1,s,r),e.ongoingSplits.delete(t),n.unsubscribe()}activePageQueryTokens(e){return e.pageKeys.map(t=>e.pageKeyToQuery.get(t).queryToken)}allQueryTokens(e){return Array.from(e.pageKeyToQuery.values()).map(e=>e.queryToken)}queryTokenForLastPageOfPaginatedQuery(e){let t=this.mustGetPaginatedQuery(e),s=t.pageKeys[t.pageKeys.length-1];if(void 0===s)throw Error(`No pages for paginated query ${e}`);return t.pageKeyToQuery.get(s).queryToken}mustGetPaginatedQuery(e){let t=this.paginatedQuerySet.get(e);if(!t)throw Error("paginated query no longer exists for token "+e);return t}}var ej=Object.defineProperty,eD=(e,t,s)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?ej(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s};if(void 0===i.default)throw Error("Required dependency 'react' not found");let eF=i.default.createContext(void 0),eU=({client:e,children:t})=>i.default.createElement(eF.Provider,{value:e},t);Symbol("includePageKeys"),Symbol("page"),(0,i.createContext)(void 0);let ez=new class{constructor(e,t){if(eD(this,"address"),eD(this,"cachedSync"),eD(this,"cachedPaginatedQueryClient"),eD(this,"listeners"),eD(this,"options"),eD(this,"closed",!1),eD(this,"_logger"),eD(this,"adminAuth"),eD(this,"fakeUserIdentity"),void 0===e)throw Error("No address provided to ConvexReactClient.\nIf trying to deploy to production, make sure to follow all the instructions found at https://docs.convex.dev/production/hosting/\nIf running locally, make sure to run `convex dev` and ensure the .env.local file is populated.");if("string"!=typeof e)throw Error(`ConvexReactClient requires a URL like 'https://happy-otter-123.convex.cloud', received something of type ${typeof e} instead.`);if(!e.includes("://"))throw Error("Provided address was not an absolute URL.");this.address=e,this.listeners=new Map,this._logger=t?.logger===!1?new D({verbose:t?.verbose??!1}):t?.logger!==!0&&t?.logger?t.logger:F({verbose:t?.verbose??!1}),this.options={...t,logger:this._logger}}get url(){return this.address}get sync(){if(this.closed)throw Error("ConvexReactClient has already been closed.");return this.cachedSync||(this.cachedSync=new eL(this.address,()=>{},this.options),this.adminAuth&&this.cachedSync.setAdminAuth(this.adminAuth,this.fakeUserIdentity),this.cachedPaginatedQueryClient=new e_(this.cachedSync,e=>this.handleTransition(e))),this.cachedSync}get paginatedQueryClient(){if(this.sync,this.cachedPaginatedQueryClient)return this.cachedPaginatedQueryClient;throw Error("Should already be instantiated")}setAuth(e,t){if("string"==typeof e)throw Error("Passing a string to ConvexReactClient.setAuth is no longer supported, please upgrade to passing in an async function to handle reauthentication.");this.sync.setAuth(e,t??(()=>{}))}clearAuth(){this.sync.clearAuth()}setAdminAuth(e,t){if(this.adminAuth=e,this.fakeUserIdentity=t,this.closed)throw Error("ConvexReactClient has already been closed.");this.cachedSync&&this.sync.setAdminAuth(e,t)}watchQuery(e,...t){let[s,r]=t,n=en(e);return{onUpdate:e=>{let{queryToken:t,unsubscribe:i}=this.sync.subscribe(n,s,r),o=this.listeners.get(t);return void 0!==o?o.add(e):this.listeners.set(t,new Set([e])),()=>{if(this.closed)return;let s=this.listeners.get(t);s.delete(e),0===s.size&&this.listeners.delete(t),i()}},localQueryResult:()=>{if(this.cachedSync)return this.cachedSync.localQueryResult(n,s)},localQueryLogs:()=>{if(this.cachedSync)return this.cachedSync.localQueryLogs(n,s)},journal:()=>{if(this.cachedSync)return this.cachedSync.queryJournal(n,s)}}}prewarmQuery(e){let t=e.extendSubscriptionFor??5e3;setTimeout(this.watchQuery(e.query,e.args||{}).onUpdate(()=>{}),t)}watchPaginatedQuery(e,t,s){let r=en(e);return{onUpdate:e=>{let{paginatedQueryToken:n,unsubscribe:i}=this.paginatedQueryClient.subscribe(r,t||{},s),o=this.listeners.get(n);return void 0!==o?o.add(e):this.listeners.set(n,new Set([e])),()=>{if(this.closed)return;let t=this.listeners.get(n);t.delete(e),0===t.size&&this.listeners.delete(n),i()}},localQueryResult:()=>this.paginatedQueryClient.localQueryResult(r,t,s)}}mutation(e,...t){let[s,r]=t,n=en(e);return this.sync.mutation(n,s,r)}action(e,...t){let s=en(e);return this.sync.action(s,...t)}query(e,...t){let s=this.watchQuery(e,...t),r=s.localQueryResult();return void 0!==r?Promise.resolve(r):new Promise((e,t)=>{let r=s.onUpdate(()=>{r();try{e(s.localQueryResult())}catch(e){t(e)}})})}connectionState(){return this.sync.connectionState()}subscribeToConnectionState(e){return this.sync.subscribeToConnectionState(e)}get logger(){return this._logger}async close(){if(this.closed=!0,this.listeners=new Map,this.cachedPaginatedQueryClient&&(this.cachedPaginatedQueryClient=void 0),this.cachedSync){let e=this.cachedSync;this.cachedSync=void 0,await e.close()}}handleTransition(e){let t=e.queries.map(e=>e.token),s=e.paginatedQueries.map(e=>e.token);this.transition([...t,...s])}transition(e){for(let t of e){let e=this.listeners.get(t);if(e)for(let t of e)t()}}}("http://localhost:3210");function eW({children:e}){return(0,n.jsx)(eU,{client:ez,children:e})}e.s(["ConvexClientProvider",()=>eW],88990)},71957,e=>{"use strict";var t=e.i(43476),s=e.i(75254);let r=(0,s.default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),n=(0,s.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),i=(0,s.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),o=(0,s.default)("octagon-x",[["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z",key:"2d38gg"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),a=(0,s.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var l=e.i(63178),u=e.i(71645),c=e.i(74080);let d=Array(12).fill(0),h=({visible:e,className:t})=>u.default.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},u.default.createElement("div",{className:"sonner-spinner"},d.map((e,t)=>u.default.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),f=u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},u.default.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),g=u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},u.default.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),m=u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},u.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),p=u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},u.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),y=u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},u.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),v=1,b=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:s,...r}=e,n="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:v++,i=this.toasts.find(e=>e.id===n),o=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),i?this.toasts=this.toasts.map(t=>t.id===n?(this.publish({...t,...e,id:n,title:s}),{...t,...e,id:n,dismissible:o,title:s}):t):this.addToast({title:s,...r,dismissible:o,id:n}),n},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{let s,r;if(!t)return;void 0!==t.loading&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));let n=Promise.resolve(e instanceof Function?e():e),i=void 0!==r,o=n.then(async e=>{if(s=["resolve",e],u.default.isValidElement(e))i=!1,this.create({id:r,type:"default",message:e});else if(w(e)&&!e.ok){i=!1;let s="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,o="object"!=typeof s||u.default.isValidElement(s)?{message:s}:s;this.create({id:r,type:"error",description:n,...o})}else if(e instanceof Error){i=!1;let s="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,o="object"!=typeof s||u.default.isValidElement(s)?{message:s}:s;this.create({id:r,type:"error",description:n,...o})}else if(void 0!==t.success){i=!1;let s="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description,o="object"!=typeof s||u.default.isValidElement(s)?{message:s}:s;this.create({id:r,type:"success",description:n,...o})}}).catch(async e=>{if(s=["reject",e],void 0!==t.error){i=!1;let s="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,o="object"!=typeof s||u.default.isValidElement(s)?{message:s}:s;this.create({id:r,type:"error",description:n,...o})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),null==t.finally||t.finally.call(t)}),a=()=>new Promise((e,t)=>o.then(()=>"reject"===s[0]?t(s[1]):e(s[1])).catch(t));return"string"!=typeof r&&"number"!=typeof r?{unwrap:a}:Object.assign(r,{unwrap:a})},this.custom=(e,t)=>{let s=(null==t?void 0:t.id)||v++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},w=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status;function k(e){return void 0!==e.label}function S(...e){return e.filter(Boolean).join(" ")}Object.assign((e,t)=>{let s=(null==t?void 0:t.id)||v++;return b.addToast({title:e,...t,id:s}),s},{success:b.success,info:b.info,warning:b.warning,error:b.error,custom:b.custom,message:b.message,promise:b.promise,dismiss:b.dismiss,loading:b.loading},{getHistory:()=>b.toasts,getToasts:()=>b.getActiveToasts()}),function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");let x=e=>{var t,s,r,n,i,o,a,l,c,d,v,b,w;let{invert:x,toast:T,unstyled:C,interacting:R,setHeights:A,visibleToasts:E,heights:M,index:q,toasts:I,expanded:$,removeToast:P,defaultRichColors:Q,closeButton:O,style:L,cancelButtonStyle:V,actionButtonStyle:N,className:B="",descriptionClassName:_="",duration:j,position:D,gap:F,expandByDefault:U,classNames:z,icons:W,closeButtonAriaLabel:K="Close toast"}=e,[H,Y]=u.default.useState(null),[J,X]=u.default.useState(null),[G,Z]=u.default.useState(!1),[ee,et]=u.default.useState(!1),[es,er]=u.default.useState(!1),[en,ei]=u.default.useState(!1),[eo,ea]=u.default.useState(!1),[el,eu]=u.default.useState(0),[ec,ed]=u.default.useState(0),eh=u.default.useRef(T.duration||j||4e3),ef=u.default.useRef(null),eg=u.default.useRef(null),em=0===q,ep=q+1<=E,ey=T.type,ev=!1!==T.dismissible,eb=T.className||"",ew=T.descriptionClassName||"",ek=u.default.useMemo(()=>M.findIndex(e=>e.toastId===T.id)||0,[M,T.id]),eS=u.default.useMemo(()=>{var e;return null!=(e=T.closeButton)?e:O},[T.closeButton,O]),ex=u.default.useMemo(()=>T.duration||j||4e3,[T.duration,j]),eT=u.default.useRef(0),eC=u.default.useRef(0),eR=u.default.useRef(0),eA=u.default.useRef(null),[eE,eM]=D.split("-"),eq=u.default.useMemo(()=>M.reduce((e,t,s)=>s>=ek?e:e+t.height,0),[M,ek]),eI=(()=>{let[e,t]=u.default.useState(document.hidden);return u.default.useEffect(()=>{let e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),e$=T.invert||x,eP="loading"===ey;eC.current=u.default.useMemo(()=>ek*F+eq,[ek,eq]),u.default.useEffect(()=>{eh.current=ex},[ex]),u.default.useEffect(()=>{Z(!0)},[]),u.default.useEffect(()=>{let e=eg.current;if(e){let t=e.getBoundingClientRect().height;return ed(t),A(e=>[{toastId:T.id,height:t,position:T.position},...e]),()=>A(e=>e.filter(e=>e.toastId!==T.id))}},[A,T.id]),u.default.useLayoutEffect(()=>{if(!G)return;let e=eg.current,t=e.style.height;e.style.height="auto";let s=e.getBoundingClientRect().height;e.style.height=t,ed(s),A(e=>e.find(e=>e.toastId===T.id)?e.map(e=>e.toastId===T.id?{...e,height:s}:e):[{toastId:T.id,height:s,position:T.position},...e])},[G,T.title,T.description,A,T.id,T.jsx,T.action,T.cancel]);let eQ=u.default.useCallback(()=>{et(!0),eu(eC.current),A(e=>e.filter(e=>e.toastId!==T.id)),setTimeout(()=>{P(T)},200)},[T,P,A,eC]);u.default.useEffect(()=>{let e;if((!T.promise||"loading"!==ey)&&T.duration!==1/0&&"loading"!==T.type){if($||R||eI){if(eR.current<eT.current){let e=new Date().getTime()-eT.current;eh.current=eh.current-e}eR.current=new Date().getTime()}else eh.current!==1/0&&(eT.current=new Date().getTime(),e=setTimeout(()=>{null==T.onAutoClose||T.onAutoClose.call(T,T),eQ()},eh.current));return()=>clearTimeout(e)}},[$,R,T,ey,eI,eQ]),u.default.useEffect(()=>{T.delete&&(eQ(),null==T.onDismiss||T.onDismiss.call(T,T))},[eQ,T.delete]);let eO=T.icon||(null==W?void 0:W[ey])||(e=>{switch(e){case"success":return f;case"info":return m;case"warning":return g;case"error":return p;default:return null}})(ey);return u.default.createElement("li",{tabIndex:0,ref:eg,className:S(B,eb,null==z?void 0:z.toast,null==T||null==(t=T.classNames)?void 0:t.toast,null==z?void 0:z.default,null==z?void 0:z[ey],null==T||null==(s=T.classNames)?void 0:s[ey]),"data-sonner-toast":"","data-rich-colors":null!=(d=T.richColors)?d:Q,"data-styled":!(T.jsx||T.unstyled||C),"data-mounted":G,"data-promise":!!T.promise,"data-swiped":eo,"data-removed":ee,"data-visible":ep,"data-y-position":eE,"data-x-position":eM,"data-index":q,"data-front":em,"data-swiping":es,"data-dismissible":ev,"data-type":ey,"data-invert":e$,"data-swipe-out":en,"data-swipe-direction":J,"data-expanded":!!($||U&&G),"data-testid":T.testId,style:{"--index":q,"--toasts-before":q,"--z-index":I.length-q,"--offset":`${ee?el:eC.current}px`,"--initial-height":U?"auto":`${ec}px`,...L,...T.style},onDragEnd:()=>{er(!1),Y(null),eA.current=null},onPointerDown:e=>{2===e.button||eP||!ev||(ef.current=new Date,eu(eC.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(er(!0),eA.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,s,r,n;if(en||!ev)return;eA.current=null;let i=Number((null==(e=eg.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),o=Number((null==(t=eg.current)?void 0:t.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),a=new Date().getTime()-(null==(s=ef.current)?void 0:s.getTime()),l="x"===H?i:o,u=Math.abs(l)/a;if(Math.abs(l)>=45||u>.11){eu(eC.current),null==T.onDismiss||T.onDismiss.call(T,T),"x"===H?X(i>0?"right":"left"):X(o>0?"down":"up"),eQ(),ei(!0);return}null==(r=eg.current)||r.style.setProperty("--swipe-amount-x","0px"),null==(n=eg.current)||n.style.setProperty("--swipe-amount-y","0px"),ea(!1),er(!1),Y(null)},onPointerMove:t=>{var s,r,n,i;if(!eA.current||!ev||(null==(s=window.getSelection())?void 0:s.toString().length)>0)return;let o=t.clientY-eA.current.y,a=t.clientX-eA.current.x,l=null!=(i=e.swipeDirections)?i:function(e){let[t,s]=e.split("-"),r=[];return t&&r.push(t),s&&r.push(s),r}(D);!H&&(Math.abs(a)>1||Math.abs(o)>1)&&Y(Math.abs(a)>Math.abs(o)?"x":"y");let u={x:0,y:0},c=e=>1/(1.5+Math.abs(e)/20);if("y"===H){if(l.includes("top")||l.includes("bottom"))if(l.includes("top")&&o<0||l.includes("bottom")&&o>0)u.y=o;else{let e=o*c(o);u.y=Math.abs(e)<Math.abs(o)?e:o}}else if("x"===H&&(l.includes("left")||l.includes("right")))if(l.includes("left")&&a<0||l.includes("right")&&a>0)u.x=a;else{let e=a*c(a);u.x=Math.abs(e)<Math.abs(a)?e:a}(Math.abs(u.x)>0||Math.abs(u.y)>0)&&ea(!0),null==(r=eg.current)||r.style.setProperty("--swipe-amount-x",`${u.x}px`),null==(n=eg.current)||n.style.setProperty("--swipe-amount-y",`${u.y}px`)}},eS&&!T.jsx&&"loading"!==ey?u.default.createElement("button",{"aria-label":K,"data-disabled":eP,"data-close-button":!0,onClick:eP||!ev?()=>{}:()=>{eQ(),null==T.onDismiss||T.onDismiss.call(T,T)},className:S(null==z?void 0:z.closeButton,null==T||null==(r=T.classNames)?void 0:r.closeButton)},null!=(v=null==W?void 0:W.close)?v:y):null,(ey||T.icon||T.promise)&&null!==T.icon&&((null==W?void 0:W[ey])!==null||T.icon)?u.default.createElement("div",{"data-icon":"",className:S(null==z?void 0:z.icon,null==T||null==(n=T.classNames)?void 0:n.icon)},T.promise||"loading"===T.type&&!T.icon?T.icon||((null==W?void 0:W.loading)?u.default.createElement("div",{className:S(null==z?void 0:z.loader,null==T||null==(w=T.classNames)?void 0:w.loader,"sonner-loader"),"data-visible":"loading"===ey},W.loading):u.default.createElement(h,{className:S(null==z?void 0:z.loader,null==T||null==(b=T.classNames)?void 0:b.loader),visible:"loading"===ey})):null,"loading"!==T.type?eO:null):null,u.default.createElement("div",{"data-content":"",className:S(null==z?void 0:z.content,null==T||null==(i=T.classNames)?void 0:i.content)},u.default.createElement("div",{"data-title":"",className:S(null==z?void 0:z.title,null==T||null==(o=T.classNames)?void 0:o.title)},T.jsx?T.jsx:"function"==typeof T.title?T.title():T.title),T.description?u.default.createElement("div",{"data-description":"",className:S(_,ew,null==z?void 0:z.description,null==T||null==(a=T.classNames)?void 0:a.description)},"function"==typeof T.description?T.description():T.description):null),u.default.isValidElement(T.cancel)?T.cancel:T.cancel&&k(T.cancel)?u.default.createElement("button",{"data-button":!0,"data-cancel":!0,style:T.cancelButtonStyle||V,onClick:e=>{!k(T.cancel)||ev&&(null==T.cancel.onClick||T.cancel.onClick.call(T.cancel,e),eQ())},className:S(null==z?void 0:z.cancelButton,null==T||null==(l=T.classNames)?void 0:l.cancelButton)},T.cancel.label):null,u.default.isValidElement(T.action)?T.action:T.action&&k(T.action)?u.default.createElement("button",{"data-button":!0,"data-action":!0,style:T.actionButtonStyle||N,onClick:e=>{!k(T.action)||(null==T.action.onClick||T.action.onClick.call(T.action,e),e.defaultPrevented||eQ())},className:S(null==z?void 0:z.actionButton,null==T||null==(c=T.classNames)?void 0:c.actionButton)},T.action.label):null)};function T(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}let C=u.default.forwardRef(function(e,t){let{id:s,invert:r,position:n="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:a,className:l,offset:d,mobileOffset:h,theme:f="light",richColors:g,duration:m,style:p,visibleToasts:y=3,toastOptions:v,dir:w=T(),gap:k=14,icons:S,containerAriaLabel:C="Notifications"}=e,[R,A]=u.default.useState([]),E=u.default.useMemo(()=>s?R.filter(e=>e.toasterId===s):R.filter(e=>!e.toasterId),[R,s]),M=u.default.useMemo(()=>Array.from(new Set([n].concat(E.filter(e=>e.position).map(e=>e.position)))),[E,n]),[q,I]=u.default.useState([]),[$,P]=u.default.useState(!1),[Q,O]=u.default.useState(!1),[L,V]=u.default.useState("system"!==f?f:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),N=u.default.useRef(null),B=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),_=u.default.useRef(null),j=u.default.useRef(!1),D=u.default.useCallback(e=>{A(t=>{var s;return(null==(s=t.find(t=>t.id===e.id))?void 0:s.delete)||b.dismiss(e.id),t.filter(({id:t})=>t!==e.id)})},[]);return u.default.useEffect(()=>b.subscribe(e=>{e.dismiss?requestAnimationFrame(()=>{A(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t))}):setTimeout(()=>{c.default.flushSync(()=>{A(t=>{let s=t.findIndex(t=>t.id===e.id);return -1!==s?[...t.slice(0,s),{...t[s],...e},...t.slice(s+1)]:[e,...t]})})})}),[R]),u.default.useEffect(()=>{if("system"!==f)return void V(f);if("system"===f&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?V("dark"):V("light")),"undefined"==typeof window)return;let e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{e?V("dark"):V("light")})}catch(t){e.addListener(({matches:e})=>{try{e?V("dark"):V("light")}catch(e){console.error(e)}})}},[f]),u.default.useEffect(()=>{R.length<=1&&P(!1)},[R]),u.default.useEffect(()=>{let e=e=>{var t,s;i.every(t=>e[t]||e.code===t)&&(P(!0),null==(s=N.current)||s.focus()),"Escape"===e.code&&(document.activeElement===N.current||(null==(t=N.current)?void 0:t.contains(document.activeElement)))&&P(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i]),u.default.useEffect(()=>{if(N.current)return()=>{_.current&&(_.current.focus({preventScroll:!0}),_.current=null,j.current=!1)}},[N.current]),u.default.createElement("section",{ref:t,"aria-label":`${C} ${B}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((t,s)=>{var n;let i,[c,f]=t.split("-");return E.length?u.default.createElement("ol",{key:t,dir:"auto"===w?T():w,tabIndex:-1,ref:N,className:l,"data-sonner-toaster":!0,"data-sonner-theme":L,"data-y-position":c,"data-x-position":f,style:{"--front-toast-height":`${(null==(n=q[0])?void 0:n.height)||0}px`,"--width":"356px","--gap":`${k}px`,...p,...(i={},[d,h].forEach((e,t)=>{let s=1===t,r=s?"--mobile-offset":"--offset",n=s?"16px":"24px";function o(e){["top","right","bottom","left"].forEach(t=>{i[`${r}-${t}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?o(e):"object"==typeof e?["top","right","bottom","left"].forEach(t=>{void 0===e[t]?i[`${r}-${t}`]=n:i[`${r}-${t}`]="number"==typeof e[t]?`${e[t]}px`:e[t]}):o(n)}),i)},onBlur:e=>{j.current&&!e.currentTarget.contains(e.relatedTarget)&&(j.current=!1,_.current&&(_.current.focus({preventScroll:!0}),_.current=null))},onFocus:e=>{!(e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible)&&(j.current||(j.current=!0,_.current=e.relatedTarget))},onMouseEnter:()=>P(!0),onMouseMove:()=>P(!0),onMouseLeave:()=>{Q||P(!1)},onDragEnd:()=>P(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||O(!0)},onPointerUp:()=>O(!1)},E.filter(e=>!e.position&&0===s||e.position===t).map((s,n)=>{var i,l;return u.default.createElement(x,{key:s.id,icons:S,index:n,toast:s,defaultRichColors:g,duration:null!=(i=null==v?void 0:v.duration)?i:m,className:null==v?void 0:v.className,descriptionClassName:null==v?void 0:v.descriptionClassName,invert:r,visibleToasts:y,closeButton:null!=(l=null==v?void 0:v.closeButton)?l:a,interacting:Q,position:t,style:null==v?void 0:v.style,unstyled:null==v?void 0:v.unstyled,classNames:null==v?void 0:v.classNames,cancelButtonStyle:null==v?void 0:v.cancelButtonStyle,actionButtonStyle:null==v?void 0:v.actionButtonStyle,closeButtonAriaLabel:null==v?void 0:v.closeButtonAriaLabel,removeToast:D,toasts:E.filter(e=>e.position==s.position),heights:q.filter(e=>e.position==s.position),setHeights:I,expandByDefault:o,gap:k,expanded:$,swipeDirections:e.swipeDirections})})):null}))}),R=({...e})=>{let{theme:s="system"}=(0,l.useTheme)();return(0,t.jsx)(C,{theme:s,className:"toaster group",icons:{success:(0,t.jsx)(r,{className:"size-4"}),info:(0,t.jsx)(n,{className:"size-4"}),warning:(0,t.jsx)(a,{className:"size-4"}),error:(0,t.jsx)(o,{className:"size-4"}),loading:(0,t.jsx)(i,{className:"size-4 animate-spin"})},style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},...e})};e.s(["Toaster",()=>R],71957)}]);